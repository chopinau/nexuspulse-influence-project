(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,81097,29530,t=>{"use strict";let e,i;var r=t.i(71645);function s(t){return t+.5|0}let n=(t,e,i)=>Math.max(Math.min(t,i),e);function a(t){return n(s(2.55*t),0,255)}function o(t){return n(s(255*t),0,255)}function l(t){return n(s(t/2.55)/100,0,1)}function h(t){return n(s(100*t),0,100)}let u={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},c=[..."0123456789ABCDEF"],d=t=>c[15&t],f=t=>c[(240&t)>>4]+c[15&t],p=t=>(240&t)>>4==(15&t),g=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function m(t,e,i){let r=e*Math.min(i,1-i),s=(e,s=(e+t/30)%12)=>i-r*Math.max(Math.min(s-3,9-s,1),-1);return[s(0),s(8),s(4)]}function b(t,e,i){let r=(r,s=(r+t/60)%6)=>i-i*e*Math.max(Math.min(s,4-s,1),0);return[r(5),r(3),r(1)]}function y(t,e,i){let r,s=m(t,1,.5);for(e+i>1&&(r=1/(e+i),e*=r,i*=r),r=0;r<3;r++)s[r]*=1-e-i,s[r]+=e;return s}function _(t){let e,i,r,s=t.r/255,n=t.g/255,a=t.b/255,o=Math.max(s,n,a),l=Math.min(s,n,a),h=(o+l)/2;o!==l&&(r=o-l,i=h>.5?r/(2-o-l):r/(o+l),e=60*(e=s===o?(n-a)/r+6*(n<a):n===o?(a-s)/r+2:(s-n)/r+4)+.5);return[0|e,i||0,h]}function w(t,e,i,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,i,r)).map(o)}function v(t){return(t%360+360)%360}let x={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},k={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"},S=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,E=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,T=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function O(t,e,i){if(t){let r=_(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*i,0===e?360:1)),t.r=(r=w(m,r,void 0,void 0))[0],t.g=r[1],t.b=r[2]}}function A(t,e){return t?Object.assign(e||{},t):t}function R(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=o(t[3]))):(e=A(t,{r:0,g:0,b:0,a:1})).a=o(e.a),e}class P{constructor(t){let i;if(t instanceof P)return t;const r=typeof t;"object"===r?i=R(t):"string"===r&&(i=function(t){var e,i=t.length;return"#"===t[0]&&(4===i||5===i?e={r:255&17*u[t[1]],g:255&17*u[t[2]],b:255&17*u[t[3]],a:5===i?17*u[t[4]]:255}:(7===i||9===i)&&(e={r:u[t[1]]<<4|u[t[2]],g:u[t[3]]<<4|u[t[4]],b:u[t[5]]<<4|u[t[6]],a:9===i?u[t[7]]<<4|u[t[8]]:255})),e}(t)||function(t){e||((e=function(){let t,e,i,r,s,n={},a=Object.keys(k),o=Object.keys(x);for(t=0;t<a.length;t++){for(e=0,r=s=a[t];e<o.length;e++)i=o[e],s=s.replace(i,x[i]);i=parseInt(k[r],16),n[s]=[i>>16&255,i>>8&255,255&i]}return n}()).transparent=[0,0,0,0]);let i=e[t.toLowerCase()];return i&&{r:i[0],g:i[1],b:i[2],a:4===i.length?i[3]:255}}(t)||function(t){return"r"===t.charAt(0)?function(t){let e,i,r,s=S.exec(t),o=255;if(s){if(s[7]!==e){let t=+s[7];o=s[8]?a(t):n(255*t,0,255)}return e=+s[1],i=+s[3],r=+s[5],e=255&(s[2]?a(e):n(e,0,255)),{r:e,g:i=255&(s[4]?a(i):n(i,0,255)),b:r=255&(s[6]?a(r):n(r,0,255)),a:o}}}(t):function(t){let e,i=g.exec(t),r=255;if(!i)return;i[5]!==e&&(r=i[6]?a(+i[5]):o(+i[5]));let s=v(+i[2]),n=i[3]/100,l=i[4]/100;return{r:(e="hwb"===i[1]?w(y,s,n,l):"hsv"===i[1]?w(b,s,n,l):w(m,s,n,l))[0],g:e[1],b:e[2],a:r}}(t)}(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=A(this._rgb);return t&&(t.a=l(t.a)),t}set rgb(t){this._rgb=R(t)}rgbString(){var t;return this._valid?(t=this._rgb)&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${l(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`):void 0}hexString(){var t,e;let i,r;return this._valid?(e=p((i=t=this._rgb).r)&&p(i.g)&&p(i.b)&&p(i.a)?d:f,t?"#"+e(t.r)+e(t.g)+e(t.b)+(r=t.a,r<255?e(r):""):void 0):void 0}hslString(){return this._valid?function(t){if(!t)return;let e=_(t),i=e[0],r=h(e[1]),s=h(e[2]);return t.a<255?`hsla(${i}, ${r}%, ${s}%, ${l(t.a)})`:`hsl(${i}, ${r}%, ${s}%)`}(this._rgb):void 0}mix(t,e){if(t){let i,r=this.rgb,s=t.rgb,n=e===i?.5:e,a=2*n-1,o=r.a-s.a,l=((a*o==-1?a:(a+o)/(1+a*o))+1)/2;i=1-l,r.r=255&l*r.r+i*s.r+.5,r.g=255&l*r.g+i*s.g+.5,r.b=255&l*r.b+i*s.b+.5,r.a=n*r.a+(1-n)*s.a,this.rgb=r}return this}interpolate(t,e){var i,r;let s,n,a;return t&&(this._rgb=(i=this._rgb,r=t._rgb,s=T(l(i.r)),n=T(l(i.g)),a=T(l(i.b)),{r:o(E(s+e*(T(l(r.r))-s))),g:o(E(n+e*(T(l(r.g))-n))),b:o(E(a+e*(T(l(r.b))-a))),a:i.a+e*(r.a-i.a)})),this}clone(){return new P(this.rgb)}alpha(t){return this._rgb.a=o(t),this}clearer(t){let e=this._rgb;return e.a*=1-t,this}greyscale(){let t=this._rgb,e=s(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){let e=this._rgb;return e.a*=1+t,this}negate(){let t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return O(this._rgb,2,t),this}darken(t){return O(this._rgb,2,-t),this}saturate(t){return O(this._rgb,1,t),this}desaturate(t){return O(this._rgb,1,-t),this}rotate(t){var e,i;return e=this._rgb,(i=_(e))[0]=v(i[0]+t),e.r=(i=w(m,i,void 0,void 0))[0],e.g=i[1],e.b=i[2],this}}function C(){}let M=(i=0,()=>i++);function D(t){return null==t}function I(t){if(Array.isArray&&Array.isArray(t))return!0;let e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function j(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function L(t){return("number"==typeof t||t instanceof Number)&&isFinite(+t)}function $(t,e){return L(t)?t:e}function B(t,e){return void 0===t?e:t}let N=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function U(t,e,i){if(t&&"function"==typeof t.call)return t.apply(i,e)}function F(t,e,i,r){let s,n,a;if(I(t))if(n=t.length,r)for(s=n-1;s>=0;s--)e.call(i,t[s],s);else for(s=0;s<n;s++)e.call(i,t[s],s);else if(j(t))for(s=0,n=(a=Object.keys(t)).length;s<n;s++)e.call(i,t[a[s]],a[s])}function z(t,e){let i,r,s,n;if(!t||!e||t.length!==e.length)return!1;for(i=0,r=t.length;i<r;++i)if(s=t[i],n=e[i],s.datasetIndex!==n.datasetIndex||s.index!==n.index)return!1;return!0}function V(t){if(I(t))return t.map(V);if(j(t)){let e=Object.create(null),i=Object.keys(t),r=i.length,s=0;for(;s<r;++s)e[i[s]]=V(t[i[s]]);return e}return t}function W(t){return -1===["__proto__","prototype","constructor"].indexOf(t)}function H(t,e,i,r){if(!W(t))return;let s=e[t],n=i[t];j(s)&&j(n)?q(s,n,r):e[t]=V(n)}function q(t,e,i){let r,s=I(e)?e:[e],n=s.length;if(!j(t))return t;let a=(i=i||{}).merger||H;for(let e=0;e<n;++e){if(!j(r=s[e]))continue;let n=Object.keys(r);for(let e=0,s=n.length;e<s;++e)a(n[e],t,r,i)}return t}function K(t,e){return q(t,e,{merger:J})}function J(t,e,i){if(!W(t))return;let r=e[t],s=i[t];j(r)&&j(s)?K(r,s):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=V(s))}let G={"":t=>t,x:t=>t.x,y:t=>t.y};function Y(t,e){let i;return(G[e]||(G[e]=(i=function(t){let e=t.split("."),i=[],r="";for(let t of e)(r+=t).endsWith("\\")?r=r.slice(0,-1)+".":(i.push(r),r="");return i}(e),t=>{for(let e of i){if(""===e)break;t=t&&t[e]}return t})))(t)}function X(t){return t.charAt(0).toUpperCase()+t.slice(1)}let Z=t=>void 0!==t,Q=t=>"function"==typeof t,tt=(t,e)=>{if(t.size!==e.size)return!1;for(let i of t)if(!e.has(i))return!1;return!0},te=Math.PI,ti=2*te,tr=ti+te,ts=1/0,tn=te/180,ta=te/2,to=te/4,tl=2*te/3,th=Math.log10,tu=Math.sign;function tc(t,e,i){return Math.abs(t-e)<i}function td(t){let e=Math.round(t),i=Math.pow(10,Math.floor(th(t=tc(t,e,t/1e3)?e:t))),r=t/i;return(r<=1?1:r<=2?2:r<=5?5:10)*i}function tf(t){return!isNaN(parseFloat(t))&&isFinite(t)}function tp(t,e,i){let r,s,n;for(r=0,s=t.length;r<s;r++)isNaN(n=t[r][i])||(e.min=Math.min(e.min,n),e.max=Math.max(e.max,n))}function tg(t){return te/180*t}function tm(t){if(!L(t))return;let e=1,i=0;for(;Math.round(t*e)/e!==t;)e*=10,i++;return i}function tb(t,e){let i=e.x-t.x,r=e.y-t.y,s=Math.sqrt(i*i+r*r),n=Math.atan2(r,i);return n<-.5*te&&(n+=ti),{angle:n,distance:s}}function ty(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function t_(t,e){return(t-e+tr)%ti-te}function tw(t){return(t%ti+ti)%ti}function tv(t,e,i,r){let s=tw(t),n=tw(e),a=tw(i),o=tw(n-s),l=tw(a-s),h=tw(s-n),u=tw(s-a);return s===n||s===a||r&&n===a||o>l&&h<u}function tx(t,e,i){return Math.max(e,Math.min(i,t))}function tk(t,e,i,r=1e-6){return t>=Math.min(e,i)-r&&t<=Math.max(e,i)+r}function tS(t,e,i){let r;i=i||(i=>t[i]<e);let s=t.length-1,n=0;for(;s-n>1;)i(r=n+s>>1)?n=r:s=r;return{lo:n,hi:s}}let tE=(t,e,i,r)=>tS(t,i,r?r=>{let s=t[r][e];return s<i||s===i&&t[r+1][e]===i}:r=>t[r][e]<i),tT=(t,e,i)=>tS(t,i,r=>t[r][e]>=i),tO=["push","pop","shift","splice","unshift"];function tA(t,e){let i=t._chartjs;if(!i)return;let r=i.listeners,s=r.indexOf(e);-1!==s&&r.splice(s,1),r.length>0||(tO.forEach(e=>{delete t[e]}),delete t._chartjs)}function tR(t){let e=new Set(t);return e.size===t.length?t:Array.from(e)}let tP="u"<typeof window?function(t){return t()}:window.requestAnimationFrame;function tC(t,e){let i=[],r=!1;return function(...s){i=s,r||(r=!0,tP.call(window,()=>{r=!1,t.apply(e,i)}))}}let tM=t=>"start"===t?"left":"end"===t?"right":"center",tD=(t,e,i)=>"start"===t?e:"end"===t?i:(e+i)/2;function tI(t,e,i){let r=e.length,s=0,n=r;if(t._sorted){let{iScale:a,_parsed:o}=t,l=a.axis,{min:h,max:u,minDefined:c,maxDefined:d}=a.getUserBounds();c&&(s=tx(Math.min(tE(o,l,h).lo,i?r:tE(e,l,a.getPixelForValue(h)).lo),0,r-1)),n=d?tx(Math.max(tE(o,a.axis,u,!0).hi+1,i?0:tE(e,l,a.getPixelForValue(u),!0).hi+1),s,r)-s:r-s}return{start:s,count:n}}function tj(t){let{xScale:e,yScale:i,_scaleRanges:r}=t,s={xmin:e.min,xmax:e.max,ymin:i.min,ymax:i.max};if(!r)return t._scaleRanges=s,!0;let n=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==i.min||r.ymax!==i.max;return Object.assign(r,s),n}let tL=t=>0===t||1===t,t$=(t,e,i)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*ti/i)),tB=(t,e,i)=>Math.pow(2,-10*t)*Math.sin((t-e)*ti/i)+1,tN={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*ta)+1,easeOutSine:t=>Math.sin(t*ta),easeInOutSine:t=>-.5*(Math.cos(te*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>tL(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(-Math.pow(2,-10*(2*t-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>tL(t)?t:t$(t,.075,.3),easeOutElastic:t=>tL(t)?t:tB(t,.075,.3),easeInOutElastic:t=>tL(t)?t:t<.5?.5*t$(2*t,.1125,.45):.5+.5*tB(2*t-1,.1125,.45),easeInBack:t=>t*t*(2.70158*t-1.70158),easeOutBack:t=>(t-=1)*t*(2.70158*t+1.70158)+1,easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-tN.easeOutBounce(1-t),easeOutBounce:t=>t<.36363636363636365?7.5625*t*t:t<.7272727272727273?7.5625*(t-=.5454545454545454)*t+.75:t<.9090909090909091?7.5625*(t-=.8181818181818182)*t+.9375:7.5625*(t-=.9545454545454546)*t+.984375,easeInOutBounce:t=>t<.5?.5*tN.easeInBounce(2*t):.5*tN.easeOutBounce(2*t-1)+.5};function tU(t){if(t&&"object"==typeof t){let e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function tF(t){return tU(t)?t:new P(t)}function tz(t){return tU(t)?t:new P(t).saturate(.5).darken(.1).hexString()}let tV=["x","y","borderWidth","radius","tension"],tW=["color","borderColor","backgroundColor"],tH=new Map;function tq(t,e,i){var r;let s,n;return(s=e+JSON.stringify(r=(r=i)||{}),!(n=tH.get(s))&&(n=new Intl.NumberFormat(e,r),tH.set(s,n)),n).format(t)}let tK={values:t=>I(t)?t:""+t,numeric(t,e,i){let r;if(0===t)return"0";let s=this.chart.options.locale,n=t;if(i.length>1){var a,o;let e,s=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(s<1e-4||s>1e15)&&(r="scientific"),a=t,Math.abs(e=(o=i).length>3?o[2].value-o[1].value:o[1].value-o[0].value)>=1&&a!==Math.floor(a)&&(e=a-Math.floor(a)),n=e}let l=th(Math.abs(n)),h=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),u={notation:r,minimumFractionDigits:h,maximumFractionDigits:h};return Object.assign(u,this.options.ticks.format),tq(t,s,u)},logarithmic(t,e,i){return 0===t?"0":[1,2,3,5,10,15].includes(i[e].significand||t/Math.pow(10,Math.floor(th(t))))||e>.8*i.length?tK.numeric.call(this,t,e,i):""}},tJ=Object.create(null),tG=Object.create(null);function tY(t,e){if(!e)return t;let i=e.split(".");for(let e=0,r=i.length;e<r;++e){let r=i[e];t=t[r]||(t[r]=Object.create(null))}return t}function tX(t,e,i){return"string"==typeof e?q(tY(t,e),i):q(tY(t,""),e)}var tZ=new class{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>tz(e.backgroundColor),this.hoverBorderColor=(t,e)=>tz(e.borderColor),this.hoverColor=(t,e)=>tz(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return tX(this,t,e)}get(t){return tY(this,t)}describe(t,e){return tX(tG,t,e)}override(t,e){return tX(tJ,t,e)}route(t,e,i,r){let s=tY(this,t),n=tY(this,i),a="_"+e;Object.defineProperties(s,{[a]:{value:s[e],writable:!0},[e]:{enumerable:!0,get(){let t=this[a],e=n[r];return j(t)?Object.assign({},e,t):B(t,e)},set(t){this[a]=t}}})}apply(t){t.forEach(t=>t(this))}}({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),t.set("animations",{colors:{type:"color",properties:tW},numbers:{type:"number",properties:tV}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}})},function(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:tK.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t&&"dash"!==t}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t})}]);function tQ(t,e,i,r,s){let n=e[s];return n||(n=e[s]=t.measureText(s).width,i.push(s)),n>r&&(r=n),r}function t0(t,e,i){let r=t.currentDevicePixelRatio,s=0!==i?Math.max(i/2,.5):0;return Math.round((e-s)*r)/r+s}function t1(t,e){(e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function t2(t,e,i,r){t5(t,e,i,r,null)}function t5(t,e,i,r,s){let n,a,o,l,h,u,c,d,f=e.pointStyle,p=e.rotation,g=e.radius,m=(p||0)*tn;if(f&&"object"==typeof f&&("[object HTMLImageElement]"===(n=f.toString())||"[object HTMLCanvasElement]"===n)){t.save(),t.translate(i,r),t.rotate(m),t.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),t.restore();return}if(!isNaN(g)&&!(g<=0)){switch(t.beginPath(),f){default:s?t.ellipse(i,r,s/2,g,0,0,ti):t.arc(i,r,g,0,ti),t.closePath();break;case"triangle":u=s?s/2:g,t.moveTo(i+Math.sin(m)*u,r-Math.cos(m)*g),m+=tl,t.lineTo(i+Math.sin(m)*u,r-Math.cos(m)*g),m+=tl,t.lineTo(i+Math.sin(m)*u,r-Math.cos(m)*g),t.closePath();break;case"rectRounded":h=.516*g,a=Math.cos(m+to)*(l=g-h),c=Math.cos(m+to)*(s?s/2-h:l),o=Math.sin(m+to)*l,d=Math.sin(m+to)*(s?s/2-h:l),t.arc(i-c,r-o,h,m-te,m-ta),t.arc(i+d,r-a,h,m-ta,m),t.arc(i+c,r+o,h,m,m+ta),t.arc(i-d,r+a,h,m+ta,m+te),t.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*g,u=s?s/2:l,t.rect(i-u,r-l,2*u,2*l);break}m+=to;case"rectRot":c=Math.cos(m)*(s?s/2:g),a=Math.cos(m)*g,o=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),t.moveTo(i-c,r-o),t.lineTo(i+d,r-a),t.lineTo(i+c,r+o),t.lineTo(i-d,r+a),t.closePath();break;case"crossRot":m+=to;case"cross":c=Math.cos(m)*(s?s/2:g),a=Math.cos(m)*g,o=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),t.moveTo(i-c,r-o),t.lineTo(i+c,r+o),t.moveTo(i+d,r-a),t.lineTo(i-d,r+a);break;case"star":c=Math.cos(m)*(s?s/2:g),a=Math.cos(m)*g,o=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),t.moveTo(i-c,r-o),t.lineTo(i+c,r+o),t.moveTo(i+d,r-a),t.lineTo(i-d,r+a),m+=to,c=Math.cos(m)*(s?s/2:g),a=Math.cos(m)*g,o=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),t.moveTo(i-c,r-o),t.lineTo(i+c,r+o),t.moveTo(i+d,r-a),t.lineTo(i-d,r+a);break;case"line":a=s?s/2:Math.cos(m)*g,o=Math.sin(m)*g,t.moveTo(i-a,r-o),t.lineTo(i+a,r+o);break;case"dash":t.moveTo(i,r),t.lineTo(i+Math.cos(m)*(s?s/2:g),r+Math.sin(m)*g);break;case!1:t.closePath()}t.fill(),e.borderWidth>0&&t.stroke()}}function t8(t,e,i){return i=i||.5,!e||t&&t.x>e.left-i&&t.x<e.right+i&&t.y>e.top-i&&t.y<e.bottom+i}function t3(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function t6(t){t.restore()}function t4(t,e,i,r,s){if(!e)return t.lineTo(i.x,i.y);if("middle"===s){let r=(e.x+i.x)/2;t.lineTo(r,e.y),t.lineTo(r,i.y)}else"after"===s!=!!r?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}function t9(t,e,i,r){if(!e)return t.lineTo(i.x,i.y);t.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?i.cp2x:i.cp1x,r?i.cp2y:i.cp1y,i.x,i.y)}function t7(t,e,i,r,s,n={}){let a,o,l=I(e)?e:[e],h=n.strokeWidth>0&&""!==n.strokeColor;for(t.save(),t.font=s.string,n.translation&&t.translate(n.translation[0],n.translation[1]),D(n.rotation)||t.rotate(n.rotation),n.color&&(t.fillStyle=n.color),n.textAlign&&(t.textAlign=n.textAlign),n.textBaseline&&(t.textBaseline=n.textBaseline),a=0;a<l.length;++a)o=l[a],n.backdrop&&function(t,e){let i=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=i}(t,n.backdrop),h&&(n.strokeColor&&(t.strokeStyle=n.strokeColor),D(n.strokeWidth)||(t.lineWidth=n.strokeWidth),t.strokeText(o,i,r,n.maxWidth)),t.fillText(o,i,r,n.maxWidth),function(t,e,i,r,s){if(s.strikethrough||s.underline){let n=t.measureText(r),a=e-n.actualBoundingBoxLeft,o=e+n.actualBoundingBoxRight,l=i-n.actualBoundingBoxAscent,h=i+n.actualBoundingBoxDescent,u=s.strikethrough?(l+h)/2:h;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=s.decorationWidth||2,t.moveTo(a,u),t.lineTo(o,u),t.stroke()}}(t,i,r,o,n),r+=Number(s.lineHeight);t.restore()}function et(t,e){let{x:i,y:r,w:s,h:n,radius:a}=e;t.arc(i+a.topLeft,r+a.topLeft,a.topLeft,1.5*te,te,!0),t.lineTo(i,r+n-a.bottomLeft),t.arc(i+a.bottomLeft,r+n-a.bottomLeft,a.bottomLeft,te,ta,!0),t.lineTo(i+s-a.bottomRight,r+n),t.arc(i+s-a.bottomRight,r+n-a.bottomRight,a.bottomRight,ta,0,!0),t.lineTo(i+s,r+a.topRight),t.arc(i+s-a.topRight,r+a.topRight,a.topRight,0,-ta,!0),t.lineTo(i+a.topLeft,r)}let ee=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,ei=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/,er=t=>+t||0;function es(t,e){let i={},r=j(e),s=r?Object.keys(e):e,n=j(t)?r?i=>B(t[i],t[e[i]]):e=>t[e]:()=>t;for(let t of s)i[t]=er(n(t));return i}function en(t){return es(t,{top:"y",right:"x",bottom:"y",left:"x"})}function ea(t){return es(t,["topLeft","topRight","bottomLeft","bottomRight"])}function eo(t){let e=en(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function el(t,e){t=t||{},e=e||tZ.font;let i=B(t.size,e.size);"string"==typeof i&&(i=parseInt(i,10));let r=B(t.style,e.style);r&&!(""+r).match(ei)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);let s={family:B(t.family,e.family),lineHeight:function(t,e){let i=(""+t).match(ee);if(!i||"normal"===i[1])return 1.2*e;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100}return e*t}(B(t.lineHeight,e.lineHeight),i),size:i,style:r,weight:B(t.weight,e.weight),string:""};return s.string=!s||D(s.size)||D(s.family)?null:(s.style?s.style+" ":"")+(s.weight?s.weight+" ":"")+s.size+"px "+s.family,s}function eh(t,e,i,r){let s,n,a,o=!0;for(s=0,n=t.length;s<n;++s)if(void 0!==(a=t[s])&&(void 0!==e&&"function"==typeof a&&(a=a(e),o=!1),void 0!==i&&I(a)&&(a=a[i%a.length],o=!1),void 0!==a))return r&&!o&&(r.cacheable=!1),a}function eu(t,e){return Object.assign(Object.create(t),e)}function ec(t,e=[""],i,r,s=()=>t[0]){let n=i||t;return void 0===r&&(r=ew("_fallback",t)),new Proxy({[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:n,_fallback:r,_getTarget:s,override:i=>ec([i,...t],e,n,r)},{deleteProperty:(e,i)=>(delete e[i],delete e._keys,delete t[0][i],!0),get:(i,r)=>em(i,r,()=>(function(t,e,i,r){let s;for(let n of e)if(void 0!==(s=ew(ep(n,t),i)))return eg(t,s)?ey(i,r,t,s):s})(r,e,t,i)),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>ev(t).includes(e),ownKeys:t=>ev(t),set(t,e,i){let r=t._storage||(t._storage=s());return t[e]=r[e]=i,delete t._keys,!0}})}function ed(t,e,i,r){return new Proxy({_cacheable:!1,_proxy:t,_context:e,_subProxy:i,_stack:new Set,_descriptors:ef(t,r),setContext:e=>ed(t,e,i,r),override:s=>ed(t.override(s),e,i,r)},{deleteProperty:(e,i)=>(delete e[i],delete t[i],!0),get:(t,e,i)=>em(t,e,()=>(function(t,e,i){let{_proxy:r,_context:s,_subProxy:n,_descriptors:a}=t,o=r[e];return Q(o)&&a.isScriptable(e)&&(o=function(t,e,i,r){let{_proxy:s,_context:n,_subProxy:a,_stack:o}=i;if(o.has(t))throw Error("Recursion detected: "+Array.from(o).join("->")+"->"+t);o.add(t);let l=e(n,a||r);return o.delete(t),eg(t,l)&&(l=ey(s._scopes,s,t,l)),l}(e,o,t,i)),I(o)&&o.length&&(o=function(t,e,i,r){let{_proxy:s,_context:n,_subProxy:a,_descriptors:o}=i;if(void 0!==n.index&&r(t))return e[n.index%e.length];if(j(e[0])){let i=e,r=s._scopes.filter(t=>t!==i);for(let l of(e=[],i)){let i=ey(r,s,t,l);e.push(ed(i,n,a&&a[t],o))}}return e}(e,o,t,a.isIndexable)),eg(e,o)&&(o=ed(o,s,n&&n[e],a)),o})(t,e,i)),getOwnPropertyDescriptor:(e,i)=>e._descriptors.allKeys?Reflect.has(t,i)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,i),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,i)=>Reflect.has(t,i),ownKeys:()=>Reflect.ownKeys(t),set:(e,i,r)=>(t[i]=r,delete e[i],!0)})}function ef(t,e={scriptable:!0,indexable:!0}){let{_scriptable:i=e.scriptable,_indexable:r=e.indexable,_allKeys:s=e.allKeys}=t;return{allKeys:s,scriptable:i,indexable:r,isScriptable:Q(i)?i:()=>i,isIndexable:Q(r)?r:()=>r}}let ep=(t,e)=>t?t+X(e):e,eg=(t,e)=>j(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function em(t,e,i){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];let r=i();return t[e]=r,r}let eb=(t,e)=>!0===t?e:"string"==typeof t?Y(e,t):void 0;function ey(t,e,i,r){var s;let n=e._rootScopes,a=(s=e._fallback,Q(s)?s(i,r):s),o=[...t,...n],l=new Set;l.add(r);let h=e_(l,o,i,a||i,r);return null!==h&&(void 0===a||a===i||null!==(h=e_(l,o,a,h,r)))&&ec(Array.from(l),[""],n,a,()=>{var t,s,n;let a,o;return t=e,s=i,n=r,s in(a=t._getTarget())||(a[s]={}),I(o=a[s])&&j(n)?n:o||{}})}function e_(t,e,i,r,s){for(;i;)i=function(t,e,i,r,s){for(let a of e){let e=eb(i,a);if(e){var n;t.add(e);let a=(n=e._fallback,Q(n)?n(i,s):n);if(void 0!==a&&a!==i&&a!==r)return a}else if(!1===e&&void 0!==r&&i!==r)return null}return!1}(t,e,i,r,s);return i}function ew(t,e){for(let i of e){if(!i)continue;let e=i[t];if(void 0!==e)return e}}function ev(t){let e=t._keys;return e||(e=t._keys=function(t){let e=new Set;for(let i of t)for(let t of Object.keys(i).filter(t=>!t.startsWith("_")))e.add(t);return Array.from(e)}(t._scopes)),e}function ex(t,e,i,r){let s,n,a,{iScale:o}=t,{key:l="r"}=this._parsing,h=Array(r);for(s=0;s<r;++s)a=e[n=s+i],h[s]={r:o.parse(Y(a,l),n)};return h}let ek=Number.EPSILON||1e-14,eS=(t,e)=>e<t.length&&!t[e].skip&&t[e],eE=t=>"x"===t?"y":"x";function eT(t,e,i){return Math.max(Math.min(t,i),e)}function eO(){return"u">typeof window&&"u">typeof document}function eA(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function eR(t,e,i){let r;return"string"==typeof t?(r=parseInt(t,10),-1!==t.indexOf("%")&&(r=r/100*e.parentNode[i])):r=t,r}let eP=t=>t.ownerDocument.defaultView.getComputedStyle(t,null),eC=["top","right","bottom","left"];function eM(t,e,i){let r={};i=i?"-"+i:"";for(let s=0;s<4;s++){let n=eC[s];r[n]=parseFloat(t[e+"-"+n+i])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}function eD(t,e){if("native"in t)return t;let{canvas:i,currentDevicePixelRatio:r}=e,s=eP(i),n="border-box"===s.boxSizing,a=eM(s,"padding"),o=eM(s,"border","width"),{x:l,y:h,box:u}=function(t,e){let i,r,s,n=t.touches,a=n&&n.length?n[0]:t,{offsetX:o,offsetY:l}=a,h=!1;if(s=t.target,(o>0||l>0)&&(!s||!s.shadowRoot))i=o,r=l;else{let t=e.getBoundingClientRect();i=a.clientX-t.left,r=a.clientY-t.top,h=!0}return{x:i,y:r,box:h}}(t,i),c=a.left+(u&&o.left),d=a.top+(u&&o.top),{width:f,height:p}=e;return n&&(f-=a.width+o.width,p-=a.height+o.height),{x:Math.round((l-c)/f*i.width/r),y:Math.round((h-d)/p*i.height/r)}}let eI=t=>Math.round(10*t)/10;function ej(t,e,i){let r=e||1,s=Math.floor(t.height*r),n=Math.floor(t.width*r);t.height=Math.floor(t.height),t.width=Math.floor(t.width);let a=t.canvas;return a.style&&(i||!a.style.height&&!a.style.width)&&(a.style.height=`${t.height}px`,a.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==r||a.height!==s||a.width!==n)&&(t.currentDevicePixelRatio=r,a.height=s,a.width=n,t.ctx.setTransform(r,0,0,r,0,0),!0)}let eL=function(){let t=!1;try{let e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(t){}return t}();function e$(t,e){let i=eP(t).getPropertyValue(e),r=i&&i.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function eB(t,e,i,r){return{x:t.x+i*(e.x-t.x),y:t.y+i*(e.y-t.y)}}function eN(t,e,i,r){return{x:t.x+i*(e.x-t.x),y:"middle"===r?i<.5?t.y:e.y:"after"===r?i<1?t.y:e.y:i>0?e.y:t.y}}function eU(t,e,i,r){let s={x:t.cp2x,y:t.cp2y},n={x:e.cp1x,y:e.cp1y},a=eB(t,s,i),o=eB(s,n,i),l=eB(n,e,i),h=eB(a,o,i),u=eB(o,l,i);return eB(h,u,i)}function eF(t,e,i){var r;return t?(r=i,{x:t=>e+e+r-t,setWidth(t){r=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}function ez(t,e){let i,r;("ltr"===e||"rtl"===e)&&(r=[(i=t.canvas.style).getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),t.prevTextDirection=r)}function eV(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function eW(t){return"angle"===t?{between:tv,compare:t_,normalize:tw}:{between:tk,compare:(t,e)=>t-e,normalize:t=>t}}function eH({start:t,end:e,count:i,loop:r,style:s}){return{start:t%i,end:e%i,loop:r&&(e-t+1)%i==0,style:s}}function eq(t,e,i){let r,s,n;if(!i)return[t];let{property:a,start:o,end:l}=i,h=e.length,{compare:u,between:c,normalize:d}=eW(a),{start:f,end:p,loop:g,style:m}=function(t,e,i){let r,{property:s,start:n,end:a}=i,{between:o,normalize:l}=eW(s),h=e.length,{start:u,end:c,loop:d}=t;if(d){for(u+=h,c+=h,r=0;r<h&&o(l(e[u%h][s]),n,a);++r)u--,c--;u%=h,c%=h}return c<u&&(c+=h),{start:u,end:c,loop:d,style:t.style}}(t,e,i),b=[],y=!1,_=null,w=()=>y||c(o,n,r)&&0!==u(o,n),v=()=>!y||0===u(l,r)||c(l,n,r);for(let t=f,i=f;t<=p;++t)(s=e[t%h]).skip||(r=d(s[a]))!==n&&(y=c(r,o,l),null===_&&w()&&(_=0===u(r,o)?t:i),null!==_&&v()&&(b.push(eH({start:_,end:t,loop:g,count:h,style:m})),_=null),i=t,n=r);return null!==_&&b.push(eH({start:_,end:p,loop:g,count:h,style:m})),b}function eK(t,e){let i=[],r=t.segments;for(let s=0;s<r.length;s++){let n=eq(r[s],t.points,e);n.length&&i.push(...n)}return i}function eJ(t,e,i,r){return r&&r.setContext&&i?function(t,e,i,r){let s=t._chart.getContext(),n=eG(t.options),{_datasetIndex:a,options:{spanGaps:o}}=t,l=i.length,h=[],u=n,c=e[0].start,d=c;function f(t,e,r,s){let n=o?-1:1;if(t!==e){for(t+=l;i[t%l].skip;)t-=n;for(;i[e%l].skip;)e+=n;t%l!=e%l&&(h.push({start:t%l,end:e%l,loop:r,style:s}),u=s,c=e%l)}}for(let t of e){let e,n=i[(c=o?c:t.start)%l];for(d=c+1;d<=t.end;d++){let o=i[d%l];(function(t,e){if(!e)return!1;let i=[],r=function(t,e){return tU(e)?(i.includes(e)||i.push(e),i.indexOf(e)):e};return JSON.stringify(t,r)!==JSON.stringify(e,r)})(e=eG(r.setContext(eu(s,{type:"segment",p0:n,p1:o,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:a}))),u)&&f(c,d-1,t.loop,u),n=o,u=e}c<d-1&&f(c,d-1,t.loop,u)}return h}(t,e,i,r):e}function eG(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}var eY=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,r){let s=e.listeners[r],n=e.duration;s.forEach(r=>r({chart:t,initial:e.initial,numSteps:n,currentStep:Math.min(i-e.start,n)}))}_refresh(){this._request||(this._running=!0,this._request=tP.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((i,r)=>{let s;if(!i.running||!i.items.length)return;let n=i.items,a=n.length-1,o=!1;for(;a>=0;--a)(s=n[a])._active?(s._total>i.duration&&(i.duration=s._total),s.tick(t),o=!0):(n[a]=n[n.length-1],n.pop());o&&(r.draw(),this._notify(r,i,t,"progress")),n.length||(i.running=!1,this._notify(r,i,t,"complete"),i.initial=!1),e+=n.length}),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){let e=this._charts,i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){let e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((t,e)=>Math.max(t,e._duration),0),this._refresh())}running(t){if(!this._running)return!1;let e=this._charts.get(t);return!!e&&!!e.running&&!!e.items.length}stop(t){let e=this._charts.get(t);if(!e||!e.items.length)return;let i=e.items,r=i.length-1;for(;r>=0;--r)i[r].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}};let eX="transparent",eZ={boolean:(t,e,i)=>i>.5?e:t,color(t,e,i){let r=tF(t||eX),s=r.valid&&tF(e||eX);return s&&s.valid?s.mix(r,i).hexString():e},number:(t,e,i)=>t+(e-t)*i};class eQ{constructor(t,e,i,r){const s=e[i];r=eh([t.to,r,s,t.from]);const n=eh([t.from,s,r]);this._active=!0,this._fn=t.fn||eZ[t.type||typeof n],this._easing=tN[t.easing]||tN.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=n,this._to=r,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);let r=this._target[this._prop],s=i-this._start,n=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(n,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=eh([t.to,e,r,t.from]),this._from=eh([t.from,r,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){let e,i=t-this._start,r=this._duration,s=this._prop,n=this._from,a=this._loop,o=this._to;if(this._active=n!==o&&(a||i<r),!this._active){this._target[s]=o,this._notify(!0);return}if(i<0){this._target[s]=n;return}e=i/r%2,e=a&&e>1?2-e:e,e=this._easing(Math.min(1,Math.max(0,e))),this._target[s]=this._fn(n,o,e)}wait(){let t=this._promises||(this._promises=[]);return new Promise((e,i)=>{t.push({res:e,rej:i})})}_notify(t){let e=t?"res":"rej",i=this._promises||[];for(let t=0;t<i.length;t++)i[t][e]()}}class e0{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!j(t))return;let e=Object.keys(tZ.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{let s=t[r];if(!j(s))return;let n={};for(let t of e)n[t]=s[t];(I(s.properties)&&s.properties||[r]).forEach(t=>{t!==r&&i.has(t)||i.set(t,n)})})}_animateOptions(t,e){let i=e.options,r=function(t,e){if(!e)return;let i=t.options;if(!i){t.options=e;return}return i.$shared&&(t.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i}(t,i);if(!r)return[];let s=this._createAnimations(r,i);return i.$shared&&(function(t,e){let i=[],r=Object.keys(e);for(let e=0;e<r.length;e++){let s=t[r[e]];s&&s.active()&&i.push(s.wait())}return Promise.all(i)})(t.options.$animations,i).then(()=>{t.options=i},()=>{}),s}_createAnimations(t,e){let i,r=this._properties,s=[],n=t.$animations||(t.$animations={}),a=Object.keys(e),o=Date.now();for(i=a.length-1;i>=0;--i){let l=a[i];if("$"===l.charAt(0))continue;if("options"===l){s.push(...this._animateOptions(t,e));continue}let h=e[l],u=n[l],c=r.get(l);if(u)if(c&&u.active()){u.update(c,h,o);continue}else u.cancel();if(!c||!c.duration){t[l]=h;continue}n[l]=u=new eQ(c,t,l,h),s.push(u)}return s}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);let i=this._createAnimations(t,e);if(i.length)return eY.add(this._chart,i),!0}}function e1(t,e){let i=t&&t.options||{},r=i.reverse,s=void 0===i.min?e:0,n=void 0===i.max?e:0;return{start:r?n:s,end:r?s:n}}function e2(t,e){let i,r,s=[],n=t._getSortedDatasetMetas(e);for(i=0,r=n.length;i<r;++i)s.push(n[i].index);return s}function e5(t,e,i,r={}){let s,n,a,o,l=t.keys,h="single"===r.mode;if(null!==e){for(s=0,n=l.length;s<n;++s){if((a=+l[s])===i){if(r.all)continue;break}L(o=t.values[a])&&(h||0===e||tu(e)===tu(o))&&(e+=o)}return e}}function e8(t,e){let i=t&&t.options.stacked;return i||void 0===i&&void 0!==e.stack}function e3(t,e,i,r){for(let s of e.getMatchingVisibleMetas(r).reverse()){let e=t[s.index];if(i&&e>0||!i&&e<0)return s.index}return null}function e6(t,e){let i,{chart:r,_cachedMeta:s}=t,n=r._stacks||(r._stacks={}),{iScale:a,vScale:o,index:l}=s,h=a.axis,u=o.axis,c=`${a.id}.${o.id}.${s.stack||s.type}`,d=e.length;for(let t=0;t<d;++t){let r=e[t],{[h]:a,[u]:d}=r;(i=(r._stacks||(r._stacks={}))[u]=function(t,e,i){let r=t[e]||(t[e]={});return r[i]||(r[i]={})}(n,c,a))[l]=d,i._top=e3(i,o,!0,s.type),i._bottom=e3(i,o,!1,s.type),(i._visualValues||(i._visualValues={}))[l]=d}}function e4(t,e){let i=t.scales;return Object.keys(i).filter(t=>i[t].axis===e).shift()}function e9(t,e){let i=t.controller.index,r=t.vScale&&t.vScale.axis;if(r)for(let s of e=e||t._parsed){let t=s._stacks;if(!t||void 0===t[r]||void 0===t[r][i])return;delete t[r][i],void 0!==t[r]._visualValues&&void 0!==t[r]._visualValues[i]&&delete t[r]._visualValues[i]}}let e7=t=>"reset"===t||"none"===t,it=(t,e)=>e?t:Object.assign({},t);class ie{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){let t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=e8(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&e9(this._cachedMeta),this.index=t}linkScales(){let t=this.chart,e=this._cachedMeta,i=this.getDataset(),r=(t,e,i,r)=>"x"===t?e:"r"===t?r:i,s=e.xAxisID=B(i.xAxisID,e4(t,"x")),n=e.yAxisID=B(i.yAxisID,e4(t,"y")),a=e.rAxisID=B(i.rAxisID,e4(t,"r")),o=e.indexAxis,l=e.iAxisID=r(o,s,n,a),h=e.vAxisID=r(o,n,s,a);e.xScale=this.getScaleForId(s),e.yScale=this.getScaleForId(n),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(l),e.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){let e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){let t=this._cachedMeta;this._data&&tA(this._data,this),t._stacked&&e9(t)}_dataCheck(){let t=this.getDataset(),e=t.data||(t.data=[]),i=this._data;if(j(e))this._data=function(t){let e,i,r,s=Object.keys(t),n=Array(s.length);for(e=0,i=s.length;e<i;++e)r=s[e],n[e]={x:r,y:t[r]};return n}(e);else if(i!==e){if(i){tA(i,this);let t=this._cachedMeta;e9(t),t._parsed=[]}e&&Object.isExtensible(e)&&(e._chartjs?e._chartjs.listeners.push(this):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[this]}}),tO.forEach(t=>{let i="_onData"+X(t),r=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value(...t){let s=r.apply(this,t);return e._chartjs.listeners.forEach(e=>{"function"==typeof e[i]&&e[i](...t)}),s}})}))),this._syncList=[],this._data=e}}addElements(){let t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){let e=this._cachedMeta,i=this.getDataset(),r=!1;this._dataCheck();let s=e._stacked;e._stacked=e8(e.vScale,e),e.stack!==i.stack&&(r=!0,e9(e),e.stack=i.stack),this._resyncElements(t),(r||s!==e._stacked)&&e6(this,e._parsed)}configure(){let t=this.chart.config,e=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){let i,r,s,{_cachedMeta:n,_data:a}=this,{iScale:o,_stacked:l}=n,h=o.axis,u=0===t&&e===a.length||n._sorted,c=t>0&&n._parsed[t-1];if(!1===this._parsing)n._parsed=a,n._sorted=!0,s=a;else{s=I(a[t])?this.parseArrayData(n,a,t,e):j(a[t])?this.parseObjectData(n,a,t,e):this.parsePrimitiveData(n,a,t,e);let o=()=>null===r[h]||c&&r[h]<c[h];for(i=0;i<e;++i)n._parsed[i+t]=r=s[i],u&&(o()&&(u=!1),c=r);n._sorted=u}l&&e6(this,s)}parsePrimitiveData(t,e,i,r){let s,n,{iScale:a,vScale:o}=t,l=a.axis,h=o.axis,u=a.getLabels(),c=a===o,d=Array(r);for(s=0;s<r;++s)n=s+i,d[s]={[l]:c||a.parse(u[n],n),[h]:o.parse(e[n],n)};return d}parseArrayData(t,e,i,r){let s,n,a,{xScale:o,yScale:l}=t,h=Array(r);for(s=0;s<r;++s)a=e[n=s+i],h[s]={x:o.parse(a[0],n),y:l.parse(a[1],n)};return h}parseObjectData(t,e,i,r){let s,n,a,{xScale:o,yScale:l}=t,{xAxisKey:h="x",yAxisKey:u="y"}=this._parsing,c=Array(r);for(s=0;s<r;++s)a=e[n=s+i],c[s]={x:o.parse(Y(a,h),n),y:l.parse(Y(a,u),n)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,i){let r=this.chart,s=this._cachedMeta,n=e[t.axis];return e5({keys:e2(r,!0),values:e._stacks[t.axis]._visualValues},n,s.index,{mode:i})}updateRangeFromParsed(t,e,i,r){let s=i[e.axis],n=null===s?NaN:s,a=r&&i._stacks[e.axis];r&&a&&(r.values=a,n=e5(r,s,this._cachedMeta.index)),t.min=Math.min(t.min,n),t.max=Math.max(t.max,n)}getMinMax(t,e){let i,r,s,n=this._cachedMeta,a=n._parsed,o=n._sorted&&t===n.iScale,l=a.length,h=this._getOtherScale(t),u=(s=this.chart,e&&!n.hidden&&n._stacked&&{keys:e2(s,!0),values:null}),c={min:1/0,max:-1/0},{min:d,max:f}=function(t){let{min:e,max:i,minDefined:r,maxDefined:s}=t.getUserBounds();return{min:r?e:-1/0,max:s?i:1/0}}(h);function p(){let e=(r=a[i])[h.axis];return!L(r[t.axis])||d>e||f<e}for(i=0;i<l&&(p()||(this.updateRangeFromParsed(c,t,r,u),!o));++i);if(o){for(i=l-1;i>=0;--i)if(!p()){this.updateRangeFromParsed(c,t,r,u);break}}return c}getAllParsedValues(t){let e,i,r,s=this._cachedMeta._parsed,n=[];for(e=0,i=s.length;e<i;++e)L(r=s[e][t.axis])&&n.push(r);return n}getMaxOverflow(){return!1}getLabelAndValue(t){let e=this._cachedMeta,i=e.iScale,r=e.vScale,s=this.getParsed(t);return{label:i?""+i.getLabelForValue(s[i.axis]):"",value:r?""+r.getLabelForValue(s[r.axis]):""}}_update(t){var e;let i,r,s,n,a=this._cachedMeta;this.update(t||"default"),j(e=B(this.options.clip,function(t,e,i){if(!1===i)return!1;let r=e1(t,i),s=e1(e,i);return{top:s.end,right:r.end,bottom:s.start,left:r.start}}(a.xScale,a.yScale,this.getMaxOverflow())))?(i=e.top,r=e.right,s=e.bottom,n=e.left):i=r=s=n=e,a._clip={top:i,right:r,bottom:s,left:n,disabled:!1===e}}update(t){}draw(){let t,e=this._ctx,i=this.chart,r=this._cachedMeta,s=r.data||[],n=i.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||s.length-o,h=this.options.drawActiveElementsOnTop;for(r.dataset&&r.dataset.draw(e,n,o,l),t=o;t<o+l;++t){let i=s[t];i.hidden||(i.active&&h?a.push(i):i.draw(e,n))}for(t=0;t<a.length;++t)a[t].draw(e,n)}getStyle(t,e){let i=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,e,i){var r,s;let n,a=this.getDataset();if(t>=0&&t<this._cachedMeta.data.length){let e=this._cachedMeta.data[t];(n=e.$context||(r=this.getContext(),e.$context=eu(r,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"}))).parsed=this.getParsed(t),n.raw=a.data[t],n.index=n.dataIndex=t}else(n=this.$context||(this.$context=eu(this.chart.getContext(),{active:!1,dataset:void 0,datasetIndex:s=this.index,index:s,mode:"default",type:"dataset"}))).dataset=a,n.index=n.datasetIndex=this.index;return n.active=!!e,n.mode=i,n}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",i){let r="active"===e,s=this._cachedDataOpts,n=t+"-"+e,a=s[n],o=this.enableOptionSharing&&Z(i);if(a)return it(a,o);let l=this.chart.config,h=l.datasetElementScopeKeys(this._type,t),u=r?[`${t}Hover`,"hover",t,""]:[t,""],c=l.getOptionScopes(this.getDataset(),h),d=Object.keys(tZ.elements[t]),f=()=>this.getContext(i,r,e),p=l.resolveNamedOptions(c,d,f,u);return p.$shared&&(p.$shared=o,s[n]=Object.freeze(it(p,o))),p}_resolveAnimations(t,e,i){let r,s=this.chart,n=this._cachedDataOpts,a=`animation-${e}`,o=n[a];if(o)return o;if(!1!==s.options.animation){let s=this.chart.config,n=s.datasetAnimationScopeKeys(this._type,e),a=s.getOptionScopes(this.getDataset(),n);r=s.createResolver(a,this.getContext(t,i,e))}let l=new e0(s,r&&r.animations);return r&&r._cacheable&&(n[a]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||e7(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){let i=this.resolveDataElementOptions(t,e),r=this._sharedOptions,s=this.getSharedOptions(i),n=this.includeOptions(e,s)||s!==r;return this.updateSharedOptions(s,e,i),{sharedOptions:s,includeOptions:n}}updateElement(t,e,i,r){e7(r)?Object.assign(t,i):this._resolveAnimations(e,r).update(t,i)}updateSharedOptions(t,e,i){t&&!e7(e)&&this._resolveAnimations(void 0,e).update(t,i)}_setStyle(t,e,i,r){t.active=r;let s=this.getStyle(e,r);this._resolveAnimations(e,i,r).update(t,{options:!r&&this.getSharedOptions(s)||s})}removeHoverStyle(t,e,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,e,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){let t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){let t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){let e=this._data,i=this._cachedMeta.data;for(let[t,e,i]of this._syncList)this[t](e,i);this._syncList=[];let r=i.length,s=e.length,n=Math.min(s,r);n&&this.parse(0,n),s>r?this._insertElements(r,s-r,t):s<r&&this._removeElements(s,r-s)}_insertElements(t,e,i=!0){let r,s=this._cachedMeta,n=s.data,a=t+e,o=t=>{for(t.length+=e,r=t.length-1;r>=a;r--)t[r]=t[r-e]};for(o(n),r=t;r<a;++r)n[r]=new this.dataElementType;this._parsing&&o(s._parsed),this.parse(t,e),i&&this.updateElements(n,t,e,"reset")}updateElements(t,e,i,r){}_removeElements(t,e){let i=this._cachedMeta;if(this._parsing){let r=i._parsed.splice(t,e);i._stacked&&e9(i,r)}i.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{let[e,i,r]=t;this[e](i,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){let t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);let i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function ii(t,e,i,r){if(I(t)){let s,n,a,o,l,h;s=i.parse(t[0],r),a=Math.min(s,n=i.parse(t[1],r)),o=Math.max(s,n),l=a,h=o,Math.abs(a)>Math.abs(o)&&(l=o,h=a),e[i.axis]=h,e._custom={barStart:l,barEnd:h,start:s,end:n,min:a,max:o}}else e[i.axis]=i.parse(t,r);return e}function ir(t,e,i,r){let s,n,a,o,l=t.iScale,h=t.vScale,u=l.getLabels(),c=l===h,d=[];for(s=i,n=i+r;s<n;++s)o=e[s],(a={})[l.axis]=c||l.parse(u[s],s),d.push(ii(o,a,h,s));return d}function is(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function ia(t,e,i,r){var s,n,a;return r?io((s=t,n=e,a=i,t=s===n?a:s===a?n:s),i,e):io(t,e,i)}function io(t,e,i){return"start"===t?e:"end"===t?i:t}class il extends ie{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,i,r){return ir(t,e,i,r)}parseArrayData(t,e,i,r){return ir(t,e,i,r)}parseObjectData(t,e,i,r){let s,n,a,o,{iScale:l,vScale:h}=t,{xAxisKey:u="x",yAxisKey:c="y"}=this._parsing,d="x"===l.axis?u:c,f="x"===h.axis?u:c,p=[];for(s=i,n=i+r;s<n;++s)o=e[s],(a={})[l.axis]=l.parse(Y(o,d),s),p.push(ii(Y(o,f),a,h,s));return p}updateRangeFromParsed(t,e,i,r){super.updateRangeFromParsed(t,e,i,r);let s=i._custom;s&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,s.min),t.max=Math.max(t.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(t){let{iScale:e,vScale:i}=this._cachedMeta,r=this.getParsed(t),s=r._custom,n=is(s)?"["+s.start+", "+s.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+e.getLabelForValue(r[e.axis]),value:n}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(t){let e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,i,r){let s="reset"===r,{index:n,_cachedMeta:{vScale:a}}=this,o=a.getBasePixel(),l=a.isHorizontal(),h=this._getRuler(),{sharedOptions:u,includeOptions:c}=this._getSharedOptions(e,r);for(let d=e;d<e+i;d++){let e=this.getParsed(d),i=s||D(e[a.axis])?{base:o,head:o}:this._calculateBarValuePixels(d),f=this._calculateBarIndexPixels(d,h),p=(e._stacks||{})[a.axis],g={horizontal:l,base:i.base,enableBorderRadius:!p||is(e._custom)||n===p._top||n===p._bottom,x:l?i.head:f.center,y:l?f.center:i.head,height:l?f.size:Math.abs(i.size),width:l?Math.abs(i.size):f.size};c&&(g.options=u||this.resolveDataElementOptions(d,t[d].active?"active":r));let m=g.options||t[d].options;!function(t,e,i,r){let s,n,a,o,l,h=e.borderSkipped,u={};if(!h){t.borderSkipped=u;return}if(!0===h){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}let{start:c,end:d,reverse:f,top:p,bottom:g}=(t.horizontal?(s=t.base>t.x,n="left",a="right"):(s=t.base<t.y,n="bottom",a="top"),s?(o="end",l="start"):(o="start",l="end"),{start:n,end:a,reverse:s,top:o,bottom:l});"middle"===h&&i&&(t.enableBorderRadius=!0,(i._top||0)===r?h=p:(i._bottom||0)===r?h=g:(u[ia(g,c,d,f)]=!0,h=p)),u[ia(h,c,d,f)]=!0,t.borderSkipped=u}(g,m,p,n),function(t,{inflateAmount:e},i){t.inflateAmount="auto"===e?.33*(1===i):e}(g,m,h.ratio),this.updateElement(t[d],d,g,r)}}_getStacks(t,e){let{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(t=>t.controller.options.grouped),s=i.options.stacked,n=[],a=t=>{let i=t.controller.getParsed(e),r=i&&i[t.vScale.axis];if(D(r)||isNaN(r))return!0};for(let i of r)if(!(void 0!==e&&a(i))&&((!1===s||-1===n.indexOf(i.stack)||void 0===s&&void 0===i.stack)&&n.push(i.stack),i.index===t))break;return n.length||n.push(void 0),n}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,i){let r=this._getStacks(t,i),s=void 0!==e?r.indexOf(e):-1;return -1===s?r.length-1:s}_getRuler(){let t,e,i=this.options,r=this._cachedMeta,s=r.iScale,n=[];for(t=0,e=r.data.length;t<e;++t)n.push(s.getPixelForValue(this.getParsed(t)[s.axis],t));let a=i.barThickness;return{min:a||function(t){let e,i,r,s,n=t.iScale,a=function(t,e){if(!t._cache.$bar){let i=t.getMatchingVisibleMetas(e),r=[];for(let e=0,s=i.length;e<s;e++)r=r.concat(i[e].controller.getAllParsedValues(t));t._cache.$bar=tR(r.sort((t,e)=>t-e))}return t._cache.$bar}(n,t.type),o=n._length,l=()=>{32767!==r&&-32768!==r&&(Z(s)&&(o=Math.min(o,Math.abs(r-s)||o)),s=r)};for(e=0,i=a.length;e<i;++e)r=n.getPixelForValue(a[e]),l();for(e=0,s=void 0,i=n.ticks.length;e<i;++e)r=n.getPixelForTick(e),l();return o}(r),pixels:n,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:i.grouped,ratio:a?1:i.categoryPercentage*i.barPercentage}}_calculateBarValuePixels(t){let e,i,{_cachedMeta:{vScale:r,_stacked:s,index:n},options:{base:a,minBarLength:o}}=this,l=a||0,h=this.getParsed(t),u=h._custom,c=is(u),d=h[r.axis],f=0,p=s?this.applyStack(r,h,s):d;p!==d&&(f=p-d,p=d),c&&(d=u.barStart,p=u.barEnd-u.barStart,0!==d&&tu(d)!==tu(u.barEnd)&&(f=0),f+=d);let g=D(a)||c?f:a,m=r.getPixelForValue(g);if(Math.abs(i=(e=this.chart.getDataVisibility(t)?r.getPixelForValue(f+p):m)-m)<o){var b;i=(0!==(b=i)?tu(b):(r.isHorizontal()?1:-1)*(r.min>=l?1:-1))*o,d===l&&(m-=i/2);let t=r.getPixelForDecimal(0),a=r.getPixelForDecimal(1),u=Math.min(t,a);e=(m=Math.max(Math.min(m,Math.max(t,a)),u))+i,s&&!c&&(h._stacks[r.axis]._visualValues[n]=r.getValueForPixel(e)-r.getValueForPixel(m))}if(m===r.getPixelForValue(l)){let t=tu(i)*r.getLineWidthForValue(l)/2;m+=t,i-=t}return{size:i,base:m,head:e,center:e+i/2}}_calculateBarIndexPixels(t,e){let i,r,s=e.scale,n=this.options,a=n.skipNull,o=B(n.maxBarThickness,1/0);if(e.grouped){let s,l,h,u,c,d,f,p,g,m=a?this._getStackCount(t):e.stackCount,b="flex"===n.barThickness?(l=(s=e.pixels)[t],h=t>0?s[t-1]:null,u=t<s.length-1?s[t+1]:null,c=n.categoryPercentage,null===h&&(h=l-(null===u?e.end-e.start:u-l)),null===u&&(u=l+l-h),d=l-(l-Math.min(h,u))/2*c,{chunk:Math.abs(u-h)/2*c/m,ratio:n.barPercentage,start:d}):(D(g=n.barThickness)?(f=e.min*n.categoryPercentage,p=n.barPercentage):(f=g*m,p=1),{chunk:f/m,ratio:p,start:e.pixels[t]-f/2}),y=this._getStackIndex(this.index,this._cachedMeta.stack,a?t:void 0);i=b.start+b.chunk*y+b.chunk/2,r=Math.min(o,b.chunk*b.ratio)}else i=s.getPixelForValue(this.getParsed(t)[s.axis],t),r=Math.min(o,e.min*e.ratio);return{base:i-r/2,head:i+r/2,center:i,size:r}}draw(){let t=this._cachedMeta,e=t.vScale,i=t.data,r=i.length,s=0;for(;s<r;++s)null!==this.getParsed(s)[e.axis]&&i[s].draw(this._ctx)}}class ih extends ie{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,i,r){let s=super.parsePrimitiveData(t,e,i,r);for(let t=0;t<s.length;t++)s[t]._custom=this.resolveDataElementOptions(t+i).radius;return s}parseArrayData(t,e,i,r){let s=super.parseArrayData(t,e,i,r);for(let t=0;t<s.length;t++){let r=e[i+t];s[t]._custom=B(r[2],this.resolveDataElementOptions(t+i).radius)}return s}parseObjectData(t,e,i,r){let s=super.parseObjectData(t,e,i,r);for(let t=0;t<s.length;t++){let r=e[i+t];s[t]._custom=B(r&&r.r&&+r.r,this.resolveDataElementOptions(t+i).radius)}return s}getMaxOverflow(){let t=this._cachedMeta.data,e=0;for(let i=t.length-1;i>=0;--i)e=Math.max(e,t[i].size(this.resolveDataElementOptions(i))/2);return e>0&&e}getLabelAndValue(t){let e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:s}=e,n=this.getParsed(t),a=r.getLabelForValue(n.x),o=s.getLabelForValue(n.y),l=n._custom;return{label:i[t]||"",value:"("+a+", "+o+(l?", "+l:"")+")"}}update(t){let e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,i,r){let s="reset"===r,{iScale:n,vScale:a}=this._cachedMeta,{sharedOptions:o,includeOptions:l}=this._getSharedOptions(e,r),h=n.axis,u=a.axis;for(let c=e;c<e+i;c++){let e=t[c],i=!s&&this.getParsed(c),d={},f=d[h]=s?n.getPixelForDecimal(.5):n.getPixelForValue(i[h]),p=d[u]=s?a.getBasePixel():a.getPixelForValue(i[u]);d.skip=isNaN(f)||isNaN(p),l&&(d.options=o||this.resolveDataElementOptions(c,e.active?"active":r),s&&(d.options.radius=0)),this.updateElement(e,c,d,r)}}resolveDataElementOptions(t,e){let i=this.getParsed(t),r=super.resolveDataElementOptions(t,e);r.$shared&&(r=Object.assign({},r,{$shared:!1}));let s=r.radius;return"active"!==e&&(r.radius=0),r.radius+=B(i&&i._custom,s),r}}class iu extends ie{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){let e=t.data;if(e.labels.length&&e.datasets.length){let{labels:{pointStyle:i,color:r}}=t.legend.options;return e.labels.map((e,s)=>{let n=t.getDatasetMeta(0).controller.getStyle(s);return{text:e,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,fontColor:r,lineWidth:n.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(s),index:s}})}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}}};constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){let i=this.getDataset().data,r=this._cachedMeta;if(!1===this._parsing)r._parsed=i;else{let s,n,a=t=>+i[t];if(j(i[t])){let{key:t="value"}=this._parsing;a=e=>+Y(i[e],t)}for(s=t,n=t+e;s<n;++s)r._parsed[s]=a(s)}}_getRotation(){return tg(this.options.rotation-90)}_getCircumference(){return tg(this.options.circumference)}_getRotationExtents(){let t=ti,e=-ti;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){let r=this.chart.getDatasetMeta(i).controller,s=r._getRotation(),n=r._getCircumference();t=Math.min(t,s),e=Math.max(e,s+n)}return{rotation:t,circumference:e-t}}update(t){let e,{chartArea:i}=this.chart,r=this._cachedMeta,s=r.data,n=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-n)/2,0),o=Math.min((e=this.options.cutout,"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100:e/a),1),l=this._getRingWeight(this.index),{circumference:h,rotation:u}=this._getRotationExtents(),{ratioX:c,ratioY:d,offsetX:f,offsetY:p}=function(t,e,i){let r=1,s=1,n=0,a=0;if(e<ti){let o=t+e,l=Math.cos(t),h=Math.sin(t),u=Math.cos(o),c=Math.sin(o),d=(e,r,s)=>tv(e,t,o,!0)?1:Math.max(r,r*i,s,s*i),f=(e,r,s)=>tv(e,t,o,!0)?-1:Math.min(r,r*i,s,s*i),p=d(0,l,u),g=d(ta,h,c),m=f(te,l,u),b=f(te+ta,h,c);r=(p-m)/2,s=(g-b)/2,n=-(p+m)/2,a=-(g+b)/2}return{ratioX:r,ratioY:s,offsetX:n,offsetY:a}}(u,h,o),g=Math.max(Math.min((i.width-n)/c,(i.height-n)/d)/2,0),m=N(this.options.radius,g),b=Math.max(m*o,0),y=(m-b)/this._getVisibleDatasetWeightTotal();this.offsetX=f*m,this.offsetY=p*m,r.total=this.calculateTotal(),this.outerRadius=m-y*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-y*l,0),this.updateElements(s,0,s.length,t)}_circumference(t,e){let i=this.options,r=this._cachedMeta,s=this._getCircumference();return e&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||null===r._parsed[t]||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*s/ti)}updateElements(t,e,i,r){let s,n="reset"===r,a=this.chart,o=a.chartArea,l=a.options.animation,h=(o.left+o.right)/2,u=(o.top+o.bottom)/2,c=n&&l.animateScale,d=c?0:this.innerRadius,f=c?0:this.outerRadius,{sharedOptions:p,includeOptions:g}=this._getSharedOptions(e,r),m=this._getRotation();for(s=0;s<e;++s)m+=this._circumference(s,n);for(s=e;s<e+i;++s){let e=this._circumference(s,n),i=t[s],a={x:h+this.offsetX,y:u+this.offsetY,startAngle:m,endAngle:m+e,circumference:e,outerRadius:f,innerRadius:d};g&&(a.options=p||this.resolveDataElementOptions(s,i.active?"active":r)),m+=e,this.updateElement(i,s,a,r)}}calculateTotal(){let t,e=this._cachedMeta,i=e.data,r=0;for(t=0;t<i.length;t++){let s=e._parsed[t];null!==s&&!isNaN(s)&&this.chart.getDataVisibility(t)&&!i[t].hidden&&(r+=Math.abs(s))}return r}calculateCircumference(t){let e=this._cachedMeta.total;return e>0&&!isNaN(t)?Math.abs(t)/e*ti:0}getLabelAndValue(t){let e=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=tq(e._parsed[t],i.options.locale);return{label:r[t]||"",value:s}}getMaxBorderWidth(t){let e,i,r,s,n,a=0,o=this.chart;if(!t){for(e=0,i=o.data.datasets.length;e<i;++e)if(o.isDatasetVisible(e)){t=(r=o.getDatasetMeta(e)).data,s=r.controller;break}}if(!t)return 0;for(e=0,i=t.length;e<i;++e)"inner"!==(n=s.resolveDataElementOptions(e)).borderAlign&&(a=Math.max(a,n.borderWidth||0,n.hoverBorderWidth||0));return a}getMaxOffset(t){let e=0;for(let i=0,r=t.length;i<r;++i){let t=this.resolveDataElementOptions(i);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e}_getRingWeight(t){return Math.max(B(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class ic extends ie{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){let e=this._cachedMeta,{dataset:i,data:r=[],_dataset:s}=e,n=this.chart._animationsDisabled,{start:a,count:o}=tI(e,r,n);this._drawStart=a,this._drawCount=o,tj(e)&&(a=0,o=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!s._decimated,i.points=r;let l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(i,void 0,{animated:!n,options:l},t),this.updateElements(r,a,o,t)}updateElements(t,e,i,r){let s="reset"===r,{iScale:n,vScale:a,_stacked:o,_dataset:l}=this._cachedMeta,{sharedOptions:h,includeOptions:u}=this._getSharedOptions(e,r),c=n.axis,d=a.axis,{spanGaps:f,segment:p}=this.options,g=tf(f)?f:1/0,m=this.chart._animationsDisabled||s||"none"===r,b=e+i,y=t.length,_=e>0&&this.getParsed(e-1);for(let i=0;i<y;++i){let f=t[i],y=m?f:{};if(i<e||i>=b){y.skip=!0;continue}let w=this.getParsed(i),v=D(w[d]),x=y[c]=n.getPixelForValue(w[c],i),k=y[d]=s||v?a.getBasePixel():a.getPixelForValue(o?this.applyStack(a,w,o):w[d],i);y.skip=isNaN(x)||isNaN(k)||v,y.stop=i>0&&Math.abs(w[c]-_[c])>g,p&&(y.parsed=w,y.raw=l.data[i]),u&&(y.options=h||this.resolveDataElementOptions(i,f.active?"active":r)),m||this.updateElement(f,i,y,r),_=w}}getMaxOverflow(){let t=this._cachedMeta,e=t.dataset,i=e.options&&e.options.borderWidth||0,r=t.data||[];return r.length?Math.max(i,r[0].size(this.resolveDataElementOptions(0)),r[r.length-1].size(this.resolveDataElementOptions(r.length-1)))/2:i}draw(){let t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}class id extends ie{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){let e=t.data;if(e.labels.length&&e.datasets.length){let{labels:{pointStyle:i,color:r}}=t.legend.options;return e.labels.map((e,s)=>{let n=t.getDatasetMeta(0).controller.getStyle(s);return{text:e,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,fontColor:r,lineWidth:n.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(s),index:s}})}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){let e=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=tq(e._parsed[t].r,i.options.locale);return{label:r[t]||"",value:s}}parseObjectData(t,e,i,r){return ex.bind(this)(t,e,i,r)}update(t){let e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){let t=this._cachedMeta,e={min:1/0,max:-1/0};return t.data.forEach((t,i)=>{let r=this.getParsed(i).r;!isNaN(r)&&this.chart.getDataVisibility(i)&&(r<e.min&&(e.min=r),r>e.max&&(e.max=r))}),e}_updateRadius(){let t=this.chart,e=t.chartArea,i=t.options,r=Math.max(Math.min(e.right-e.left,e.bottom-e.top)/2,0),s=Math.max(i.cutoutPercentage?r/100*i.cutoutPercentage:1,0),n=(r-s)/t.getVisibleDatasetCount();this.outerRadius=r-n*this.index,this.innerRadius=this.outerRadius-n}updateElements(t,e,i,r){let s,n="reset"===r,a=this.chart,o=a.options.animation,l=this._cachedMeta.rScale,h=l.xCenter,u=l.yCenter,c=l.getIndexAngle(0)-.5*te,d=c,f=360/this.countVisibleElements();for(s=0;s<e;++s)d+=this._computeAngle(s,r,f);for(s=e;s<e+i;s++){let e=t[s],i=d,p=d+this._computeAngle(s,r,f),g=a.getDataVisibility(s)?l.getDistanceFromCenterForValue(this.getParsed(s).r):0;d=p,n&&(o.animateScale&&(g=0),o.animateRotate&&(i=p=c));let m={x:h,y:u,innerRadius:0,outerRadius:g,startAngle:i,endAngle:p,options:this.resolveDataElementOptions(s,e.active?"active":r)};this.updateElement(e,s,m,r)}}countVisibleElements(){let t=this._cachedMeta,e=0;return t.data.forEach((t,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&e++}),e}_computeAngle(t,e,i){return this.chart.getDataVisibility(t)?tg(this.resolveDataElementOptions(t,e).angle||i):0}}class ip extends iu{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class ig extends ie{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){let e=this._cachedMeta.vScale,i=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(i[e.axis])}}parseObjectData(t,e,i,r){return ex.bind(this)(t,e,i,r)}update(t){let e=this._cachedMeta,i=e.dataset,r=e.data||[],s=e.iScale.getLabels();if(i.points=r,"resize"!==t){let e=this.resolveDatasetElementOptions(t);this.options.showLine||(e.borderWidth=0);let n={_loop:!0,_fullLoop:s.length===r.length,options:e};this.updateElement(i,void 0,n,t)}this.updateElements(r,0,r.length,t)}updateElements(t,e,i,r){let s=this._cachedMeta.rScale,n="reset"===r;for(let a=e;a<e+i;a++){let e=t[a],i=this.resolveDataElementOptions(a,e.active?"active":r),o=s.getPointPositionForValue(a,this.getParsed(a).r),l=n?s.xCenter:o.x,h=n?s.yCenter:o.y,u={x:l,y:h,angle:o.angle,skip:isNaN(l)||isNaN(h),options:i};this.updateElement(e,a,u,r)}}}class im extends ie{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){let e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:s}=e,n=this.getParsed(t),a=r.getLabelForValue(n.x),o=s.getLabelForValue(n.y);return{label:i[t]||"",value:"("+a+", "+o+")"}}update(t){let e=this._cachedMeta,{data:i=[]}=e,r=this.chart._animationsDisabled,{start:s,count:n}=tI(e,i,r);if(this._drawStart=s,this._drawCount=n,tj(e)&&(s=0,n=i.length),this.options.showLine){this.datasetElementType||this.addElements();let{dataset:s,_dataset:n}=e;s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!n._decimated,s.points=i;let a=this.resolveDatasetElementOptions(t);a.segment=this.options.segment,this.updateElement(s,void 0,{animated:!r,options:a},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(i,s,n,t)}addElements(){let{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,i,r){let s="reset"===r,{iScale:n,vScale:a,_stacked:o,_dataset:l}=this._cachedMeta,h=this.resolveDataElementOptions(e,r),u=this.getSharedOptions(h),c=this.includeOptions(r,u),d=n.axis,f=a.axis,{spanGaps:p,segment:g}=this.options,m=tf(p)?p:1/0,b=this.chart._animationsDisabled||s||"none"===r,y=e>0&&this.getParsed(e-1);for(let h=e;h<e+i;++h){let e=t[h],i=this.getParsed(h),p=b?e:{},_=D(i[f]),w=p[d]=n.getPixelForValue(i[d],h),v=p[f]=s||_?a.getBasePixel():a.getPixelForValue(o?this.applyStack(a,i,o):i[f],h);p.skip=isNaN(w)||isNaN(v)||_,p.stop=h>0&&Math.abs(i[d]-y[d])>m,g&&(p.parsed=i,p.raw=l.data[h]),c&&(p.options=u||this.resolveDataElementOptions(h,e.active?"active":r)),b||this.updateElement(e,h,p,r),y=i}this.updateSharedOptions(u,r,h)}getMaxOverflow(){let t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let t=0;for(let i=e.length-1;i>=0;--i)t=Math.max(t,e[i].size(this.resolveDataElementOptions(i))/2);return t>0&&t}let i=t.dataset,r=i.options&&i.options.borderWidth||0;return e.length?Math.max(r,e[0].size(this.resolveDataElementOptions(0)),e[e.length-1].size(this.resolveDataElementOptions(e.length-1)))/2:r}}function ib(){throw Error("This method is not implemented: Check that a complete date adapter is provided.")}class iy{static override(t){Object.assign(iy.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return ib()}parse(){return ib()}format(){return ib()}add(){return ib()}diff(){return ib()}startOf(){return ib()}endOf(){return ib()}}function i_(t,e,i,r,s){let n=t.getSortedVisibleDatasetMetas(),a=i[e];for(let t=0,i=n.length;t<i;++t){let{index:i,data:o}=n[t],{lo:l,hi:h}=function(t,e,i,r){let{controller:s,data:n,_sorted:a}=t,o=s._cachedMeta.iScale;if(o&&e===o.axis&&"r"!==e&&a&&n.length){let t=o._reversePixels?tT:tE;if(!r)return t(n,e,i);if(s._sharedOptions){let r=n[0],s="function"==typeof r.getRange&&r.getRange(e);if(s){let r=t(n,e,i-s),a=t(n,e,i+s);return{lo:r.lo,hi:a.hi}}}}return{lo:0,hi:n.length-1}}(n[t],e,a,s);for(let t=l;t<=h;++t){let e=o[t];e.skip||r(e,i,t)}}}function iw(t,e,i,r,s){let n=[];return(s||t.isPointInArea(e))&&i_(t,i,e,function(i,a,o){(s||t8(i,t.chartArea,0))&&i.inRange(e.x,e.y,r)&&n.push({element:i,datasetIndex:a,index:o})},!0),n}function iv(t,e,i,r,s,n){let a,o,l,h,u,c;return n||t.isPointInArea(e)?"r"!==i||r?(a=[],o=-1!==i.indexOf("x"),l=-1!==i.indexOf("y"),h=function(t,e){return Math.sqrt(Math.pow(o?Math.abs(t.x-e.x):0,2)+Math.pow(l?Math.abs(t.y-e.y):0,2))},u=1/0,i_(t,i,e,function(i,o,l){let c=i.inRange(e.x,e.y,s);if(r&&!c)return;let d=i.getCenterPoint(s);if(!(n||t.isPointInArea(d))&&!c)return;let f=h(e,d);f<u?(a=[{element:i,datasetIndex:o,index:l}],u=f):f===u&&a.push({element:i,datasetIndex:o,index:l})}),a):(c=[],i_(t,i,e,function(t,i,r){let{startAngle:n,endAngle:a}=t.getProps(["startAngle","endAngle"],s),{angle:o}=tb(t,{x:e.x,y:e.y});tv(o,n,a)&&c.push({element:t,datasetIndex:i,index:r})}),c):[]}function ix(t,e,i,r,s){let n=[],a="x"===i?"inXRange":"inYRange",o=!1;return(i_(t,i,e,(t,r,l)=>{t[a](e[i],s)&&(n.push({element:t,datasetIndex:r,index:l}),o=o||t.inRange(e.x,e.y,s))}),r&&!o)?[]:n}var ik={modes:{index(t,e,i,r){let s=eD(e,t),n=i.axis||"x",a=i.includeInvisible||!1,o=i.intersect?iw(t,s,n,r,a):iv(t,s,n,!1,r,a),l=[];return o.length?(t.getSortedVisibleDatasetMetas().forEach(t=>{let e=o[0].index,i=t.data[e];i&&!i.skip&&l.push({element:i,datasetIndex:t.index,index:e})}),l):[]},dataset(t,e,i,r){let s=eD(e,t),n=i.axis||"xy",a=i.includeInvisible||!1,o=i.intersect?iw(t,s,n,r,a):iv(t,s,n,!1,r,a);if(o.length>0){let e=o[0].datasetIndex,i=t.getDatasetMeta(e).data;o=[];for(let t=0;t<i.length;++t)o.push({element:i[t],datasetIndex:e,index:t})}return o},point(t,e,i,r){let s=eD(e,t);return iw(t,s,i.axis||"xy",r,i.includeInvisible||!1)},nearest(t,e,i,r){let s=eD(e,t),n=i.axis||"xy",a=i.includeInvisible||!1;return iv(t,s,n,i.intersect,r,a)},x(t,e,i,r){let s=eD(e,t);return ix(t,s,"x",i.intersect,r)},y(t,e,i,r){let s=eD(e,t);return ix(t,s,"y",i.intersect,r)}}};let iS=["left","top","right","bottom"];function iE(t,e){return t.filter(t=>t.pos===e)}function iT(t,e){return t.filter(t=>-1===iS.indexOf(t.pos)&&t.box.axis===e)}function iO(t,e){return t.sort((t,i)=>{let r=e?i:t,s=e?t:i;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function iA(t,e,i,r){return Math.max(t[i],e[i])+Math.max(t[r],e[r])}function iR(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function iP(t,e,i,r){let s,n,a,o,l,h,u=[];for(s=0,n=t.length,l=0;s<n;++s){(o=(a=t[s]).box).update(a.width||e.w,a.height||e.h,function(t,e){let i=e.maxPadding;return function(t){let r={left:0,top:0,right:0,bottom:0};return t.forEach(t=>{r[t]=Math.max(e[t],i[t])}),r}(t?["left","right"]:["top","bottom"])}(a.horizontal,e));let{same:n,other:c}=function(t,e,i,r){let{pos:s,box:n}=i,a=t.maxPadding;if(!j(s)){i.size&&(t[s]-=i.size);let e=r[i.stack]||{size:0,count:1};e.size=Math.max(e.size,i.horizontal?n.height:n.width),i.size=e.size/e.count,t[s]+=i.size}n.getPadding&&iR(a,n.getPadding());let o=Math.max(0,e.outerWidth-iA(a,t,"left","right")),l=Math.max(0,e.outerHeight-iA(a,t,"top","bottom")),h=o!==t.w,u=l!==t.h;return t.w=o,t.h=l,i.horizontal?{same:h,other:u}:{same:u,other:h}}(e,i,a,r);l|=n&&u.length,h=h||c,o.fullSize||u.push(a)}return l&&iP(u,e,i,r)||h}function iC(t,e,i,r,s){t.top=i,t.left=e,t.right=e+r,t.bottom=i+s,t.width=r,t.height=s}function iM(t,e,i,r){let s=i.padding,{x:n,y:a}=e;for(let o of t){let t=o.box,l=r[o.stack]||{count:1,placed:0,weight:1},h=o.stackWeight/l.weight||1;if(o.horizontal){let r=e.w*h,n=l.size||t.height;Z(l.start)&&(a=l.start),t.fullSize?iC(t,s.left,a,i.outerWidth-s.right-s.left,n):iC(t,e.left+l.placed,a,r,n),l.start=a,l.placed+=r,a=t.bottom}else{let r=e.h*h,a=l.size||t.width;Z(l.start)&&(n=l.start),t.fullSize?iC(t,n,s.top,a,i.outerHeight-s.bottom-s.top):iC(t,n,e.top+l.placed,a,r),l.start=n,l.placed+=r,n=t.right}}e.x=n,e.y=a}var iD={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){let i=t.boxes?t.boxes.indexOf(e):-1;-1!==i&&t.boxes.splice(i,1)},configure(t,e,i){e.fullSize=i.fullSize,e.position=i.position,e.weight=i.weight},update(t,e,i,r){let s,n,a,o,l,h,u,c;if(!t)return;let d=eo(t.options.layout.padding),f=Math.max(e-d.width,0),p=Math.max(i-d.height,0),g=(n=iO((s=function(t){let e,i,r,s,n,a,o=[];for(e=0,i=(t||[]).length;e<i;++e)r=t[e],({position:s,options:{stack:n,stackWeight:a=1}}=r),o.push({index:e,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:n&&s+n,stackWeight:a});return o}(t.boxes)).filter(t=>t.box.fullSize),!0),a=iO(iE(s,"left"),!0),o=iO(iE(s,"right")),l=iO(iE(s,"top"),!0),h=iO(iE(s,"bottom")),u=iT(s,"x"),c=iT(s,"y"),{fullSize:n,leftAndTop:a.concat(l),rightAndBottom:o.concat(c).concat(h).concat(u),chartArea:iE(s,"chartArea"),vertical:a.concat(o).concat(c),horizontal:l.concat(h).concat(u)}),m=g.vertical,b=g.horizontal;F(t.boxes,t=>{"function"==typeof t.beforeLayout&&t.beforeLayout()});let y=Object.freeze({outerWidth:e,outerHeight:i,padding:d,availableWidth:f,availableHeight:p,vBoxMaxWidth:f/2/(m.reduce((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1,0)||1),hBoxMaxHeight:p/2}),_=Object.assign({},d);iR(_,eo(r));let w=Object.assign({maxPadding:_,w:f,h:p,x:d.left,y:d.top},d),v=function(t,e){let i,r,s,n=function(t){let e={};for(let i of t){let{stack:t,pos:r,stackWeight:s}=i;if(!t||!iS.includes(r))continue;let n=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});n.count++,n.weight+=s}return e}(t),{vBoxMaxWidth:a,hBoxMaxHeight:o}=e;for(i=0,r=t.length;i<r;++i){let{fullSize:r}=(s=t[i]).box,l=n[s.stack],h=l&&s.stackWeight/l.weight;s.horizontal?(s.width=h?h*a:r&&e.availableWidth,s.height=o):(s.width=a,s.height=h?h*o:r&&e.availableHeight)}return n}(m.concat(b),y);iP(g.fullSize,w,y,v),iP(m,w,y,v),iP(b,w,y,v)&&iP(m,w,y,v);let x=w.maxPadding;function k(t){let e=Math.max(x[t]-w[t],0);return w[t]+=e,e}w.y+=k("top"),w.x+=k("left"),k("right"),k("bottom"),iM(g.leftAndTop,w,y,v),w.x+=w.w,w.y+=w.h,iM(g.rightAndBottom,w,y,v),t.chartArea={left:w.left,top:w.top,right:w.left+w.w,bottom:w.top+w.h,height:w.h,width:w.w},F(g.chartArea,e=>{let i=e.box;Object.assign(i,t.chartArea),i.update(w.w,w.h,{left:0,top:0,right:0,bottom:0})})}};class iI{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,r){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,r?Math.floor(e/r):i)}}isAttached(t){return!0}updateConfig(t){}}class ij extends iI{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}let iL="$chartjs",i$={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},iB=t=>null===t||""===t,iN=!!eL&&{passive:!0};function iU(t,e){for(let i of t)if(i===e||i.contains(e))return!0}function iF(t,e,i){let r=t.canvas,s=new MutationObserver(t=>{let e=!1;for(let i of t)e=(e=e||iU(i.addedNodes,r))&&!iU(i.removedNodes,r);e&&i()});return s.observe(document,{childList:!0,subtree:!0}),s}function iz(t,e,i){let r=t.canvas,s=new MutationObserver(t=>{let e=!1;for(let i of t)e=(e=e||iU(i.removedNodes,r))&&!iU(i.addedNodes,r);e&&i()});return s.observe(document,{childList:!0,subtree:!0}),s}let iV=new Map,iW=0;function iH(){let t=window.devicePixelRatio;t!==iW&&(iW=t,iV.forEach((e,i)=>{i.currentDevicePixelRatio!==t&&e()}))}function iq(t,e,i){let r=t.canvas,s=r&&eA(r);if(!s)return;let n=tC((t,e)=>{let r=s.clientWidth;i(t,e),r<s.clientWidth&&i()},window),a=new ResizeObserver(t=>{let e=t[0],i=e.contentRect.width,r=e.contentRect.height;(0!==i||0!==r)&&n(i,r)});return a.observe(s),iV.size||window.addEventListener("resize",iH),iV.set(t,n),a}function iK(t,e,i){i&&i.disconnect(),"resize"===e&&(iV.delete(t),iV.size||window.removeEventListener("resize",iH))}function iJ(t,e,i){let r=t.canvas,s=tC(e=>{null!==t.ctx&&i(function(t,e){let i=i$[t.type]||t.type,{x:r,y:s}=eD(t,e);return{type:i,chart:e,native:t,x:void 0!==r?r:null,y:void 0!==s?s:null}}(e,t))},t);return r.addEventListener(e,s,iN),s}class iG extends iI{acquireContext(t,e){let i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(!function(t,e){let i=t.style,r=t.getAttribute("height"),s=t.getAttribute("width");if(t[iL]={initial:{height:r,width:s,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",iB(s)){let e=e$(t,"width");void 0!==e&&(t.width=e)}if(iB(r))if(""===t.style.height)t.height=t.width/(e||2);else{let e=e$(t,"height");void 0!==e&&(t.height=e)}}(t,e),i):null}releaseContext(t){let e=t.canvas;if(!e[iL])return!1;let i=e[iL].initial;["height","width"].forEach(t=>{let r=i[t];D(r)?e.removeAttribute(t):e.setAttribute(t,r)});let r=i.style||{};return Object.keys(r).forEach(t=>{e.style[t]=r[t]}),e.width=e.width,delete e[iL],!0}addEventListener(t,e,i){this.removeEventListener(t,e);let r=t.$proxies||(t.$proxies={}),s={attach:iF,detach:iz,resize:iq}[e]||iJ;r[e]=s(t,e,i)}removeEventListener(t,e){let i=t.$proxies||(t.$proxies={}),r=i[e];r&&((({attach:iK,detach:iK,resize:iK})[e]||function(t,e,i){t.canvas.removeEventListener(e,i,iN)})(t,e,r),i[e]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,r){return function(t,e,i,r){let s=eP(t),n=eM(s,"margin"),a=eR(s.maxWidth,t,"clientWidth")||ts,o=eR(s.maxHeight,t,"clientHeight")||ts,l=function(t,e,i){let r,s;if(void 0===e||void 0===i){let n=eA(t);if(n){let t=n.getBoundingClientRect(),a=eP(n),o=eM(a,"border","width"),l=eM(a,"padding");e=t.width-l.width-o.width,i=t.height-l.height-o.height,r=eR(a.maxWidth,n,"clientWidth"),s=eR(a.maxHeight,n,"clientHeight")}else e=t.clientWidth,i=t.clientHeight}return{width:e,height:i,maxWidth:r||ts,maxHeight:s||ts}}(t,e,i),{width:h,height:u}=l;if("content-box"===s.boxSizing){let t=eM(s,"border","width"),e=eM(s,"padding");h-=e.width+t.width,u-=e.height+t.height}return h=Math.max(0,h-n.width),u=Math.max(0,r?h/r:u-n.height),h=eI(Math.min(h,a,l.maxWidth)),u=eI(Math.min(u,o,l.maxHeight)),h&&!u&&(u=eI(h/2)),(void 0!==e||void 0!==i)&&r&&l.height&&u>l.height&&(h=eI(Math.floor((u=l.height)*r))),{width:h,height:u}}(t,e,i,r)}isAttached(t){let e=eA(t);return!!(e&&e.isConnected)}}class iY{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){let{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return tf(this.x)&&tf(this.y)}getProps(t,e){let i=this.$animations;if(!e||!i)return this;let r={};return t.forEach(t=>{r[t]=i[t]&&i[t].active()?i[t]._to:this[t]}),r}}function iX(t,e,i,r,s){let n,a,o,l=B(r,0),h=Math.min(B(s,t.length),t.length),u=0;for(i=Math.ceil(i),s&&(i=(n=s-r)/Math.floor(n/i)),o=l;o<0;)o=Math.round(l+ ++u*i);for(a=Math.max(l,0);a<h;a++)a===o&&(e.push(t[a]),o=Math.round(l+ ++u*i))}let iZ=(t,e,i)=>"top"===e||"left"===e?t[e]+i:t[e]-i,iQ=(t,e)=>Math.min(e||t,t);function i0(t,e){let i=[],r=t.length/e,s=t.length,n=0;for(;n<s;n+=r)i.push(t[Math.floor(n)]);return i}function i1(t){return t.drawTicks?t.tickLength:0}function i2(t,e){if(!t.display)return 0;let i=el(t.font,e),r=eo(t.padding);return(I(t.text)?t.text.length:1)*i.lineHeight+r.height}class i5 extends iY{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:r}=this;return t=$(t,1/0),e=$(e,-1/0),i=$(i,1/0),r=$(r,-1/0),{min:$(t,i),max:$(e,r),minDefined:L(t),maxDefined:L(e)}}getMinMax(t){let e,{min:i,max:r,minDefined:s,maxDefined:n}=this.getUserBounds();if(s&&n)return{min:i,max:r};let a=this.getMatchingVisibleMetas();for(let o=0,l=a.length;o<l;++o)e=a[o].controller.getMinMax(this,t),s||(i=Math.min(i,e.min)),n||(r=Math.max(r,e.max));return i=n&&i>r?r:i,r=s&&i>r?i:r,{min:$(i,$(r,i)),max:$(r,$(i,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){let t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){U(this.options.beforeUpdate,[this])}update(t,e,i){let{beginAtZero:r,grace:s,ticks:n}=this.options,a=n.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(t,e,i){let{min:r,max:s}=t,n=N(e,(s-r)/2),a=(t,e)=>i&&0===t?0:t+e;return{min:a(r,-Math.abs(n)),max:a(s,n)}}(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();let o=a<this.ticks.length;this._convertTicksToLabels(o?i0(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),n.display&&(n.autoSkip||"auto"===n.source)&&(this.ticks=function(t,e){var i;let r,s,n=t.options.ticks,a=(r=(i=t).options.offset,s=i._tickSize(),Math.floor(Math.min(i._length/s+ +!r,i._maxLength/s))),o=Math.min(n.maxTicksLimit||a,a),l=n.major.enabled?function(t){let e,i,r=[];for(e=0,i=t.length;e<i;e++)t[e].major&&r.push(e);return r}(e):[],h=l.length,u=l[0],c=l[h-1],d=[];if(h>o)return function(t,e,i,r){let s,n=0,a=i[0];for(s=0,r=Math.ceil(r);s<t.length;s++)s===a&&(e.push(t[s]),a=i[++n*r])}(e,d,l,h/o),d;let f=function(t,e,i){let r=function(t){let e,i,r=t.length;if(r<2)return!1;for(i=t[0],e=1;e<r;++e)if(t[e]-t[e-1]!==i)return!1;return i}(t),s=e.length/i;if(!r)return Math.max(s,1);let n=function(t){let e,i=[],r=Math.sqrt(t);for(e=1;e<r;e++)t%e==0&&(i.push(e),i.push(t/e));return r===(0|r)&&i.push(r),i.sort((t,e)=>t-e).pop(),i}(r);for(let t=0,e=n.length-1;t<e;t++){let e=n[t];if(e>s)return e}return Math.max(s,1)}(l,e,o);if(h>0){let t,i,r=h>1?Math.round((c-u)/(h-1)):null;for(iX(e,d,f,D(r)?0:u-r,u),t=0,i=h-1;t<i;t++)iX(e,d,f,l[t],l[t+1]);return iX(e,d,f,c,D(r)?e.length:c+r),d}return iX(e,d,f),d}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,i=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,i=!i),this._startPixel=t,this._endPixel=e,this._reversePixels=i,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){U(this.options.afterUpdate,[this])}beforeSetDimensions(){U(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){U(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),U(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){U(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){let e,i,r,s=this.options.ticks;for(e=0,i=t.length;e<i;e++)(r=t[e]).label=U(s.callback,[r.value,e,t],this)}afterTickToLabelConversion(){U(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){U(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){let t,e,i,r=this.options,s=r.ticks,n=iQ(this.ticks.length,r.ticks.maxTicksLimit),a=s.minRotation||0,o=s.maxRotation,l=a;if(!this._isVisible()||!s.display||a>=o||n<=1||!this.isHorizontal()){this.labelRotation=a;return}let h=this._getLabelSizes(),u=h.widest.width,c=h.highest.height,d=tx(this.chart.width-u,0,this.maxWidth);u+6>(t=r.offset?this.maxWidth/n:d/(n-1))&&(t=d/(n-(r.offset?.5:1)),e=this.maxHeight-i1(r.grid)-s.padding-i2(r.title,this.chart.options.font),i=Math.sqrt(u*u+c*c),l=Math.max(a,Math.min(o,l=180/te*Math.min(Math.asin(tx((h.highest.height+6)/t,-1,1)),Math.asin(tx(e/i,-1,1))-Math.asin(tx(c/i,-1,1)))))),this.labelRotation=l}afterCalculateLabelRotation(){U(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){U(this.options.beforeFit,[this])}fit(){let t={width:0,height:0},{chart:e,options:{ticks:i,title:r,grid:s}}=this,n=this._isVisible(),a=this.isHorizontal();if(n){let n=i2(r,e.options.font);if(a?(t.width=this.maxWidth,t.height=i1(s)+n):(t.height=this.maxHeight,t.width=i1(s)+n),i.display&&this.ticks.length){let{first:e,last:r,widest:s,highest:n}=this._getLabelSizes(),o=2*i.padding,l=tg(this.labelRotation),h=Math.cos(l),u=Math.sin(l);if(a){let e=i.mirror?0:u*s.width+h*n.height;t.height=Math.min(this.maxHeight,t.height+e+o)}else{let e=i.mirror?0:h*s.width+u*n.height;t.width=Math.min(this.maxWidth,t.width+e+o)}this._calculatePadding(e,r,u,h)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,r){let{ticks:{align:s,padding:n},position:a}=this.options,o=0!==this.labelRotation,l="top"!==a&&"x"===this.axis;if(this.isHorizontal()){let a=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1),u=0,c=0;o?l?(u=r*t.width,c=i*e.height):(u=i*t.height,c=r*e.width):"start"===s?c=e.width:"end"===s?u=t.width:"inner"!==s&&(u=t.width/2,c=e.width/2),this.paddingLeft=Math.max((u-a+n)*this.width/(this.width-a),0),this.paddingRight=Math.max((c-h+n)*this.width/(this.width-h),0)}else{let i=e.height/2,r=t.height/2;"start"===s?(i=0,r=t.height):"end"===s&&(i=e.height,r=0),this.paddingTop=i+n,this.paddingBottom=r+n}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){U(this.options.afterFit,[this])}isHorizontal(){let{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,i;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,i=t.length;e<i;e++)D(t[e].label)&&(t.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){let e=this.options.ticks.sampleSize,i=this.ticks;e<i.length&&(i=i0(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,i){let r,s,n,a,o,l,h,u,c,d,f,{ctx:p,_longestTextCache:g}=this,m=[],b=[],y=Math.floor(e/iQ(e,i)),_=0,w=0;for(r=0;r<e;r+=y){if(a=t[r].label,p.font=l=(o=this._resolveTickFontOptions(r)).string,h=g[l]=g[l]||{data:{},gc:[]},u=o.lineHeight,c=d=0,D(a)||I(a)){if(I(a))for(s=0,n=a.length;s<n;++s)D(f=a[s])||I(f)||(c=tQ(p,h.data,h.gc,c,f),d+=u)}else c=tQ(p,h.data,h.gc,c,a),d=u;m.push(c),b.push(d),_=Math.max(c,_),w=Math.max(d,w)}F(g,t=>{let i,r=t.gc,s=r.length/2;if(s>e){for(i=0;i<s;++i)delete t.data[r[i]];r.splice(0,s)}});let v=m.indexOf(_),x=b.indexOf(w),k=t=>({width:m[t]||0,height:b[t]||0});return{first:k(0),last:k(e-1),widest:k(v),highest:k(x),widths:m,heights:b}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){let e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);let e=this._startPixel+t*this._length;return tx(this._alignToPixels?t0(this.chart,e,0):e,-32768,32767)}getDecimalForPixel(t){let e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){let{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){var e,i;let r=this.ticks||[];if(t>=0&&t<r.length){let i=r[t];return i.$context||(e=this.getContext(),i.$context=eu(e,{tick:i,index:t,type:"tick"}))}return this.$context||(this.$context=(i=this.chart.getContext(),eu(i,{scale:this,type:"scale"})))}_tickSize(){let t=this.options.ticks,e=tg(this.labelRotation),i=Math.abs(Math.cos(e)),r=Math.abs(Math.sin(e)),s=this._getLabelSizes(),n=t.autoSkipPadding||0,a=s?s.widest.width+n:0,o=s?s.highest.height+n:0;return this.isHorizontal()?o*i>a*r?a/i:o/r:o*r<a*i?o/i:a/r}_isVisible(){let t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){let e,i,r,s,n,a,o,l,h,u,c,d,f=this.axis,p=this.chart,g=this.options,{grid:m,position:b,border:y}=g,_=m.offset,w=this.isHorizontal(),v=this.ticks.length+ +!!_,x=i1(m),k=[],S=y.setContext(this.getContext()),E=S.display?S.width:0,T=E/2,O=function(t){return t0(p,t,E)};if("top"===b)e=O(this.bottom),a=this.bottom-x,l=e-T,u=O(t.top)+T,d=t.bottom;else if("bottom"===b)e=O(this.top),u=t.top,d=O(t.bottom)-T,a=e+T,l=this.top+x;else if("left"===b)e=O(this.right),n=this.right-x,o=e-T,h=O(t.left)+T,c=t.right;else if("right"===b)e=O(this.left),h=t.left,c=O(t.right)-T,n=e+T,o=this.left+x;else if("x"===f){if("center"===b)e=O((t.top+t.bottom)/2+.5);else if(j(b)){let t=Object.keys(b)[0],i=b[t];e=O(this.chart.scales[t].getPixelForValue(i))}u=t.top,d=t.bottom,l=(a=e+T)+x}else if("y"===f){if("center"===b)e=O((t.left+t.right)/2);else if(j(b)){let t=Object.keys(b)[0],i=b[t];e=O(this.chart.scales[t].getPixelForValue(i))}o=(n=e-T)-x,h=t.left,c=t.right}let A=B(g.ticks.maxTicksLimit,v),R=Math.max(1,Math.ceil(v/A));for(i=0;i<v;i+=R){let t=this.getContext(i),e=m.setContext(t),f=y.setContext(t),g=e.lineWidth,b=e.color,v=f.dash||[],x=f.dashOffset,S=e.tickWidth,E=e.tickColor,T=e.tickBorderDash||[],O=e.tickBorderDashOffset;void 0!==(r=function(t,e,i){let r,s=t.ticks.length,n=Math.min(e,s-1),a=t._startPixel,o=t._endPixel,l=t.getPixelForTick(n);if(!i||(r=1===s?Math.max(l-a,o-l):0===e?(t.getPixelForTick(1)-l)/2:(l-t.getPixelForTick(n-1))/2,!((l+=n<e?r:-r)<a-1e-6)&&!(l>o+1e-6)))return l}(this,i,_))&&(s=t0(p,r,g),w?n=o=h=c=s:a=l=u=d=s,k.push({tx1:n,ty1:a,tx2:o,ty2:l,x1:h,y1:u,x2:c,y2:d,width:g,color:b,borderDash:v,borderDashOffset:x,tickWidth:S,tickColor:E,tickBorderDash:T,tickBorderDashOffset:O}))}return this._ticksLength=v,this._borderValue=e,k}_computeLabelItems(t){let e,i,r,s,n,a,o,l,h,u,c,d=this.axis,f=this.options,{position:p,ticks:g}=f,m=this.isHorizontal(),b=this.ticks,{align:y,crossAlign:_,padding:w,mirror:v}=g,x=i1(f.grid),k=x+w,S=v?-w:k,E=-tg(this.labelRotation),T=[],O="middle";if("top"===p)n=this.bottom-S,a=this._getXAxisLabelAlignment();else if("bottom"===p)n=this.top+S,a=this._getXAxisLabelAlignment();else if("left"===p){let t=this._getYAxisLabelAlignment(x);a=t.textAlign,s=t.x}else if("right"===p){let t=this._getYAxisLabelAlignment(x);a=t.textAlign,s=t.x}else if("x"===d){if("center"===p)n=(t.top+t.bottom)/2+k;else if(j(p)){let t=Object.keys(p)[0],e=p[t];n=this.chart.scales[t].getPixelForValue(e)+k}a=this._getXAxisLabelAlignment()}else if("y"===d){if("center"===p)s=(t.left+t.right)/2-k;else if(j(p)){let t=Object.keys(p)[0],e=p[t];s=this.chart.scales[t].getPixelForValue(e)}a=this._getYAxisLabelAlignment(x).textAlign}"y"===d&&("start"===y?O="top":"end"===y&&(O="bottom"));let A=this._getLabelSizes();for(e=0,i=b.length;e<i;++e){let t;r=b[e].label;let d=g.setContext(this.getContext(e));o=this.getPixelForTick(e)+g.labelOffset,h=(l=this._resolveTickFontOptions(e)).lineHeight;let f=(u=I(r)?r.length:1)/2,y=d.color,w=d.textStrokeColor,x=d.textStrokeWidth,k=a;if(m?(s=o,"inner"===a&&(k=e===i-1?this.options.reverse?"left":"right":0===e?this.options.reverse?"right":"left":"center"),c="top"===p?"near"===_||0!==E?-u*h+h/2:"center"===_?-A.highest.height/2-f*h+h:-A.highest.height+h/2:"near"===_||0!==E?h/2:"center"===_?A.highest.height/2-f*h:A.highest.height-u*h,v&&(c*=-1),0===E||d.showLabelBackdrop||(s+=h/2*Math.sin(E))):(n=o,c=(1-u)*h/2),d.showLabelBackdrop){let i=eo(d.backdropPadding),r=A.heights[e],s=A.widths[e],n=c-i.top,o=0-i.left;switch(O){case"middle":n-=r/2;break;case"bottom":n-=r}switch(a){case"center":o-=s/2;break;case"right":o-=s}t={left:o,top:n,width:s+i.width,height:r+i.height,color:d.backdropColor}}T.push({label:r,font:l,textOffset:c,options:{rotation:E,color:y,strokeColor:w,strokeWidth:x,textAlign:k,textBaseline:O,translation:[s,n],backdrop:t}})}return T}_getXAxisLabelAlignment(){let{position:t,ticks:e}=this.options;if(-tg(this.labelRotation))return"top"===t?"left":"right";let i="center";return"start"===e.align?i="left":"end"===e.align?i="right":"inner"===e.align&&(i="inner"),i}_getYAxisLabelAlignment(t){let e,i,{position:r,ticks:{crossAlign:s,mirror:n,padding:a}}=this.options,o=this._getLabelSizes(),l=t+a,h=o.widest.width;return"left"===r?n?(i=this.right+a,"near"===s?e="left":"center"===s?(e="center",i+=h/2):(e="right",i+=h)):(i=this.right-l,"near"===s?e="right":"center"===s?(e="center",i-=h/2):(e="left",i=this.left)):"right"===r?n?(i=this.left+a,"near"===s?e="right":"center"===s?(e="center",i-=h/2):(e="left",i-=h)):(i=this.left+l,"near"===s?e="left":"center"===s?(e="center",i+=h/2):(e="right",i=this.right)):e="right",{textAlign:e,x:i}}_computeLabelArea(){if(this.options.ticks.mirror)return;let t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){let{ctx:t,options:{backgroundColor:e},left:i,top:r,width:s,height:n}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,r,s,n),t.restore())}getLineWidthForValue(t){let e=this.options.grid;if(!this._isVisible()||!e.display)return 0;let i=this.ticks.findIndex(e=>e.value===t);return i>=0?e.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){let e,i,r=this.options.grid,s=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t)),a=(t,e,i)=>{i.width&&i.color&&(s.save(),s.lineWidth=i.width,s.strokeStyle=i.color,s.setLineDash(i.borderDash||[]),s.lineDashOffset=i.borderDashOffset,s.beginPath(),s.moveTo(t.x,t.y),s.lineTo(e.x,e.y),s.stroke(),s.restore())};if(r.display)for(e=0,i=n.length;e<i;++e){let t=n[e];r.drawOnChartArea&&a({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),r.drawTicks&&a({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){let t,e,i,r,{chart:s,ctx:n,options:{border:a,grid:o}}=this,l=a.setContext(this.getContext()),h=a.display?l.width:0;if(!h)return;let u=o.setContext(this.getContext(0)).lineWidth,c=this._borderValue;this.isHorizontal()?(t=t0(s,this.left,h)-h/2,e=t0(s,this.right,u)+u/2,i=r=c):(i=t0(s,this.top,h)-h/2,r=t0(s,this.bottom,u)+u/2,t=e=c),n.save(),n.lineWidth=l.width,n.strokeStyle=l.color,n.beginPath(),n.moveTo(t,i),n.lineTo(e,r),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;let e=this.ctx,i=this._computeLabelArea();for(let r of(i&&t3(e,i),this.getLabelItems(t))){let t=r.options,i=r.font;t7(e,r.label,0,r.textOffset,i,t)}i&&t6(e)}drawTitle(){let t,e,{ctx:i,options:{position:r,title:s,reverse:n}}=this;if(!s.display)return;let a=el(s.font),o=eo(s.padding),l=s.align,h=a.lineHeight/2;"bottom"===r||"center"===r||j(r)?(h+=o.bottom,I(s.text)&&(h+=a.lineHeight*(s.text.length-1))):h+=o.top;let{titleX:u,titleY:c,maxWidth:d,rotation:f}=function(t,e,i,r){let s,n,a,{top:o,left:l,bottom:h,right:u,chart:c}=t,{chartArea:d,scales:f}=c,p=0,g=h-o,m=u-l;if(t.isHorizontal()){if(n=tD(r,l,u),j(i)){let t=Object.keys(i)[0],r=i[t];a=f[t].getPixelForValue(r)+g-e}else a="center"===i?(d.bottom+d.top)/2+g-e:iZ(t,i,e);s=u-l}else{if(j(i)){let t=Object.keys(i)[0],r=i[t];n=f[t].getPixelForValue(r)-m+e}else n="center"===i?(d.left+d.right)/2-m+e:iZ(t,i,e);a=tD(r,h,o),p="left"===i?-ta:ta}return{titleX:n,titleY:a,maxWidth:s,rotation:p}}(this,h,r,l);t7(i,s.text,0,0,a,{color:s.color,maxWidth:d,rotation:f,textAlign:(t=tM(l),(n&&"right"!==r||!n&&"right"===r)&&(t="left"===(e=t)?"right":"right"===e?"left":e),t),textBaseline:"middle",translation:[u,c]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){let t=this.options,e=t.ticks&&t.ticks.z||0,i=B(t.grid&&t.grid.z,-1),r=B(t.border&&t.border.z,0);return this._isVisible()&&this.draw===i5.prototype.draw?[{z:i,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){let e,i,r=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",n=[];for(e=0,i=r.length;e<i;++e){let i=r[e];i[s]!==this.id||t&&i.type!==t||n.push(i)}return n}_resolveTickFontOptions(t){return el(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){let t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class i8{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){var e,i,r,s,n,a;let o,l,h=Object.getPrototypeOf(t);"id"in(e=h)&&"defaults"in e&&(l=this.register(h));let u=this.items,c=t.id,d=this.scope+"."+c;if(!c)throw Error("class does not have id: "+t);return c in u||(u[c]=t,i=t,r=d,s=l,o=q(Object.create(null),[s?tZ.get(s):{},tZ.get(r),i.defaults]),tZ.set(r,o),i.defaultRoutes&&(n=r,Object.keys(a=i.defaultRoutes).forEach(t=>{let e=t.split("."),i=e.pop(),r=[n].concat(e).join("."),s=a[t].split("."),o=s.pop(),l=s.join(".");tZ.route(r,i,l,o)})),i.descriptors&&tZ.describe(r,i.descriptors),this.override&&tZ.override(t.id,t.overrides)),d}get(t){return this.items[t]}unregister(t){let e=this.items,i=t.id,r=this.scope;i in e&&delete e[i],r&&i in tZ[r]&&(delete tZ[r][i],this.override&&delete tJ[i])}}var i3=new class{constructor(){this.controllers=new i8(ie,"datasets",!0),this.elements=new i8(iY,"elements"),this.plugins=new i8(Object,"plugins"),this.scales=new i8(i5,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,i){[...e].forEach(e=>{let r=i||this._getRegistryForType(e);i||r.isForType(e)||r===this.plugins&&e.id?this._exec(t,r,e):F(e,e=>{let r=i||this._getRegistryForType(e);this._exec(t,r,e)})})}_exec(t,e,i){let r=X(t);U(i["before"+r],[],i),e[t](i),U(i["after"+r],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){let i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){let r=e.get(t);if(void 0===r)throw Error('"'+t+'" is not a registered '+i+".");return r}};class i6{constructor(){this._init=[]}notify(t,e,i,r){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));let s=r?this._descriptors(t).filter(r):this._descriptors(t),n=this._notify(s,t,e,i);return"afterDestroy"===e&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall")),n}_notify(t,e,i,r){for(let s of(r=r||{},t)){let t=s.plugin;if(!1===U(t[i],[e,r,s.options],t)&&r.cancelable)return!1}return!0}invalidate(){D(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;let e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){let i=t&&t.config,r=B(i.options&&i.options.plugins,{}),s=function(t){let e={},i=[],r=Object.keys(i3.plugins.items);for(let t=0;t<r.length;t++)i.push(i3.getPlugin(r[t]));let s=t.plugins||[];for(let t=0;t<s.length;t++){let r=s[t];-1===i.indexOf(r)&&(i.push(r),e[r.id]=!0)}return{plugins:i,localIds:e}}(i);return!1!==r||e?function(t,{plugins:e,localIds:i},r,s){let n=[],a=t.getContext();for(let l of e){var o;let e=l.id,h=(o=r[e],s||!1!==o?!0===o?{}:o:null);null!==h&&n.push({plugin:l,options:function(t,{plugin:e,local:i},r,s){let n=t.pluginScopeKeys(e),a=t.getOptionScopes(r,n);return i&&e.defaults&&a.push(e.defaults),t.createResolver(a,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}(t.config,{plugin:l,local:i[e]},h,a)})}return n}(t,s,r,e):[]}_notifyStateChanges(t){let e=this._oldCache||[],i=this._cache,r=(t,e)=>t.filter(t=>!e.some(e=>t.plugin.id===e.plugin.id));this._notify(r(e,i),t,"stop"),this._notify(r(i,e),t,"start")}}function i4(t,e){let i=tZ.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||i.indexAxis||"x"}function i9(t){if("x"===t||"y"===t||"r"===t)return t}function i7(t,...e){if(i9(t))return t;for(let r of e){var i;let e=r.axis||("top"===(i=r.position)||"bottom"===i?"x":"left"===i||"right"===i?"y":void 0)||t.length>1&&i9(t[0].toLowerCase());if(e)return e}throw Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function rt(t,e,i){if(i[e+"AxisID"]===t)return{axis:e}}function re(t){let e,i,r,s,n=t.options||(t.options={});n.plugins=B(n.plugins,{}),e=tJ[t.type]||{scales:{}},i=n.scales||{},r=i4(t.type,n),s=Object.create(null),Object.keys(i).forEach(n=>{let a=i[n];if(!j(a))return console.error(`Invalid scale configuration for scale: ${n}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${n}`);let o=i7(n,a,function(t,e){if(e.data&&e.data.datasets){let i=e.data.datasets.filter(e=>e.xAxisID===t||e.yAxisID===t);if(i.length)return rt(t,"x",i[0])||rt(t,"y",i[0])}return{}}(n,t),tZ.scales[a.type]),l=o===r?"_index_":"_value_",h=e.scales||{};s[n]=K(Object.create(null),[{axis:o},a,h[o],h[l]])}),t.data.datasets.forEach(e=>{let r=e.type||t.type,a=e.indexAxis||i4(r,n),o=(tJ[r]||{}).scales||{};Object.keys(o).forEach(t=>{let r,n=(r=t,"_index_"===t?r=a:"_value_"===t&&(r="x"===a?"y":"x"),r),l=e[n+"AxisID"]||n;s[l]=s[l]||Object.create(null),K(s[l],[{axis:n},i[l],o[t]])})}),Object.keys(s).forEach(t=>{let e=s[t];K(e,[tZ.scales[e.type],tZ.scale])}),n.scales=s}function ri(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}let rr=new Map,rs=new Set;function rn(t,e){let i=rr.get(t);return i||(i=e(),rr.set(t,i),rs.add(i)),i}let ra=(t,e,i)=>{let r=Y(e,i);void 0!==r&&t.add(r)};class ro{constructor(t){this._config=function(t){return(t=t||{}).data=ri(t.data),re(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=ri(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){let t=this._config;this.clearCache(),re(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return rn(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return rn(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return rn(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){let e=t.id,i=this.type;return rn(`${i}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){let i=this._scopeCache,r=i.get(t);return(!r||e)&&(r=new Map,i.set(t,r)),r}getOptionScopes(t,e,i){let{options:r,type:s}=this,n=this._cachedScopes(t,i),a=n.get(e);if(a)return a;let o=new Set;e.forEach(e=>{t&&(o.add(t),e.forEach(e=>ra(o,t,e))),e.forEach(t=>ra(o,r,t)),e.forEach(t=>ra(o,tJ[s]||{},t)),e.forEach(t=>ra(o,tZ,t)),e.forEach(t=>ra(o,tG,t))});let l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),rs.has(e)&&n.set(e,l),l}chartOptionScopes(){let{options:t,type:e}=this;return[t,tJ[e]||{},tZ.datasets[e]||{},{type:e},tZ,tG]}resolveNamedOptions(t,e,i,r=[""]){let s={$shared:!0},{resolver:n,subPrefixes:a}=rl(this._resolverCache,t,r),o=n;if(function(t,e){let{isScriptable:i,isIndexable:r}=ef(t);for(let s of e){let e=i(s),n=r(s),a=(n||e)&&t[s];if(e&&(Q(a)||rh(a))||n&&I(a))return!0}return!1}(n,e)){s.$shared=!1,i=Q(i)?i():i;let e=this.createResolver(t,i,a);o=ed(n,i,e)}for(let t of e)s[t]=o[t];return s}createResolver(t,e,i=[""],r){let{resolver:s}=rl(this._resolverCache,t,i);return j(e)?ed(s,e,void 0,r):s}}function rl(t,e,i){let r=t.get(e);r||(r=new Map,t.set(e,r));let s=i.join(),n=r.get(s);return n||(n={resolver:ec(e,i),subPrefixes:i.filter(t=>!t.toLowerCase().includes("hover"))},r.set(s,n)),n}let rh=t=>j(t)&&Object.getOwnPropertyNames(t).reduce((e,i)=>e||Q(t[i]),!1),ru=["top","bottom","left","right","chartArea"];function rc(t,e){return"top"===t||"bottom"===t||-1===ru.indexOf(t)&&"x"===e}function rd(t,e){return function(i,r){return i[t]===r[t]?i[e]-r[e]:i[t]-r[t]}}function rf(t){let e=t.chart,i=e.options.animation;e.notifyPlugins("afterRender"),U(i&&i.onComplete,[t],e)}function rp(t){let e=t.chart,i=e.options.animation;U(i&&i.onProgress,[t],e)}function rg(t){return eO()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}let rm={},rb=t=>{let e=rg(t);return Object.values(rm).filter(t=>t.canvas===e).pop()};function ry(t,e,i){return t.options.clip?t[i]:e[i]}class r_{static defaults=tZ;static instances=rm;static overrides=tJ;static registry=i3;static version="4.4.0";static getChart=rb;static register(...t){i3.add(...t),rw()}static unregister(...t){i3.remove(...t),rw()}constructor(t,e){const i=this.config=new ro(e),r=rg(t),s=rb(r);if(s)throw Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const n=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||(!eO()||"u">typeof OffscreenCanvas&&r instanceof OffscreenCanvas?ij:iG)),this.platform.updateConfig(i);const a=this.platform.acquireContext(r,n.aspectRatio),o=a&&a.canvas,l=o&&o.height,h=o&&o.width;if(this.id=M(),this.ctx=a,this.canvas=o,this.width=h,this.height=l,this._options=n,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new i6,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(t,e){let i;return function(...r){return e?(clearTimeout(i),i=setTimeout(t,e,r)):t.apply(this,r),e}}(t=>this.update(t),n.resizeDelay||0),this._dataChanges=[],rm[this.id]=this,!a||!o)return void console.error("Failed to create chart: can't acquire context from the given item");eY.listen(this,"complete",rf),eY.listen(this,"progress",rp),this._initialize(),this.attached&&this.update()}get aspectRatio(){let{options:{aspectRatio:t,maintainAspectRatio:e},width:i,height:r,_aspectRatio:s}=this;return D(t)?e&&s?s:r?i/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return i3}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():ej(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return t1(this.canvas,this.ctx),this}stop(){return eY.stop(this),this}resize(t,e){eY.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){let i=this.options,r=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio,n=this.platform.getMaximumSize(r,t,e,s),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=n.width,this.height=n.height,this._aspectRatio=this.aspectRatio,ej(this,a,!0)&&(this.notifyPlugins("resize",{size:n}),U(i.onResize,[this,n],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){F(this.options.scales||{},(t,e)=>{t.id=e})}buildOrUpdateScales(){let t=this.options,e=t.scales,i=this.scales,r=Object.keys(i).reduce((t,e)=>(t[e]=!1,t),{}),s=[];e&&(s=s.concat(Object.keys(e).map(t=>{let i=e[t],r=i7(t,i),s="r"===r,n="x"===r;return{options:i,dposition:s?"chartArea":n?"bottom":"left",dtype:s?"radialLinear":n?"category":"linear"}}))),F(s,e=>{let s=e.options,n=s.id,a=i7(n,s),o=B(s.type,e.dtype);(void 0===s.position||rc(s.position,a)!==rc(e.dposition))&&(s.position=e.dposition),r[n]=!0;let l=null;n in i&&i[n].type===o?l=i[n]:i[(l=new(i3.getScale(o))({id:n,type:o,ctx:this.ctx,chart:this})).id]=l,l.init(s,t)}),F(r,(t,e)=>{t||delete i[e]}),F(i,t=>{iD.configure(this,t,t.options),iD.addBox(this,t)})}_updateMetasets(){let t=this._metasets,e=this.data.datasets.length,i=t.length;if(t.sort((t,e)=>t.index-e.index),i>e){for(let t=e;t<i;++t)this._destroyDatasetMeta(t);t.splice(e,i-e)}this._sortedMetasets=t.slice(0).sort(rd("order","index"))}_removeUnreferencedMetasets(){let{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((t,i)=>{0===e.filter(e=>e===t._dataset).length&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){let t,e,i=[],r=this.data.datasets;for(this._removeUnreferencedMetasets(),t=0,e=r.length;t<e;t++){let e=r[t],s=this.getDatasetMeta(t),n=e.type||this.config.type;if(s.type&&s.type!==n&&(this._destroyDatasetMeta(t),s=this.getDatasetMeta(t)),s.type=n,s.indexAxis=e.indexAxis||i4(n,this.options),s.order=e.order||0,s.index=t,s.label=""+e.label,s.visible=this.isDatasetVisible(t),s.controller)s.controller.updateIndex(t),s.controller.linkScales();else{let e=i3.getController(n),{datasetElementType:r,dataElementType:a}=tZ.datasets[n];Object.assign(e,{dataElementType:i3.getElement(a),datasetElementType:r&&i3.getElement(r)}),s.controller=new e(this,t),i.push(s.controller)}}return this._updateMetasets(),i}_resetElements(){F(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){let e=this.config;e.update();let i=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;let s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let n=0;for(let t=0,e=this.data.datasets.length;t<e;t++){let{controller:e}=this.getDatasetMeta(t),i=!r&&-1===s.indexOf(e);e.buildOrUpdateElements(i),n=Math.max(+e.getMaxOverflow(),n)}n=this._minPadding=i.layout.autoPadding?n:0,this._updateLayout(n),r||F(s,t=>{t.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(rd("z","_idx"));let{_active:a,_lastEvent:o}=this;o?this._eventHandler(o,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){F(this.scales,t=>{iD.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){let t=this.options;tt(new Set(Object.keys(this._listeners)),new Set(t.events))&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){let{_hiddenIndices:t}=this;for(let{method:i,start:r,count:s}of this._getUniformDataChanges()||[]){var e="_removeElements"===i?-s:s;for(let i of Object.keys(t)){let s=+i;if(s>=r){let n=t[i];delete t[i],(e>0||s>r)&&(t[s+e]=n)}}}}_getUniformDataChanges(){let t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];let e=this.data.datasets.length,i=e=>new Set(t.filter(t=>t[0]===e).map((t,e)=>e+","+t.splice(1).join(","))),r=i(0);for(let t=1;t<e;t++)if(!tt(r,i(t)))return;return Array.from(r).map(t=>t.split(",")).map(t=>({method:t[1],start:+t[2],count:+t[3]}))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;iD.update(this,this.width,this.height,t);let e=this.chartArea,i=e.width<=0||e.height<=0;this._layers=[],F(this.boxes,t=>{i&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))},this),this._layers.forEach((t,e)=>{t._idx=e}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,i=this.data.datasets.length;e<i;++e)this._updateDataset(e,Q(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){let i=this.getDatasetMeta(t),r={meta:i,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",r)&&(i.controller._update(e),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(eY.has(this)?this.attached&&!eY.running(this)&&eY.start(this):(this.draw(),rf({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){let{width:t,height:e}=this._resizeBeforeDraw;this._resize(t,e),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;let e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){let e,i,r=this._sortedMetasets,s=[];for(e=0,i=r.length;e<i;++e){let i=r[e];(!t||i.visible)&&s.push(i)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;let t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){let e=this.ctx,i=t._clip,r=!i.disabled,s=function(t,e){let{xScale:i,yScale:r}=t;return i&&r?{left:ry(i,e,"left"),right:ry(i,e,"right"),top:ry(r,e,"top"),bottom:ry(r,e,"bottom")}:e}(t,this.chartArea),n={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",n)&&(r&&t3(e,{left:!1===i.left?0:s.left-i.left,right:!1===i.right?this.width:s.right+i.right,top:!1===i.top?0:s.top-i.top,bottom:!1===i.bottom?this.height:s.bottom+i.bottom}),t.controller.draw(),r&&t6(e),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(t){return t8(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,i,r){let s=ik.modes[e];return"function"==typeof s?s(this,t,i,r):[]}getDatasetMeta(t){let e=this.data.datasets[t],i=this._metasets,r=i.filter(t=>t&&t._dataset===e).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=eu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){let e=this.data.datasets[t];if(!e)return!1;let i=this.getDatasetMeta(t);return"boolean"==typeof i.hidden?!i.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,i){let r=i?"show":"hide",s=this.getDatasetMeta(t),n=s.controller._resolveAnimations(void 0,r);Z(e)?(s.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),n.update(s,{visible:i}),this.update(e=>e.datasetIndex===t?r:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){let e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),eY.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");let{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),t1(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete rm[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){let t=this._listeners,e=this.platform,i=(i,r)=>{e.addEventListener(this,i,r),t[i]=r},r=(t,e,i)=>{t.offsetX=e,t.offsetY=i,this._eventHandler(t)};F(this.options.events,t=>i(t,r))}bindResponsiveEvents(){let t;this._responsiveListeners||(this._responsiveListeners={});let e=this._responsiveListeners,i=this.platform,r=(t,r)=>{i.addEventListener(this,t,r),e[t]=r},s=(t,r)=>{e[t]&&(i.removeEventListener(this,t,r),delete e[t])},n=(t,e)=>{this.canvas&&this.resize(t,e)},a=()=>{s("attach",a),this.attached=!0,this.resize(),r("resize",n),r("detach",t)};t=()=>{this.attached=!1,s("resize",n),this._stop(),this._resize(0,0),r("attach",a)},i.isAttached(this.canvas)?a():t()}unbindEvents(){F(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},F(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,i){let r,s,n,a=i?"set":"remove";for("dataset"===e&&this.getDatasetMeta(t[0].datasetIndex).controller["_"+a+"DatasetHoverStyle"](),s=0,n=t.length;s<n;++s){let e=(r=t[s])&&this.getDatasetMeta(r.datasetIndex).controller;e&&e[a+"HoverStyle"](r.element,r.datasetIndex,r.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){let e=this._active||[],i=t.map(({datasetIndex:t,index:e})=>{let i=this.getDatasetMeta(t);if(!i)throw Error("No dataset found at index "+t);return{datasetIndex:t,element:i.data[e],index:e}});z(i,e)||(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,e))}notifyPlugins(t,e,i){return this._plugins.notify(this,t,e,i)}isPluginEnabled(t){return 1===this._plugins._cache.filter(e=>e.plugin.id===t).length}_updateHoverStyles(t,e,i){let r=this.options.hover,s=(t,e)=>t.filter(t=>!e.some(e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)),n=s(e,t),a=i?t:s(t,e);n.length&&this.updateHoverStyle(n,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(t,e){let i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},r=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",i,r))return;let s=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(s||i.changed)&&this.render(),this}_handleEvent(t,e,i){var r;let{_active:s=[],options:n}=this,a=this._getActiveElements(t,s,i,e),o="mouseup"===t.type||"click"===t.type||"contextmenu"===t.type,l=(r=this._lastEvent,i&&"mouseout"!==t.type?o?r:t:null);i&&(this._lastEvent=null,U(n.onHover,[t,a,this],this),o&&U(n.onClick,[t,a,this],this));let h=!z(a,s);return(h||e)&&(this._active=a,this._updateHoverStyles(a,s,e)),this._lastEvent=l,h}_getActiveElements(t,e,i,r){if("mouseout"===t.type)return[];if(!i)return e;let s=this.options.hover;return this.getElementsAtEventForMode(t,s.mode,s,r)}}function rw(){return F(r_.instances,t=>t._plugins.invalidate())}function rv(t,e,i,r){return{x:i+t*Math.cos(e),y:r+t*Math.sin(e)}}function rx(t,e,i,r,s,n){var a,o,l,h;let u,c,d,f,{x:p,y:g,startAngle:m,pixelMargin:b,innerRadius:y}=e,_=Math.max(e.outerRadius+r+i-b,0),w=y>0?y+r+i+b:0,v=0,x=s-m;if(r){let t=_>0?_-r:0,e=((y>0?y-r:0)+t)/2;v=(x-(0!==e?x*e/(e+r):x))/2}let k=Math.max(.001,x*_-i/te)/_,S=(x-k)/2,E=m+S+v,T=s-S-v,{outerStart:O,outerEnd:A,innerStart:R,innerEnd:P}=(a=e,o=w,l=_,h=T-E,u=es(a.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]),d=Math.min(c=(l-o)/2,h*o/2),{outerStart:(f=t=>{let e=(l-Math.min(c,t))*h/2;return tx(t,0,Math.min(c,e))})(u.outerStart),outerEnd:f(u.outerEnd),innerStart:tx(u.innerStart,0,d),innerEnd:tx(u.innerEnd,0,d)}),C=_-O,M=_-A,D=E+O/C,I=T-A/M,j=w+R,L=w+P,$=E+R/j,B=T-P/L;if(t.beginPath(),n){let e=(D+I)/2;if(t.arc(p,g,_,D,e),t.arc(p,g,_,e,I),A>0){let e=rv(M,I,p,g);t.arc(e.x,e.y,A,I,T+ta)}let i=rv(L,T,p,g);if(t.lineTo(i.x,i.y),P>0){let e=rv(L,B,p,g);t.arc(e.x,e.y,P,T+ta,B+Math.PI)}let r=(T-P/w+(E+R/w))/2;if(t.arc(p,g,w,T-P/w,r,!0),t.arc(p,g,w,r,E+R/w,!0),R>0){let e=rv(j,$,p,g);t.arc(e.x,e.y,R,$+Math.PI,E-ta)}let s=rv(C,E,p,g);if(t.lineTo(s.x,s.y),O>0){let e=rv(C,D,p,g);t.arc(e.x,e.y,O,E-ta,D)}}else{t.moveTo(p,g);let e=Math.cos(D)*_+p,i=Math.sin(D)*_+g;t.lineTo(e,i);let r=Math.cos(I)*_+p,s=Math.sin(I)*_+g;t.lineTo(r,s)}t.closePath()}class rk extends iY{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,i){let{angle:r,distance:s}=tb(this.getProps(["x","y"],i),{x:t,y:e}),{startAngle:n,endAngle:a,innerRadius:o,outerRadius:l,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),u=(this.options.spacing+this.options.borderWidth)/2,c=B(h,a-n)>=ti||tv(r,n,a),d=tk(s,o+u,l+u);return c&&d}getCenterPoint(t){let{x:e,y:i,startAngle:r,endAngle:s,innerRadius:n,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:o,spacing:l}=this.options,h=(r+s)/2,u=(n+a+l+o)/2;return{x:e+Math.cos(h)*u,y:i+Math.sin(h)*u}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){let{options:e,circumference:i}=this,r=(e.offset||0)/4,s=(e.spacing||0)/2,n=e.circular;if(this.pixelMargin=.33*("inner"===e.borderAlign),this.fullCircles=i>ti?Math.floor(i/ti):0,0===i||this.innerRadius<0||this.outerRadius<0)return;t.save();let a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*r,Math.sin(a)*r);let o=r*(1-Math.sin(Math.min(te,i||0)));t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,function(t,e,i,r,s){let{fullCircles:n,startAngle:a,circumference:o}=e,l=e.endAngle;if(n){rx(t,e,i,r,l,s);for(let e=0;e<n;++e)t.fill();isNaN(o)||(l=a+(o%ti||ti))}rx(t,e,i,r,l,s),t.fill()}(t,this,o,s,n),function(t,e,i,r,s){let{fullCircles:n,startAngle:a,circumference:o,options:l}=e,{borderWidth:h,borderJoinStyle:u,borderDash:c,borderDashOffset:d}=l,f="inner"===l.borderAlign;if(!h)return;t.setLineDash(c||[]),t.lineDashOffset=d,f?(t.lineWidth=2*h,t.lineJoin=u||"round"):(t.lineWidth=h,t.lineJoin=u||"bevel");let p=e.endAngle;if(n){rx(t,e,i,r,p,s);for(let e=0;e<n;++e)t.stroke();isNaN(o)||(p=a+(o%ti||ti))}f&&function(t,e,i){let{startAngle:r,pixelMargin:s,x:n,y:a,outerRadius:o,innerRadius:l}=e,h=s/o;t.beginPath(),t.arc(n,a,o,r-h,i+h),l>s?(h=s/l,t.arc(n,a,l,i+h,r-h,!0)):t.arc(n,a,s,i+ta,r-ta),t.closePath(),t.clip()}(t,e,p),n||(rx(t,e,i,r,p,s),t.stroke())}(t,this,o,s,n),t.restore()}}function rS(t,e,i=e){t.lineCap=B(i.borderCapStyle,e.borderCapStyle),t.setLineDash(B(i.borderDash,e.borderDash)),t.lineDashOffset=B(i.borderDashOffset,e.borderDashOffset),t.lineJoin=B(i.borderJoinStyle,e.borderJoinStyle),t.lineWidth=B(i.borderWidth,e.borderWidth),t.strokeStyle=B(i.borderColor,e.borderColor)}function rE(t,e,i){t.lineTo(i.x,i.y)}function rT(t,e,i={}){let r=t.length,{start:s=0,end:n=r-1}=i,{start:a,end:o}=e,l=Math.max(s,a),h=Math.min(n,o);return{count:r,start:l,loop:e.loop,ilen:h<l&&!(s<a&&n<a||s>o&&n>o)?r+h-l:h-l}}function rO(t,e,i,r){let s,n,a,{points:o,options:l}=e,{count:h,start:u,loop:c,ilen:d}=rT(o,i,r),f=l.stepped?t4:l.tension||"monotone"===l.cubicInterpolationMode?t9:rE,{move:p=!0,reverse:g}=r||{};for(s=0;s<=d;++s)(n=o[(u+(g?d-s:s))%h]).skip||(p?(t.moveTo(n.x,n.y),p=!1):f(t,a,n,g,l.stepped),a=n);return c&&f(t,a,n=o[(u+(g?d:0))%h],g,l.stepped),!!c}function rA(t,e,i,r){let s,n,a,o,l,h,u=e.points,{count:c,start:d,ilen:f}=rT(u,i,r),{move:p=!0,reverse:g}=r||{},m=0,b=0,y=t=>(d+(g?f-t:t))%c,_=()=>{o!==l&&(t.lineTo(m,l),t.lineTo(m,o),t.lineTo(m,h))};for(p&&(n=u[y(0)],t.moveTo(n.x,n.y)),s=0;s<=f;++s){if((n=u[y(s)]).skip)continue;let e=n.x,i=n.y,r=0|e;r===a?(i<o?o=i:i>l&&(l=i),m=(b*m+e)/++b):(_(),t.lineTo(e,i),a=r,b=0,o=l=i),h=i}_()}function rR(t){let e=t.options,i=e.borderDash&&e.borderDash.length;return t._decimated||t._loop||e.tension||"monotone"===e.cubicInterpolationMode||e.stepped||i?rO:rA}let rP="function"==typeof Path2D;class rC extends iY{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){let i=this.options;if((i.tension||"monotone"===i.cubicInterpolationMode)&&!i.stepped&&!this._pointsUpdated){let r=i.spanGaps?this._loop:this._fullLoop;!function(t,e,i,r,s){let n,a,o,l;if(e.spanGaps&&(t=t.filter(t=>!t.skip)),"monotone"===e.cubicInterpolationMode)!function(t,e="x"){let i,r,s,n=eE(e),a=t.length,o=Array(a).fill(0),l=Array(a),h=eS(t,0);for(i=0;i<a;++i)if(r=s,s=h,h=eS(t,i+1),s){if(h){let t=h[e]-s[e];o[i]=0!==t?(h[n]-s[n])/t:0}l[i]=r?h?tu(o[i-1])!==tu(o[i])?0:(o[i-1]+o[i])/2:o[i-1]:o[i]}!function(t,e,i){let r,s,n,a,o,l=t.length,h=eS(t,0);for(let u=0;u<l-1;++u)if(o=h,h=eS(t,u+1),o&&h){if(tc(e[u],0,ek)){i[u]=i[u+1]=0;continue}(a=Math.pow(r=i[u]/e[u],2)+Math.pow(s=i[u+1]/e[u],2))<=9||(n=3/Math.sqrt(a),i[u]=r*n*e[u],i[u+1]=s*n*e[u])}}(t,o,l),function(t,e,i="x"){let r,s,n,a=eE(i),o=t.length,l=eS(t,0);for(let h=0;h<o;++h){if(s=n,n=l,l=eS(t,h+1),!n)continue;let o=n[i],u=n[a];s&&(r=(o-s[i])/3,n[`cp1${i}`]=o-r,n[`cp1${a}`]=u-r*e[h]),l&&(r=(l[i]-o)/3,n[`cp2${i}`]=o+r,n[`cp2${a}`]=u+r*e[h])}}(t,l,e)}(t,s);else{let i=r?t[t.length-1]:t[0];for(n=0,a=t.length;n<a;++n)l=function(t,e,i,r){let s=t.skip?e:t,n=i.skip?e:i,a=ty(e,s),o=ty(n,e),l=a/(a+o),h=o/(a+o);l=isNaN(l)?0:l,h=isNaN(h)?0:h;let u=r*l,c=r*h;return{previous:{x:e.x-u*(n.x-s.x),y:e.y-u*(n.y-s.y)},next:{x:e.x+c*(n.x-s.x),y:e.y+c*(n.y-s.y)}}}(i,o=t[n],t[Math.min(n+1,a-!r)%a],e.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,i=o}e.capBezierPoints&&function(t,e){let i,r,s,n,a,o=t8(t[0],e);for(i=0,r=t.length;i<r;++i)a=n,n=o,o=i<r-1&&t8(t[i+1],e),n&&(s=t[i],a&&(s.cp1x=eT(s.cp1x,e.left,e.right),s.cp1y=eT(s.cp1y,e.top,e.bottom)),o&&(s.cp2x=eT(s.cp2x,e.left,e.right),s.cp2y=eT(s.cp2y,e.top,e.bottom)))}(t,i)}(this._points,i,t,r,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(t,e){let i=t.points,r=t.options.spanGaps,s=i.length;if(!s)return[];let n=!!t._loop,{start:a,end:o}=function(t,e,i,r){let s=0,n=e-1;if(i&&!r)for(;s<e&&!t[s].skip;)s++;for(;s<e&&t[s].skip;)s++;for(s%=e,i&&(n+=s);n>s&&t[n%e].skip;)n--;return{start:s,end:n%=e}}(i,s,n,r);if(!0===r)return eJ(t,[{start:a,end:o,loop:n}],i,e);let l=o<a?o+s:o,h=!!t._fullLoop&&0===a&&o===s-1;return eJ(t,function(t,e,i,r){let s,n=t.length,a=[],o=e,l=t[e];for(s=e+1;s<=i;++s){let i=t[s%n];i.skip||i.stop?l.skip||(r=!1,a.push({start:e%n,end:(s-1)%n,loop:r}),e=o=i.stop?s:null):(o=s,l.skip&&(e=s)),l=i}return null!==o&&a.push({start:e%n,end:o%n,loop:r}),a}(i,a,l,h),i,e)}(this,this.options.segment))}first(){let t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){let t=this.segments,e=this.points,i=t.length;return i&&e[t[i-1].end]}interpolate(t,e){let i,r,s=this.options,n=t[e],a=this.points,o=eK(this,{property:e,start:n,end:n});if(!o.length)return;let l=[],h=s.stepped?eN:s.tension||"monotone"===s.cubicInterpolationMode?eU:eB;for(i=0,r=o.length;i<r;++i){let{start:r,end:u}=o[i],c=a[r],d=a[u];if(c===d){l.push(c);continue}let f=Math.abs((n-c[e])/(d[e]-c[e])),p=h(c,d,f,s.stepped);p[e]=t[e],l.push(p)}return 1===l.length?l[0]:l}pathSegment(t,e,i){return rR(this)(t,this,e,i)}path(t,e,i){let r=this.segments,s=rR(this),n=this._loop;for(let a of(e=e||0,i=i||this.points.length-e,r))n&=s(t,this,a,{start:e,end:e+i-1});return!!n}draw(t,e,i,r){let s=this.options||{};(this.points||[]).length&&s.borderWidth&&(t.save(),function(t,e,i,r){if(rP&&!e.options.segment){let s;(s=e._path)||(s=e._path=new Path2D,e.path(s,i,r)&&s.closePath()),rS(t,e.options),t.stroke(s)}else!function(t,e,i,r){let{segments:s,options:n}=e,a=rR(e);for(let o of s)rS(t,n,o.style),t.beginPath(),a(t,e,o,{start:i,end:i+r-1})&&t.closePath(),t.stroke()}(t,e,i,r)}(t,this,i,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function rM(t,e,i,r){let s=t.options,{[i]:n}=t.getProps([i],r);return Math.abs(e-n)<s.radius+s.hitRadius}class rD extends iY{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,i){let r=this.options,{x:s,y:n}=this.getProps(["x","y"],i);return Math.pow(t-s,2)+Math.pow(e-n,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(t,e){return rM(this,t,"x",e)}inYRange(t,e){return rM(this,t,"y",e)}getCenterPoint(t){let{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}size(t){let e=(t=t||this.options||{}).radius||0,i=(e=Math.max(e,e&&t.hoverRadius||0))&&t.borderWidth||0;return(e+i)*2}draw(t,e){let i=this.options;!this.skip&&!(i.radius<.1)&&t8(this,e,this.size(i)/2)&&(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,t2(t,i,this.x,this.y))}getRange(){let t=this.options||{};return t.radius+t.hitRadius}}function rI(t,e){let i,r,s,n,a,{x:o,y:l,base:h,width:u,height:c}=t.getProps(["x","y","base","width","height"],e);return t.horizontal?(a=c/2,i=Math.min(o,h),r=Math.max(o,h),s=l-a,n=l+a):(i=o-(a=u/2),r=o+a,s=Math.min(l,h),n=Math.max(l,h)),{left:i,top:s,right:r,bottom:n}}function rj(t,e,i,r){return t?0:tx(e,i,r)}function rL(t,e,i,r){let s=null===e,n=null===i,a=t&&!(s&&n)&&rI(t,r);return a&&(s||tk(e,a.left,a.right))&&(n||tk(i,a.top,a.bottom))}function r$(t,e){t.rect(e.x,e.y,e.w,e.h)}function rB(t,e,i={}){let r=t.x!==i.x?-e:0,s=t.y!==i.y?-e:0,n=(t.x+t.w!==i.x+i.w?e:0)-r,a=(t.y+t.h!==i.y+i.h?e:0)-s;return{x:t.x+r,y:t.y+s,w:t.w+n,h:t.h+a,radius:t.radius}}class rN extends iY{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){var e,i,r;let s,n,a,o,l,h,u,c,{inflateAmount:d,options:{borderColor:f,backgroundColor:p}}=this,{inner:g,outer:m}=(n=(s=rI(this)).right-s.left,a=s.bottom-s.top,e=n/2,i=a/2,o=this.options.borderWidth,l=this.borderSkipped,h=en(o),u={t:rj(l.top,h.top,0,i),r:rj(l.right,h.right,0,e),b:rj(l.bottom,h.bottom,0,i),l:rj(l.left,h.left,0,e)},c=function(t,e,i){let{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),s=t.options.borderRadius,n=ea(s),a=Math.min(e,i),o=t.borderSkipped,l=r||j(s);return{topLeft:rj(!l||o.top||o.left,n.topLeft,0,a),topRight:rj(!l||o.top||o.right,n.topRight,0,a),bottomLeft:rj(!l||o.bottom||o.left,n.bottomLeft,0,a),bottomRight:rj(!l||o.bottom||o.right,n.bottomRight,0,a)}}(this,n/2,a/2),{outer:{x:s.left,y:s.top,w:n,h:a,radius:c},inner:{x:s.left+u.l,y:s.top+u.t,w:n-u.l-u.r,h:a-u.t-u.b,radius:{topLeft:Math.max(0,c.topLeft-Math.max(u.t,u.l)),topRight:Math.max(0,c.topRight-Math.max(u.t,u.r)),bottomLeft:Math.max(0,c.bottomLeft-Math.max(u.b,u.l)),bottomRight:Math.max(0,c.bottomRight-Math.max(u.b,u.r))}}}),b=(r=m.radius).topLeft||r.topRight||r.bottomLeft||r.bottomRight?et:r$;t.save(),(m.w!==g.w||m.h!==g.h)&&(t.beginPath(),b(t,rB(m,d,g)),t.clip(),b(t,rB(g,-d,m)),t.fillStyle=f,t.fill("evenodd")),t.beginPath(),b(t,rB(g,d)),t.fillStyle=p,t.fill(),t.restore()}inRange(t,e,i){return rL(this,t,e,i)}inXRange(t,e){return rL(this,t,null,e)}inYRange(t,e){return rL(this,null,t,e)}getCenterPoint(t){let{x:e,y:i,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],t);return{x:s?(e+r)/2:e,y:s?i:(i+r)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}let rU=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],rF=rU.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function rz(t,e,i,r){if(r)return;let s=e[t],n=i[t];return"angle"===t&&(s=tw(s),n=tw(n)),{property:t,start:s,end:n}}function rV(t,e,i){for(;e>t;e--){let t=i[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}function rW(t,e,i,r){return t&&e?r(t[i],e[i]):t?t[i]:e?e[i]:0}function rH(t,e){let i=[],r=!1;return I(t)?(r=!0,i=t):i=function(t,e){let{x:i=null,y:r=null}=t||{},s=e.points,n=[];return e.segments.forEach(({start:t,end:e})=>{e=rV(t,e,s);let a=s[t],o=s[e];null!==r?(n.push({x:a.x,y:r}),n.push({x:o.x,y:r})):null!==i&&(n.push({x:i,y:a.y}),n.push({x:i,y:o.y}))}),n}(t,e),i.length?new rC({points:i,options:{tension:0},_loop:r,_fullLoop:r}):null}function rq(t){return t&&!1!==t.fill}class rK{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,i){let{x:r,y:s,radius:n}=this;return e=e||{start:0,end:ti},t.arc(r,s,n,e.end,e.start,!0),!i.bounds}interpolate(t){let{x:e,y:i,radius:r}=this,s=t.angle;return{x:e+Math.cos(s)*r,y:i+Math.sin(s)*r,angle:s}}}function rJ(t,e,i){let r=function(t){var e,i,r;let{chart:s,fill:n,line:a}=t;if(L(n)){let t;return e=s,i=n,(t=e.getDatasetMeta(i))&&e.isDatasetVisible(i)?t.dataset:null}if("stack"===n)return function(t){let{scale:e,index:i,line:r}=t,s=[],n=r.segments,a=r.points,o=function(t,e){let i=[],r=t.getMatchingVisibleMetas("line");for(let t=0;t<r.length;t++){let s=r[t];if(s.index===e)break;s.hidden||i.unshift(s.dataset)}return i}(e,i);o.push(rH({x:null,y:e.bottom},r));for(let t=0;t<n.length;t++){let e=n[t];for(let t=e.start;t<=e.end;t++)!function(t,e,i){let r=[];for(let s=0;s<i.length;s++){let{first:n,last:a,point:o}=function(t,e,i){let r=t.interpolate(e,"x");if(!r)return{};let s=r.x,n=t.segments,a=t.points,o=!1,l=!1;for(let t=0;t<n.length;t++){let e=n[t],i=a[e.start].x,r=a[e.end].x;if(tk(s,i,r)){o=s===i,l=s===r;break}}return{first:o,last:l,point:r}}(i[s],e,"x");if(o&&(!n||!a)){if(n)r.unshift(o);else if(t.push(o),!a)break}}t.push(...r)}(s,a[t],o)}return new rC({points:s,options:{}})}(t);if("shape"===n)return!0;let o=((r=t).scale||{}).getPointPositionForValue?function(t){let{scale:e,fill:i}=t,r=e.options,s=e.getLabels().length,n=r.reverse?e.max:e.min,a="start"===i?n:"end"===i?e.options.reverse?e.min:e.max:j(i)?i.value:e.getBaseValue(),o=[];if(r.grid.circular){let t=e.getPointPositionForValue(0,n);return new rK({x:t.x,y:t.y,radius:e.getDistanceFromCenterForValue(a)})}for(let t=0;t<s;++t)o.push(e.getPointPositionForValue(t,a));return o}(r):function(t){let e,{scale:i={},fill:r}=t,s=(e=null,"start"===r?e=i.bottom:"end"===r?e=i.top:j(r)?e=i.getPixelForValue(r.value):i.getBasePixel&&(e=i.getBasePixel()),e);if(L(s)){let t=i.isHorizontal();return{x:t?s:null,y:t?null:s}}return null}(r);return o instanceof rK?o:rH(o,a)}(e),{line:s,scale:n,axis:a}=e,o=s.options,l=o.fill,h=o.backgroundColor,{above:u=h,below:c=h}=l||{};r&&s.points.length&&(t3(t,i),function(t,e){let{line:i,target:r,above:s,below:n,area:a,scale:o}=e,l=i._loop?"angle":e.axis;t.save(),"x"===l&&n!==s&&(rG(t,r,a.top),rY(t,{line:i,target:r,color:s,scale:o,property:l}),t.restore(),t.save(),rG(t,r,a.bottom)),rY(t,{line:i,target:r,color:n,scale:o,property:l}),t.restore()}(t,{line:s,target:r,above:u,below:c,area:i,scale:n,axis:a}),t6(t))}function rG(t,e,i){let{segments:r,points:s}=e,n=!0,a=!1;for(let o of(t.beginPath(),r)){let{start:r,end:l}=o,h=s[r],u=s[rV(r,l,s)];n?(t.moveTo(h.x,h.y),n=!1):(t.lineTo(h.x,i),t.lineTo(h.x,h.y)),(a=!!e.pathSegment(t,o,{move:a}))?t.closePath():t.lineTo(u.x,i)}t.lineTo(e.first().x,i),t.closePath(),t.clip()}function rY(t,e){let{line:i,target:r,property:s,color:n,scale:a}=e;for(let{source:e,target:o,start:l,end:h}of function(t,e,i){let r=t.segments,s=t.points,n=e.points,a=[];for(let t of r){let{start:r,end:o}=t;o=rV(r,o,s);let l=rz(i,s[r],s[o],t.loop);if(!e.segments){a.push({source:t,target:l,start:s[r],end:s[o]});continue}for(let r of eK(e,l)){let e=rz(i,n[r.start],n[r.end],r.loop);for(let n of eq(t,s,e))a.push({source:n,target:r,start:{[i]:rW(l,e,"start",Math.max)},end:{[i]:rW(l,e,"end",Math.min)}})}}return a}(i,r,s)){let u,{style:{backgroundColor:c=n}={}}=e,d=!0!==r;t.save(),t.fillStyle=c,function(t,e,i){let{top:r,bottom:s}=e.chart.chartArea,{property:n,start:a,end:o}=i||{};"x"===n&&(t.beginPath(),t.rect(a,r,o-a,s-r),t.clip())}(t,a,d&&rz(s,l,h)),t.beginPath();let f=!!i.pathSegment(t,e);if(d){f?t.closePath():rX(t,r,h,s);let e=!!r.pathSegment(t,o,{move:f,reverse:!0});(u=f&&e)||rX(t,r,l,s)}t.closePath(),t.fill(u?"evenodd":"nonzero"),t.restore()}}function rX(t,e,i,r){let s=e.interpolate(i,r);s&&t.lineTo(s.x,s.y)}var rZ={id:"filler",afterDatasetsUpdate(t,e,i){let r,s,n,a,o=(t.data.datasets||[]).length,l=[];for(s=0;s<o;++s)n=(r=t.getDatasetMeta(s)).dataset,a=null,n&&n.options&&n instanceof rC&&(a={visible:t.isDatasetVisible(s),index:s,fill:function(t,e,i){var r,s,n,a;let o=function(t){let e=t.options,i=e.fill,r=B(i&&i.target,i);return void 0===r&&(r=!!e.backgroundColor),!1!==r&&null!==r&&(!0===r?"origin":r)}(t);if(j(o))return!isNaN(o.value)&&o;let l=parseFloat(o);return L(l)&&Math.floor(l)===l?(r=o[0],s=e,n=l,a=i,("-"===r||"+"===r)&&(n=s+n),n!==s&&!(n<0)&&!(n>=a)&&n):["origin","start","end","stack","shape"].indexOf(o)>=0&&o}(n,s,o),chart:t,axis:r.controller.options.indexAxis,scale:r.vScale,line:n}),r.$filler=a,l.push(a);for(s=0;s<o;++s)(a=l[s])&&!1!==a.fill&&(a.fill=function(t,e,i){let r,s=t[e].fill,n=[e];if(!i)return s;for(;!1!==s&&-1===n.indexOf(s);){if(!L(s))return s;if(!(r=t[s]))break;if(r.visible)return s;n.push(s),s=r.fill}return!1}(l,s,i.propagate))},beforeDraw(t,e,i){let r="beforeDraw"===i.drawTime,s=t.getSortedVisibleDatasetMetas(),n=t.chartArea;for(let e=s.length-1;e>=0;--e){let i=s[e].$filler;i&&(i.line.updateControlPoints(n,i.axis),r&&i.fill&&rJ(t.ctx,i,n))}},beforeDatasetsDraw(t,e,i){if("beforeDatasetsDraw"!==i.drawTime)return;let r=t.getSortedVisibleDatasetMetas();for(let e=r.length-1;e>=0;--e){let i=r[e].$filler;rq(i)&&rJ(t.ctx,i,t.chartArea)}},beforeDatasetDraw(t,e,i){let r=e.meta.$filler;rq(r)&&"beforeDatasetDraw"===i.drawTime&&rJ(t.ctx,r,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};let rQ=(t,e)=>{let{boxHeight:i=e,boxWidth:r=e}=t;return t.usePointStyle&&(i=Math.min(i,e),r=t.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:i,itemHeight:Math.max(e,i)}};class r0 extends iY{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){let t=this.options.labels||{},e=U(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(e=>t.filter(e,this.chart.data))),t.sort&&(e=e.sort((e,i)=>t.sort(e,i,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){let t,e,{options:i,ctx:r}=this;if(!i.display){this.width=this.height=0;return}let s=i.labels,n=el(s.font),a=n.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:h}=rQ(s,a);r.font=n.string,this.isHorizontal()?(t=this.maxWidth,e=this._fitRows(o,a,l,h)+10):(e=this.maxHeight,t=this._fitCols(o,n,l,h)+10),this.width=Math.min(t,i.maxWidth||this.maxWidth),this.height=Math.min(e,i.maxHeight||this.maxHeight)}_fitRows(t,e,i,r){let{ctx:s,maxWidth:n,options:{labels:{padding:a}}}=this,o=this.legendHitBoxes=[],l=this.lineWidths=[0],h=r+a,u=t;s.textAlign="left",s.textBaseline="middle";let c=-1,d=-h;return this.legendItems.forEach((t,f)=>{let p=i+e/2+s.measureText(t.text).width;(0===f||l[l.length-1]+p+2*a>n)&&(u+=h,l[l.length-(f>0?0:1)]=0,d+=h,c++),o[f]={left:0,top:d,row:c,width:p,height:r},l[l.length-1]+=p+a}),u}_fitCols(t,e,i,r){let{ctx:s,maxHeight:n,options:{labels:{padding:a}}}=this,o=this.legendHitBoxes=[],l=this.columnSizes=[],h=n-t,u=a,c=0,d=0,f=0,p=0;return this.legendItems.forEach((t,n)=>{var g,m,b,y,_,w,v,x,k,S,E,T;let O,A,{itemWidth:R,itemHeight:P}=(g=i,m=e,b=s,y=t,_=r,{itemWidth:(w=y,v=g,x=m,k=b,(O=w.text)&&"string"!=typeof O&&(O=O.reduce((t,e)=>t.length>e.length?t:e)),v+x.size/2+k.measureText(O).width),itemHeight:(S=_,E=y,T=m.lineHeight,A=S,"string"!=typeof E.text&&(A=r1(E,T)),A)});n>0&&d+P+2*a>h&&(u+=c+a,l.push({width:c,height:d}),f+=c+a,p++,c=d=0),o[n]={left:f,top:d,col:p,width:R,height:P},c=Math.max(c,R),d+=P+a}),u+=c,l.push({width:c,height:d}),u}adjustHitBoxes(){if(!this.options.display)return;let t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:r},rtl:s}}=this,n=eF(s,this.left,this.width);if(this.isHorizontal()){let s=0,a=tD(i,this.left+r,this.right-this.lineWidths[s]);for(let o of e)s!==o.row&&(s=o.row,a=tD(i,this.left+r,this.right-this.lineWidths[s])),o.top+=this.top+t+r,o.left=n.leftForLtr(n.x(a),o.width),a+=o.width+r}else{let s=0,a=tD(i,this.top+t+r,this.bottom-this.columnSizes[s].height);for(let o of e)o.col!==s&&(s=o.col,a=tD(i,this.top+t+r,this.bottom-this.columnSizes[s].height)),o.top=a,o.left+=this.left+r,o.left=n.leftForLtr(n.x(o.left),o.width),a+=o.height+r}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){let t=this.ctx;t3(t,this),this._draw(),t6(t)}}_draw(){let t,{options:e,columnSizes:i,lineWidths:r,ctx:s}=this,{align:n,labels:a}=e,o=tZ.color,l=eF(e.rtl,this.left,this.width),h=el(a.font),{padding:u}=a,c=h.size,d=c/2;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=h.string;let{boxWidth:f,boxHeight:p,itemHeight:g}=rQ(a,c),m=function(t,e,i){if(isNaN(f)||f<=0||isNaN(p)||p<0)return;s.save();let r=B(i.lineWidth,1);if(s.fillStyle=B(i.fillStyle,o),s.lineCap=B(i.lineCap,"butt"),s.lineDashOffset=B(i.lineDashOffset,0),s.lineJoin=B(i.lineJoin,"miter"),s.lineWidth=r,s.strokeStyle=B(i.strokeStyle,o),s.setLineDash(B(i.lineDash,[])),a.usePointStyle)t5(s,{radius:p*Math.SQRT2/2,pointStyle:i.pointStyle,rotation:i.rotation,borderWidth:r},l.xPlus(t,f/2),e+d,a.pointStyleWidth&&f);else{let n=e+Math.max((c-p)/2,0),a=l.leftForLtr(t,f),o=ea(i.borderRadius);s.beginPath(),Object.values(o).some(t=>0!==t)?et(s,{x:a,y:n,w:f,h:p,radius:o}):s.rect(a,n,f,p),s.fill(),0!==r&&s.stroke()}s.restore()},b=function(t,e,i){t7(s,i.text,t,e+g/2,h,{strikethrough:i.hidden,textAlign:l.textAlign(i.textAlign)})},y=this.isHorizontal(),_=this._computeTitleHeight();t=y?{x:tD(n,this.left+u,this.right-r[0]),y:this.top+u+_,line:0}:{x:this.left+u,y:tD(n,this.top+_+u,this.bottom-i[0].height),line:0},ez(this.ctx,e.textDirection);let w=g+u;this.legendItems.forEach((o,c)=>{var p,g;s.strokeStyle=o.fontColor,s.fillStyle=o.fontColor;let v=s.measureText(o.text).width,x=l.textAlign(o.textAlign||(o.textAlign=a.textAlign)),k=f+d+v,S=t.x,E=t.y;if(l.setWidth(this.width),y?c>0&&S+k+u>this.right&&(E=t.y+=w,t.line++,S=t.x=tD(n,this.left+u,this.right-r[t.line])):c>0&&E+w>this.bottom&&(S=t.x=S+i[t.line].width+u,t.line++,E=t.y=tD(n,this.top+_+u,this.bottom-i[t.line].height)),m(l.x(S),E,o),p=S+f+d,g=y?S+k:this.right,S=x===(e.rtl?"left":"right")?g:"center"===x?(p+g)/2:p,b(l.x(S),E,o),y)t.x+=k+u;else if("string"!=typeof o.text){let e=h.lineHeight;t.y+=r1(o,e)+u}else t.y+=w}),eV(this.ctx,e.textDirection)}drawTitle(){let t,e=this.options,i=e.title,r=el(i.font),s=eo(i.padding);if(!i.display)return;let n=eF(e.rtl,this.left,this.width),a=this.ctx,o=i.position,l=r.size/2,h=s.top+l,u=this.left,c=this.width;if(this.isHorizontal())c=Math.max(...this.lineWidths),t=this.top+h,u=tD(e.align,u,this.right-c);else{let i=this.columnSizes.reduce((t,e)=>Math.max(t,e.height),0);t=h+tD(e.align,this.top,this.bottom-i-e.labels.padding-this._computeTitleHeight())}let d=tD(o,u,u+c);a.textAlign=n.textAlign(tM(o)),a.textBaseline="middle",a.strokeStyle=i.color,a.fillStyle=i.color,a.font=r.string,t7(a,i.text,d,t,r)}_computeTitleHeight(){let t=this.options.title,e=el(t.font),i=eo(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,r,s;if(tk(t,this.left,this.right)&&tk(e,this.top,this.bottom)){for(i=0,s=this.legendHitBoxes;i<s.length;++i)if(tk(t,(r=s[i]).left,r.left+r.width)&&tk(e,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(t){var e,i;let r=this.options;if(e=t.type,i=r,("mousemove"!==e&&"mouseout"!==e||!i.onHover&&!i.onLeave)&&(!i.onClick||"click"!==e&&"mouseup"!==e))return;let s=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){let e=this._hoveredItem,i=null!==e&&null!==s&&e.datasetIndex===s.datasetIndex&&e.index===s.index;e&&!i&&U(r.onLeave,[t,e,this],this),this._hoveredItem=s,s&&!i&&U(r.onHover,[t,s,this],this)}else s&&U(r.onClick,[t,s,this],this)}}function r1(t,e){return e*(t.text?t.text.length:0)}var r2={id:"legend",_element:r0,start(t,e,i){let r=t.legend=new r0({ctx:t.ctx,options:i,chart:t});iD.configure(t,r,i),iD.addBox(t,r)},stop(t){iD.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,i){let r=t.legend;iD.configure(t,r,i),r.options=i},afterUpdate(t){let e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,i){let r=e.datasetIndex,s=i.chart;s.isDatasetVisible(r)?(s.hide(r),e.hidden=!0):(s.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){let e=t.data.datasets,{labels:{usePointStyle:i,pointStyle:r,textAlign:s,color:n,useBorderRadius:a,borderRadius:o}}=t.legend.options;return t._getSortedDatasetMetas().map(t=>{let l=t.controller.getStyle(i?0:void 0),h=eo(l.borderWidth);return{text:e[t.index].label,fillStyle:l.backgroundColor,fontColor:n,hidden:!t.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:l.borderColor,pointStyle:r||l.pointStyle,rotation:l.rotation,textAlign:s||l.textAlign,borderRadius:a&&(o||l.borderRadius),datasetIndex:t.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class r5 extends iY{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){let i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;let r=I(i.text)?i.text.length:1;this._padding=eo(i.padding);let s=r*el(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){let t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){let e,i,r,{top:s,left:n,bottom:a,right:o,options:l}=this,h=l.align,u=0;return this.isHorizontal()?(i=tD(h,n,o),r=s+t,e=o-n):("left"===l.position?(i=n+t,r=tD(h,a,s),u=-.5*te):(i=o-t,r=tD(h,s,a),u=.5*te),e=a-s),{titleX:i,titleY:r,maxWidth:e,rotation:u}}draw(){let t=this.ctx,e=this.options;if(!e.display)return;let i=el(e.font),r=i.lineHeight/2+this._padding.top,{titleX:s,titleY:n,maxWidth:a,rotation:o}=this._drawArgs(r);t7(t,e.text,0,0,i,{color:e.color,maxWidth:a,rotation:o,textAlign:tM(e.align),textBaseline:"middle",translation:[s,n]})}}var r8={id:"title",_element:r5,start(t,e,i){let r;r=new r5({ctx:t.ctx,options:i,chart:t}),iD.configure(t,r,i),iD.addBox(t,r),t.titleBlock=r},stop(t){let e=t.titleBlock;iD.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,i){let r=t.titleBlock;iD.configure(t,r,i),r.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;let r3={average(t){let e,i;if(!t.length)return!1;let r=0,s=0,n=0;for(e=0,i=t.length;e<i;++e){let i=t[e].element;if(i&&i.hasValue()){let t=i.tooltipPosition();r+=t.x,s+=t.y,++n}}return{x:r/n,y:s/n}},nearest(t,e){let i,r,s;if(!t.length)return!1;let n=e.x,a=e.y,o=1/0;for(i=0,r=t.length;i<r;++i){let r=t[i].element;if(r&&r.hasValue()){let t=ty(e,r.getCenterPoint());t<o&&(o=t,s=r)}}if(s){let t=s.tooltipPosition();n=t.x,a=t.y}return{x:n,y:a}}};function r6(t,e){return e&&(I(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function r4(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function r9(t,e){let i=t.chart.ctx,{body:r,footer:s,title:n}=t,{boxWidth:a,boxHeight:o}=e,l=el(e.bodyFont),h=el(e.titleFont),u=el(e.footerFont),c=n.length,d=s.length,f=r.length,p=eo(e.padding),g=p.height,m=0,b=r.reduce((t,e)=>t+e.before.length+e.lines.length+e.after.length,0);b+=t.beforeBody.length+t.afterBody.length,c&&(g+=c*h.lineHeight+(c-1)*e.titleSpacing+e.titleMarginBottom),b&&(g+=f*(e.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(b-f)*l.lineHeight+(b-1)*e.bodySpacing),d&&(g+=e.footerMarginTop+d*u.lineHeight+(d-1)*e.footerSpacing);let y=0,_=function(t){m=Math.max(m,i.measureText(t).width+y)};return i.save(),i.font=h.string,F(t.title,_),i.font=l.string,F(t.beforeBody.concat(t.afterBody),_),y=e.displayColors?a+2+e.boxPadding:0,F(r,t=>{F(t.before,_),F(t.lines,_),F(t.after,_)}),y=0,i.font=u.string,F(t.footer,_),i.restore(),{width:m+=p.width,height:g}}function r7(t,e,i){let r=i.yAlign||e.yAlign||function(t,e){let{y:i,height:r}=e;return i<r/2?"top":i>t.height-r/2?"bottom":"center"}(t,i);return{xAlign:i.xAlign||e.xAlign||function(t,e,i,r){let{x:s,width:n}=i,{width:a,chartArea:{left:o,right:l}}=t,h="center";return"center"===r?h=s<=(o+l)/2?"left":"right":s<=n/2?h="left":s>=a-n/2&&(h="right"),function(t,e,i,r){let{x:s,width:n}=r,a=i.caretSize+i.caretPadding;if("left"===t&&s+n+a>e.width||"right"===t&&s-n-a<0)return!0}(h,t,e,i)&&(h="center"),h}(t,e,i,r),yAlign:r}}function st(t,e,i,r){let{caretSize:s,caretPadding:n,cornerRadius:a}=t,{xAlign:o,yAlign:l}=i,h=s+n,{topLeft:u,topRight:c,bottomLeft:d,bottomRight:f}=ea(a),p=function(t,e){let{x:i,width:r}=t;return"right"===e?i-=r:"center"===e&&(i-=r/2),i}(e,o),g=function(t,e,i){let{y:r,height:s}=t;return"top"===e?r+=i:"bottom"===e?r-=s+i:r-=s/2,r}(e,l,h);return"center"===l?"left"===o?p+=h:"right"===o&&(p-=h):"left"===o?p-=Math.max(u,d)+s:"right"===o&&(p+=Math.max(c,f)+s),{x:tx(p,0,r.width-e.width),y:tx(g,0,r.height-e.height)}}function se(t,e,i){let r=eo(i.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-r.right:t.x+r.left}function si(t,e){let i=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return i?t.override(i):t}let sr={beforeTitle:C,title(t){if(t.length>0){let e=t[0],i=e.chart.data.labels,r=i?i.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return i[e.dataIndex]}return""},afterTitle:C,beforeBody:C,beforeLabel:C,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");let i=t.formattedValue;return D(i)||(e+=i),e},labelColor(t){let e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){let e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:C,afterBody:C,beforeFooter:C,footer:C,afterFooter:C};function ss(t,e,i,r){let s=t[e].call(i,r);return void 0===s?sr[e].call(i,r):s}class sn extends iY{static positioners=r3;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){let t=this._cachedAnimations;if(t)return t;let e=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&e.options.animation&&i.animations,s=new e0(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){var t;return this.$context||(this.$context=(t=this.chart.getContext(),eu(t,{tooltip:this,tooltipItems:this._tooltipItems,type:"tooltip"})))}getTitle(t,e){let{callbacks:i}=e,r=ss(i,"beforeTitle",this,t),s=ss(i,"title",this,t),n=ss(i,"afterTitle",this,t),a=[];return a=r6(a,r4(r)),a=r6(a,r4(s)),a=r6(a,r4(n))}getBeforeBody(t,e){return r6([],r4(ss(e.callbacks,"beforeBody",this,t)))}getBody(t,e){let{callbacks:i}=e,r=[];return F(t,t=>{let e={before:[],lines:[],after:[]},s=si(i,t);r6(e.before,r4(ss(s,"beforeLabel",this,t))),r6(e.lines,ss(s,"label",this,t)),r6(e.after,r4(ss(s,"afterLabel",this,t))),r.push(e)}),r}getAfterBody(t,e){return r6([],r4(ss(e.callbacks,"afterBody",this,t)))}getFooter(t,e){let{callbacks:i}=e,r=ss(i,"beforeFooter",this,t),s=ss(i,"footer",this,t),n=ss(i,"afterFooter",this,t),a=[];return a=r6(a,r4(r)),a=r6(a,r4(s)),a=r6(a,r4(n))}_createItems(t){let e,i,r=this._active,s=this.chart.data,n=[],a=[],o=[],l=[];for(e=0,i=r.length;e<i;++e)l.push(function(t,e){let{element:i,datasetIndex:r,index:s}=e,n=t.getDatasetMeta(r).controller,{label:a,value:o}=n.getLabelAndValue(s);return{chart:t,label:a,parsed:n.getParsed(s),raw:t.data.datasets[r].data[s],formattedValue:o,dataset:n.getDataset(),dataIndex:s,datasetIndex:r,element:i}}(this.chart,r[e]));return t.filter&&(l=l.filter((e,i,r)=>t.filter(e,i,r,s))),t.itemSort&&(l=l.sort((e,i)=>t.itemSort(e,i,s))),F(l,e=>{let i=si(t.callbacks,e);n.push(ss(i,"labelColor",this,e)),a.push(ss(i,"labelPointStyle",this,e)),o.push(ss(i,"labelTextColor",this,e))}),this.labelColors=n,this.labelPointStyles=a,this.labelTextColors=o,this.dataPoints=l,l}update(t,e){let i,r=this.options.setContext(this.getContext()),s=this._active,n=[];if(s.length){let t=r3[r.position].call(this,s,this._eventPosition);n=this._createItems(r),this.title=this.getTitle(n,r),this.beforeBody=this.getBeforeBody(n,r),this.body=this.getBody(n,r),this.afterBody=this.getAfterBody(n,r),this.footer=this.getFooter(n,r);let e=this._size=r9(this,r),a=Object.assign({},t,e),o=r7(this.chart,r,a),l=st(r,a,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,i={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(i={opacity:0});this._tooltipItems=n,this.$context=void 0,i&&this._resolveAnimations().update(this,i),t&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,i,r){let s=this.getCaretPosition(t,i,r);e.lineTo(s.x1,s.y1),e.lineTo(s.x2,s.y2),e.lineTo(s.x3,s.y3)}getCaretPosition(t,e,i){let r,s,n,a,o,l,{xAlign:h,yAlign:u}=this,{caretSize:c,cornerRadius:d}=i,{topLeft:f,topRight:p,bottomLeft:g,bottomRight:m}=ea(d),{x:b,y:y}=t,{width:_,height:w}=e;return"center"===u?(o=y+w/2,"left"===h?(s=(r=b)-c,a=o+c,l=o-c):(s=(r=b+_)+c,a=o-c,l=o+c),n=r):(s="left"===h?b+Math.max(f,g)+c:"right"===h?b+_-Math.max(p,m)-c:this.caretX,"top"===u?(o=(a=y)-c,r=s-c,n=s+c):(o=(a=y+w)+c,r=s+c,n=s-c),l=a),{x1:r,x2:s,x3:n,y1:a,y2:o,y3:l}}drawTitle(t,e,i){let r,s,n,a=this.title,o=a.length;if(o){let l=eF(i.rtl,this.x,this.width);for(n=0,t.x=se(this,i.titleAlign,i),e.textAlign=l.textAlign(i.titleAlign),e.textBaseline="middle",r=el(i.titleFont),s=i.titleSpacing,e.fillStyle=i.titleColor,e.font=r.string;n<o;++n)e.fillText(a[n],l.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+s,n+1===o&&(t.y+=i.titleMarginBottom-s)}}_drawColorBox(t,e,i,r,s){let n=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:o,boxWidth:l}=s,h=el(s.bodyFont),u=se(this,"left",s),c=r.x(u),d=o<h.lineHeight?(h.lineHeight-o)/2:0,f=e.y+d;if(s.usePointStyle){let e={radius:Math.min(l,o)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},i=r.leftForLtr(c,l)+l/2,h=f+o/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,t2(t,e,i,h),t.strokeStyle=n.borderColor,t.fillStyle=n.backgroundColor,t2(t,e,i,h)}else{t.lineWidth=j(n.borderWidth)?Math.max(...Object.values(n.borderWidth)):n.borderWidth||1,t.strokeStyle=n.borderColor,t.setLineDash(n.borderDash||[]),t.lineDashOffset=n.borderDashOffset||0;let e=r.leftForLtr(c,l),i=r.leftForLtr(r.xPlus(c,1),l-2),a=ea(n.borderRadius);Object.values(a).some(t=>0!==t)?(t.beginPath(),t.fillStyle=s.multiKeyBackground,et(t,{x:e,y:f,w:l,h:o,radius:a}),t.fill(),t.stroke(),t.fillStyle=n.backgroundColor,t.beginPath(),et(t,{x:i,y:f+1,w:l-2,h:o-2,radius:a}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(e,f,l,o),t.strokeRect(e,f,l,o),t.fillStyle=n.backgroundColor,t.fillRect(i,f+1,l-2,o-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,e,i){let r,s,n,a,o,l,{body:h}=this,{bodySpacing:u,bodyAlign:c,displayColors:d,boxHeight:f,boxWidth:p,boxPadding:g}=i,m=el(i.bodyFont),b=m.lineHeight,y=0,_=eF(i.rtl,this.x,this.width),w=function(i){e.fillText(i,_.x(t.x+y),t.y+b/2),t.y+=b+u},v=_.textAlign(c);for(e.textAlign=c,e.textBaseline="middle",e.font=m.string,t.x=se(this,v,i),e.fillStyle=i.bodyColor,F(this.beforeBody,w),y=d&&"right"!==v?"center"===c?p/2+g:p+2+g:0,n=0,o=h.length;n<o;++n){for(r=h[n],e.fillStyle=this.labelTextColors[n],F(r.before,w),s=r.lines,d&&s.length&&(this._drawColorBox(e,t,n,_,i),b=Math.max(m.lineHeight,f)),a=0,l=s.length;a<l;++a)w(s[a]),b=m.lineHeight;F(r.after,w)}y=0,b=m.lineHeight,F(this.afterBody,w),t.y-=u}drawFooter(t,e,i){let r,s,n=this.footer,a=n.length;if(a){let o=eF(i.rtl,this.x,this.width);for(t.x=se(this,i.footerAlign,i),t.y+=i.footerMarginTop,e.textAlign=o.textAlign(i.footerAlign),e.textBaseline="middle",r=el(i.footerFont),e.fillStyle=i.footerColor,e.font=r.string,s=0;s<a;++s)e.fillText(n[s],o.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+i.footerSpacing}}drawBackground(t,e,i,r){let{xAlign:s,yAlign:n}=this,{x:a,y:o}=t,{width:l,height:h}=i,{topLeft:u,topRight:c,bottomLeft:d,bottomRight:f}=ea(r.cornerRadius);e.fillStyle=r.backgroundColor,e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.beginPath(),e.moveTo(a+u,o),"top"===n&&this.drawCaret(t,e,i,r),e.lineTo(a+l-c,o),e.quadraticCurveTo(a+l,o,a+l,o+c),"center"===n&&"right"===s&&this.drawCaret(t,e,i,r),e.lineTo(a+l,o+h-f),e.quadraticCurveTo(a+l,o+h,a+l-f,o+h),"bottom"===n&&this.drawCaret(t,e,i,r),e.lineTo(a+d,o+h),e.quadraticCurveTo(a,o+h,a,o+h-d),"center"===n&&"left"===s&&this.drawCaret(t,e,i,r),e.lineTo(a,o+u),e.quadraticCurveTo(a,o,a+u,o),e.closePath(),e.fill(),r.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){let e=this.chart,i=this.$animations,r=i&&i.x,s=i&&i.y;if(r||s){let i=r3[t.position].call(this,this._active,this._eventPosition);if(!i)return;let n=this._size=r9(this,t),a=Object.assign({},i,this._size),o=r7(e,t,a),l=st(t,a,o,e);(r._to!==l.x||s._to!==l.y)&&(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=n.width,this.height=n.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(t){let e=this.options.setContext(this.getContext()),i=this.opacity;if(!i)return;this._updateAnimationTarget(e);let r={width:this.width,height:this.height},s={x:this.x,y:this.y};i=.001>Math.abs(i)?0:i;let n=eo(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=i,this.drawBackground(s,t,r,e),ez(t,e.textDirection),s.y+=n.top,this.drawTitle(s,t,e),this.drawBody(s,t,e),this.drawFooter(s,t,e),eV(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){let i=this._active,r=t.map(({datasetIndex:t,index:e})=>{let i=this.chart.getDatasetMeta(t);if(!i)throw Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:i.data[e],index:e}}),s=!z(i,r),n=this._positionChanged(r,e);(s||n)&&(this._active=r,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,i=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;let r=this.options,s=this._active||[],n=this._getActiveElements(t,s,e,i),a=this._positionChanged(n,t),o=e||!z(n,s)||a;return o&&(this._active=n,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),o}_getActiveElements(t,e,i,r){let s=this.options;if("mouseout"===t.type)return[];if(!r)return e;let n=this.chart.getElementsAtEventForMode(t,s.mode,s,i);return s.reverse&&n.reverse(),n}_positionChanged(t,e){let{caretX:i,caretY:r,options:s}=this,n=r3[s.position].call(this,t,e);return!1!==n&&(i!==n.x||r!==n.y)}}var sa={id:"tooltip",_element:sn,positioners:r3,afterInit(t,e,i){i&&(t.tooltip=new sn({chart:t,options:i}))},beforeUpdate(t,e,i){t.tooltip&&t.tooltip.initialize(i)},reset(t,e,i){t.tooltip&&t.tooltip.initialize(i)},afterDraw(t){let e=t.tooltip;if(e&&e._willRender()){let i={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",{...i,cancelable:!0}))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",i)}},afterEvent(t,e){if(t.tooltip){let i=e.replay;t.tooltip.handleEvent(e.event,i,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:sr},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function so(t){let e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class sl extends i5{static id="category";static defaults={ticks:{callback:so}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){let e=this._addedLabels;if(e.length){let t=this.getLabels();for(let{index:i,label:r}of e)t[i]===r&&t.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,e){let i,r;if(D(t))return null;let s=this.getLabels();return i=e=isFinite(e)&&s[e]===t?e:function(t,e,i,r){let s=t.indexOf(e);if(-1===s){var n;return n=i,"string"==typeof e?(n=t.push(e)-1,r.unshift({index:n,label:e})):isNaN(e)&&(n=null),n}return s!==t.lastIndexOf(e)?i:s}(s,t,B(e,t),this._addedLabels),r=s.length-1,null===i?null:tx(Math.round(i),0,r)}determineDataLimits(){let{minDefined:t,maxDefined:e}=this.getUserBounds(),{min:i,max:r}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(i=0),e||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){let t=this.min,e=this.max,i=this.options.offset,r=[],s=this.getLabels();s=0===t&&e===s.length-1?s:s.slice(t,e+1),this._valueRange=Math.max(s.length-!i,1),this._startValue=this.min-.5*!!i;for(let i=t;i<=e;i++)r.push({value:i});return r}getLabelForValue(t){return so.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!=typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){let e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function sh(t,e,{horizontal:i,minRotation:r}){let s=tg(r),n=(i?Math.sin(s):Math.cos(s))||.001,a=.75*e*(""+t).length;return Math.min(e/n,a)}class su extends i5{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return D(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){let{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds(),{min:r,max:s}=this,n=t=>r=e?r:t,a=t=>s=i?s:t;if(t){let t=tu(r),e=tu(s);t<0&&e<0?a(0):t>0&&e>0&&n(0)}if(r===s){let e=0===s?1:Math.abs(.05*s);a(s+e),t||n(r-e)}this.min=r,this.max=s}getTickLimit(){let t,{maxTicksLimit:e,stepSize:i}=this.options.ticks;return i?(t=Math.ceil(this.max/i)-Math.floor(this.min/i)+1)>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${t} ticks. Limiting to 1000.`),t=1e3):(t=this.computeTickLimit(),e=e||11),e&&(t=Math.min(e,t)),t}computeTickLimit(){return 1/0}buildTicks(){let t=this.options,e=t.ticks,i=this.getTickLimit(),r=function(t,e){var i,r;let s,n,a,o,l,h=[],{bounds:u,step:c,min:d,max:f,precision:p,count:g,maxTicks:m,maxDigits:b,includeBounds:y}=t,_=c||1,w=m-1,{min:v,max:x}=e,k=!D(d),S=!D(f),E=!D(g),T=(x-v)/(b+1),O=td((x-v)/w/_)*_;if(O<1e-14&&!k&&!S)return[{value:v},{value:x}];(o=Math.ceil(x/O)-Math.floor(v/O))>w&&(O=td(o*O/w/_)*_),D(p)||(O=Math.ceil(O*(s=Math.pow(10,p)))/s),"ticks"===u?(n=Math.floor(v/O)*O,a=Math.ceil(x/O)*O):(n=v,a=x),k&&S&&c&&(i=(f-d)/c,r=O/1e3,(l=Math.round(i))-r<=i&&l+r>=i)?(o=Math.round(Math.min((f-d)/O,m)),O=(f-d)/o,n=d,a=f):E?(n=k?d:n,O=((a=S?f:a)-n)/(o=g-1)):o=tc(o=(a-n)/O,Math.round(o),O/1e3)?Math.round(o):Math.ceil(o);let A=Math.max(tm(O),tm(n));n=Math.round(n*(s=Math.pow(10,D(p)?A:p)))/s,a=Math.round(a*s)/s;let R=0;for(k&&(y&&n!==d?(h.push({value:d}),n<d&&R++,tc(Math.round((n+R*O)*s)/s,d,sh(d,T,t))&&R++):n<d&&R++);R<o;++R){let t=Math.round((n+R*O)*s)/s;if(S&&t>f)break;h.push({value:t})}return S&&y&&a!==f?h.length&&tc(h[h.length-1].value,f,sh(f,T,t))?h[h.length-1].value=f:h.push({value:f}):S&&a!==f||h.push({value:a}),h}({maxTicks:i=Math.max(2,i),bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&tp(r,this,"value"),t.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}configure(){let t=this.ticks,e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){let r=(i-e)/Math.max(t.length-1,1)/2;e-=r,i+=r}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return tq(t,this.chart.options.locale,this.options.ticks.format)}}class sc extends su{static id="linear";static defaults={ticks:{callback:tK.numeric}};determineDataLimits(){let{min:t,max:e}=this.getMinMax(!0);this.min=L(t)?t:0,this.max=L(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){let t=this.isHorizontal(),e=t?this.width:this.height,i=tg(this.options.ticks.minRotation),r=(t?Math.sin(i):Math.cos(i))||.001;return Math.ceil(e/Math.min(40,this._resolveTickFontOptions(0).lineHeight/r))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}let sd=t=>Math.floor(th(t)),sf=(t,e)=>Math.pow(10,sd(t)+e);function sp(t){return 1==t/Math.pow(10,sd(t))}function sg(t,e,i){let r=Math.pow(10,i),s=Math.floor(t/r);return Math.ceil(e/r)-s}class sm extends i5{static id="logarithmic";static defaults={ticks:{callback:tK.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){let i=su.prototype.parse.apply(this,[t,e]);if(0===i){this._zero=!0;return}return L(i)&&i>0?i:null}determineDataLimits(){let{min:t,max:e}=this.getMinMax(!0);this.min=L(t)?Math.max(0,t):null,this.max=L(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!L(this._userMin)&&(this.min=t===sf(this.min,0)?sf(this.min,-1):sf(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){let{minDefined:t,maxDefined:e}=this.getUserBounds(),i=this.min,r=this.max,s=e=>i=t?i:e,n=t=>r=e?r:t;i===r&&(i<=0?(s(1),n(10)):(s(sf(i,-1)),n(sf(r,1)))),i<=0&&s(sf(r,-1)),r<=0&&n(sf(i,1)),this.min=i,this.max=r}buildTicks(){let t=this.options,e=function(t,{min:e,max:i}){e=$(t.min,e);let r=[],s=sd(e),n=function(t,e){let i=sd(e-t);for(;sg(t,e,i)>10;)i++;for(;10>sg(t,e,i);)i--;return Math.min(i,sd(t))}(e,i),a=n<0?Math.pow(10,Math.abs(n)):1,o=Math.pow(10,n),l=s>n?Math.pow(10,s):0,h=Math.round((e-l)*a)/a,u=Math.floor((e-l)/o/10)*o*10,c=Math.floor((h-u)/Math.pow(10,n)),d=$(t.min,Math.round((l+u+c*Math.pow(10,n))*a)/a);for(;d<i;)r.push({value:d,major:sp(d),significand:c}),c>=10?c=c<15?15:20:c++,c>=20&&(c=2,a=++n>=0?1:a),d=Math.round((l+u+c*Math.pow(10,n))*a)/a;let f=$(t.max,d);return r.push({value:f,major:sp(f),significand:c}),r}({min:this._userMin,max:this._userMax},this);return"ticks"===t.bounds&&tp(e,this,"value"),t.reverse?(e.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),e}getLabelForValue(t){return void 0===t?"0":tq(t,this.chart.options.locale,this.options.ticks.format)}configure(){let t=this.min;super.configure(),this._startValue=th(t),this._valueRange=th(this.max)-th(t)}getPixelForValue(t){return((void 0===t||0===t)&&(t=this.min),null===t||isNaN(t))?NaN:this.getPixelForDecimal(t===this.min?0:(th(t)-this._startValue)/this._valueRange)}getValueForPixel(t){let e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function sb(t){let e=t.ticks;if(e.display&&t.display){let t=eo(e.backdropPadding);return B(e.font&&e.font.size,tZ.font.size)+t.height}return 0}function sy(t,e,i,r,s){return t===r||t===s?{start:e-i/2,end:e+i/2}:t<r||t>s?{start:e-i,end:e}:{start:e,end:e+i}}function s_(t,e,i,r){let{ctx:s}=t;if(i)s.arc(t.xCenter,t.yCenter,e,0,ti);else{let i=t.getPointPosition(0,e);s.moveTo(i.x,i.y);for(let n=1;n<r;n++)i=t.getPointPosition(n,e),s.lineTo(i.x,i.y)}}class sw extends su{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:tK.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:t=>t,padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){let t=this._padding=eo(sb(this.options)/2),e=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(e,i)/2)}determineDataLimits(){let{min:t,max:e}=this.getMinMax(!1);this.min=L(t)&&!isNaN(t)?t:0,this.max=L(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/sb(this.options))}generateTickLabels(t){su.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((t,e)=>{let i=U(this.options.pointLabels.callback,[t,e],this);return i||0===i?i:""}).filter((t,e)=>this.chart.getDataVisibility(e))}fit(){let t=this.options;t.display&&t.pointLabels.display?function(t){let e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},i=Object.assign({},e),r=[],s=[],n=t._pointLabels.length,a=t.options.pointLabels,o=a.centerPointLabels?te/n:0;for(let u=0;u<n;u++){var l,h;let n=a.setContext(t.getPointLabelContext(u));s[u]=n.padding;let c=t.getPointPosition(u,t.drawingArea+s[u],o),d=el(n.font),f=(l=t.ctx,h=I(h=t._pointLabels[u])?h:[h],{w:function(t,e,i,r){let s,n,a,o,l,h=(r=r||{}).data=r.data||{},u=r.garbageCollect=r.garbageCollect||[];r.font!==e&&(h=r.data={},u=r.garbageCollect=[],r.font=e),t.save(),t.font=e;let c=0,d=i.length;for(s=0;s<d;s++)if(null==(o=i[s])||I(o)){if(I(o))for(n=0,a=o.length;n<a;n++)null==(l=o[n])||I(l)||(c=tQ(t,h,u,c,l))}else c=tQ(t,h,u,c,o);t.restore();let f=u.length/2;if(f>i.length){for(s=0;s<f;s++)delete h[u[s]];u.splice(0,f)}return c}(l,d.string,h),h:h.length*d.lineHeight});r[u]=f;let p=tw(t.getIndexAngle(u)+o),g=Math.round(180/te*p);!function(t,e,i,r,s){let n=Math.abs(Math.sin(i)),a=Math.abs(Math.cos(i)),o=0,l=0;r.start<e.l?(o=(e.l-r.start)/n,t.l=Math.min(t.l,e.l-o)):r.end>e.r&&(o=(r.end-e.r)/n,t.r=Math.max(t.r,e.r+o)),s.start<e.t?(l=(e.t-s.start)/a,t.t=Math.min(t.t,e.t-l)):s.end>e.b&&(l=(s.end-e.b)/a,t.b=Math.max(t.b,e.b+l))}(i,e,p,sy(g,c.x,f.w,0,180),sy(g,c.y,f.h,90,270))}t.setCenterPoint(e.l-i.l,i.r-e.r,e.t-i.t,i.b-e.b),t._pointLabelItems=function(t,e,i){let r,s=[],n=t._pointLabels.length,a=t.options,{centerPointLabels:o,display:l}=a.pointLabels,h={extra:sb(a)/2,additionalAngle:o?te/n:0};for(let a=0;a<n;a++){h.padding=i[a],h.size=e[a];let n=function(t,e,i){var r,s,n,a,o,l,h;let u=t.drawingArea,{extra:c,additionalAngle:d,padding:f,size:p}=i,g=t.getPointPosition(e,u+c+f,d),m=Math.round(180/te*tw(g.angle+ta)),b=(r=g.y,s=p.h,90===(n=m)||270===n?r-=s/2:(n>270||n<90)&&(r-=s),r),y=0===(a=m)||180===a?"center":a<180?"left":"right",_=(o=g.x,l=p.w,"right"===(h=y)?o-=l:"center"===h&&(o-=l/2),o);return{visible:!0,x:g.x,y:b,textAlign:y,left:_,top:b,right:_+p.w,bottom:b+p.h}}(t,a,h);s.push(n),"auto"===l&&(n.visible=function(t,e){if(!e)return!0;let{left:i,top:r,right:s,bottom:n}=t;return!(t8({x:i,y:r},e)||t8({x:i,y:n},e)||t8({x:s,y:r},e)||t8({x:s,y:n},e))}(n,r),n.visible&&(r=n))}return s}(t,r,s)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,i,r){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,i,r))}getIndexAngle(t){return tw(t*(ti/(this._pointLabels.length||1))+tg(this.options.startAngle||0))}getDistanceFromCenterForValue(t){if(D(t))return NaN;let e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(D(t))return NaN;let e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){let e=this._pointLabels||[];if(t>=0&&t<e.length){var i;let r=e[t];return i=this.getContext(),eu(i,{label:r,index:t,type:"pointLabel"})}}getPointPosition(t,e,i=0){let r=this.getIndexAngle(t)-ta+i;return{x:Math.cos(r)*e+this.xCenter,y:Math.sin(r)*e+this.yCenter,angle:r}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){let{left:e,top:i,right:r,bottom:s}=this._pointLabelItems[t];return{left:e,top:i,right:r,bottom:s}}drawBackground(){let{backgroundColor:t,grid:{circular:e}}=this.options;if(t){let i=this.ctx;i.save(),i.beginPath(),s_(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){let t,e,i,r=this.ctx,s=this.options,{angleLines:n,grid:a,border:o}=s,l=this._pointLabels.length;if(s.pointLabels.display&&function(t,e){let{ctx:i,options:{pointLabels:r}}=t;for(let s=e-1;s>=0;s--){let e=t._pointLabelItems[s];if(!e.visible)continue;let n=r.setContext(t.getPointLabelContext(s));!function(t,e,i){let{left:r,top:s,right:n,bottom:a}=i,{backdropColor:o}=e;if(!D(o)){let i=ea(e.borderRadius),l=eo(e.backdropPadding);t.fillStyle=o;let h=r-l.left,u=s-l.top,c=n-r+l.width,d=a-s+l.height;Object.values(i).some(t=>0!==t)?(t.beginPath(),et(t,{x:h,y:u,w:c,h:d,radius:i}),t.fill()):t.fillRect(h,u,c,d)}}(i,n,e);let a=el(n.font),{x:o,y:l,textAlign:h}=e;t7(i,t._pointLabels[s],o,l+a.lineHeight/2,a,{color:n.color,textAlign:h,textBaseline:"middle"})}}(this,l),a.display&&this.ticks.forEach((t,i)=>{if(0!==i){e=this.getDistanceFromCenterForValue(t.value);let r=this.getContext(i),s=a.setContext(r),n=o.setContext(r);!function(t,e,i,r,s){let n=t.ctx,a=e.circular,{color:o,lineWidth:l}=e;(a||r)&&o&&l&&!(i<0)&&(n.save(),n.strokeStyle=o,n.lineWidth=l,n.setLineDash(s.dash),n.lineDashOffset=s.dashOffset,n.beginPath(),s_(t,i,a,r),n.closePath(),n.stroke(),n.restore())}(this,s,e,l,n)}}),n.display){for(r.save(),t=l-1;t>=0;t--){let a=n.setContext(this.getPointLabelContext(t)),{color:o,lineWidth:l}=a;l&&o&&(r.lineWidth=l,r.strokeStyle=o,r.setLineDash(a.borderDash),r.lineDashOffset=a.borderDashOffset,e=this.getDistanceFromCenterForValue(s.ticks.reverse?this.min:this.max),i=this.getPointPosition(t,e),r.beginPath(),r.moveTo(this.xCenter,this.yCenter),r.lineTo(i.x,i.y),r.stroke())}r.restore()}}drawBorder(){}drawLabels(){let t,e,i=this.ctx,r=this.options,s=r.ticks;if(!s.display)return;let n=this.getIndexAngle(0);i.save(),i.translate(this.xCenter,this.yCenter),i.rotate(n),i.textAlign="center",i.textBaseline="middle",this.ticks.forEach((n,a)=>{if(0===a&&!r.reverse)return;let o=s.setContext(this.getContext(a)),l=el(o.font);if(t=this.getDistanceFromCenterForValue(this.ticks[a].value),o.showLabelBackdrop){i.font=l.string,e=i.measureText(n.label).width,i.fillStyle=o.backdropColor;let r=eo(o.backdropPadding);i.fillRect(-e/2-r.left,-t-l.size/2-r.top,e+r.width,l.size+r.height)}t7(i,n.label,0,-t,l,{color:o.color,strokeColor:o.textStrokeColor,strokeWidth:o.textStrokeWidth})}),i.restore()}drawTitle(){}}let sv={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},sx=Object.keys(sv);function sk(t,e){return t-e}function sS(t,e){if(D(e))return null;let i=t._adapter,{parser:r,round:s,isoWeekday:n}=t._parseOpts,a=e;return("function"==typeof r&&(a=r(a)),L(a)||(a="string"==typeof r?i.parse(a,r):i.parse(a)),null===a)?null:(s&&(a="week"===s&&(tf(n)||!0===n)?i.startOf(a,"isoWeek",n):i.startOf(a,s)),+a)}function sE(t,e,i,r){let s=sx.length;for(let n=sx.indexOf(t);n<s-1;++n){let t=sv[sx[n]],s=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((i-e)/(s*t.size))<=r)return sx[n]}return sx[s-1]}function sT(t,e,i){if(i){if(i.length){let{lo:r,hi:s}=tS(i,e);t[i[r]>=e?i[r]:i[s]]=!0}}else t[e]=!0}function sO(t,e,i){let r,s,n=[],a={},o=e.length;for(r=0;r<o;++r)a[s=e[r]]=r,n.push({value:s,major:!1});return 0!==o&&i?function(t,e,i,r){let s,n,a=t._adapter,o=+a.startOf(e[0].value,r),l=e[e.length-1].value;for(s=o;s<=l;s=+a.add(s,1,r))(n=i[s])>=0&&(e[n].major=!0);return e}(t,n,a,i):n}class sA extends i5{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){let i=t.time||(t.time={}),r=this._adapter=new iy(t.adapters.date);r.init(e),K(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:sS(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){let t=this.options,e=this._adapter,i=t.time.unit||"day",{min:r,max:s,minDefined:n,maxDefined:a}=this.getUserBounds();function o(t){n||isNaN(t.min)||(r=Math.min(r,t.min)),a||isNaN(t.max)||(s=Math.max(s,t.max))}n&&a||(o(this._getLabelBounds()),("ticks"!==t.bounds||"labels"!==t.ticks.source)&&o(this.getMinMax(!1))),r=L(r)&&!isNaN(r)?r:+e.startOf(Date.now(),i),s=L(s)&&!isNaN(s)?s:+e.endOf(Date.now(),i)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){let t=this.getLabelTimestamps(),e=1/0,i=-1/0;return t.length&&(e=t[0],i=t[t.length-1]),{min:e,max:i}}buildTicks(){let t=this.options,e=t.time,i=t.ticks,r="labels"===i.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);let s=this.min,n=function(t,e,i){let r=0,s=t.length;for(;r<s&&t[r]<e;)r++;for(;s>r&&t[s-1]>i;)s--;return r>0||s<t.length?t.slice(r,s):t}(r,s,this.max);return this._unit=e.unit||(i.autoSkip?sE(e.minUnit,this.min,this.max,this._getLabelCapacity(s)):function(t,e,i,r,s){for(let n=sx.length-1;n>=sx.indexOf(i);n--){let i=sx[n];if(sv[i].common&&t._adapter.diff(s,r,i)>=e-1)return i}return sx[i?sx.indexOf(i):0]}(this,n.length,e.minUnit,this.min,this.max)),this._majorUnit=i.major.enabled&&"year"!==this._unit?function(t){for(let e=sx.indexOf(t)+1,i=sx.length;e<i;++e)if(sv[sx[e]].common)return sx[e]}(this._unit):void 0,this.initOffsets(r),t.reverse&&n.reverse(),sO(this,n,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e,i,r=0,s=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),r=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,i=this.getDecimalForValue(t[t.length-1]),s=1===t.length?i:(i-this.getDecimalForValue(t[t.length-2]))/2);let n=t.length<3?.5:.25;r=tx(r,0,n),s=tx(s,0,n),this._offsets={start:r,end:s,factor:1/(r+1+s)}}_generate(){let t,e,i=this._adapter,r=this.min,s=this.max,n=this.options,a=n.time,o=a.unit||sE(a.minUnit,r,s,this._getLabelCapacity(r)),l=B(n.ticks.stepSize,1),h="week"===o&&a.isoWeekday,u=tf(h)||!0===h,c={},d=r;if(u&&(d=+i.startOf(d,"isoWeek",h)),d=+i.startOf(d,u?"day":o),i.diff(s,r,o)>1e5*l)throw Error(r+" and "+s+" are too far apart with stepSize of "+l+" "+o);let f="data"===n.ticks.source&&this.getDataTimestamps();for(t=d,e=0;t<s;t=+i.add(t,l,o),e++)sT(c,t,f);return(t===s||"ticks"===n.bounds||1===e)&&sT(c,t,f),Object.keys(c).sort(sk).map(t=>+t)}getLabelForValue(t){let e=this._adapter,i=this.options.time;return i.tooltipFormat?e.format(t,i.tooltipFormat):e.format(t,i.displayFormats.datetime)}format(t,e){let i=this.options.time.displayFormats,r=this._unit,s=e||i[r];return this._adapter.format(t,s)}_tickFormatFunction(t,e,i,r){let s=this.options,n=s.ticks.callback;if(n)return U(n,[t,e,i],this);let a=s.time.displayFormats,o=this._unit,l=this._majorUnit,h=o&&a[o],u=l&&a[l],c=i[e],d=l&&u&&c&&c.major;return this._adapter.format(t,r||(d?u:h))}generateTickLabels(t){let e,i,r;for(e=0,i=t.length;e<i;++e)(r=t[e]).label=this._tickFormatFunction(r.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){let e=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+i)*e.factor)}getValueForPixel(t){let e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){let e=this.options.ticks,i=this.ctx.measureText(t).width,r=tg(this.isHorizontal()?e.maxRotation:e.minRotation),s=Math.cos(r),n=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:i*s+a*n,h:i*n+a*s}}_getLabelCapacity(t){let e=this.options.time,i=e.displayFormats,r=i[e.unit]||i.millisecond,s=this._tickFormatFunction(t,0,sO(this,[t],this._majorUnit),r),n=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/n.w:this.height/n.h)-1;return a>0?a:1}getDataTimestamps(){let t,e,i=this._cache.data||[];if(i.length)return i;let r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(t=0,e=r.length;t<e;++t)i=i.concat(r[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(i)}getLabelTimestamps(){let t,e,i=this._cache.labels||[];if(i.length)return i;let r=this.getLabels();for(t=0,e=r.length;t<e;++t)i.push(sS(this,r[t]));return this._cache.labels=this._normalized?i:this.normalize(i)}normalize(t){return tR(t.sort(sk))}}function sR(t,e,i){let r,s,n,a,o=0,l=t.length-1;i?(e>=t[o].pos&&e<=t[l].pos&&({lo:o,hi:l}=tE(t,"pos",e)),{pos:r,time:n}=t[o],{pos:s,time:a}=t[l]):(e>=t[o].time&&e<=t[l].time&&({lo:o,hi:l}=tE(t,"time",e)),{time:r,pos:n}=t[o],{time:s,pos:a}=t[l]);let h=s-r;return h?n+(a-n)*(e-r)/h:n}class sP extends sA{static id="timeseries";static defaults=sA.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){let t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=sR(e,this.min),this._tableRange=sR(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){let e,i,r,{min:s,max:n}=this,a=[],o=[];for(e=0,i=t.length;e<i;++e)(r=t[e])>=s&&r<=n&&a.push(r);if(a.length<2)return[{time:s,pos:0},{time:n,pos:1}];for(e=0,i=a.length;e<i;++e)Math.round((a[e+1]+a[e-1])/2)!==(r=a[e])&&o.push({time:r,pos:e/(i-1)});return o}_generate(){let t=this.min,e=this.max,i=super.getDataTimestamps();return i.includes(t)&&i.length||i.splice(0,0,t),i.includes(e)&&1!==i.length||i.push(e),i.sort((t,e)=>t-e)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;let e=this.getDataTimestamps(),i=this.getLabelTimestamps();return t=e.length&&i.length?this.normalize(e.concat(i)):e.length?e:i,t=this._cache.all=t}getDecimalForValue(t){return(sR(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){let e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return sR(this._table,i*this._tableRange+this._minPos,!0)}}t.s(["BarController",()=>il,"BubbleController",()=>ih,"CategoryScale",()=>sl,"Chart",()=>r_,"DoughnutController",()=>iu,"Filler",()=>rZ,"Legend",()=>r2,"LineController",()=>ic,"LineElement",()=>rC,"LinearScale",()=>sc,"PieController",()=>ip,"PointElement",()=>rD,"PolarAreaController",()=>id,"RadarController",()=>ig,"ScatterController",()=>im,"Title",()=>r8,"Tooltip",()=>sa],29530);let sC="label";function sM(t,e){"function"==typeof t?t(e):t&&(t.current=e)}function sD(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:sC,r=[];t.datasets=e.map(e=>{let s=t.datasets.find(t=>t[i]===e[i]);return!s||!e.data||r.includes(s)?{...e}:(r.push(s),Object.assign(s,e),s)})}let sI=(0,r.forwardRef)(function(t,e){let{height:i=150,width:s=300,redraw:n=!1,datasetIdKey:a,type:o,data:l,options:h,plugins:u=[],fallbackContent:c,updateMode:d,...f}=t,p=(0,r.useRef)(null),g=(0,r.useRef)(),m=()=>{p.current&&(g.current=new r_(p.current,{type:o,data:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sC,i={labels:[],datasets:[]};return i.labels=t.labels,sD(i,t.datasets,e),i}(l,a),options:h&&{...h},plugins:u}),sM(e,g.current))},b=()=>{sM(e,null),g.current&&(g.current.destroy(),g.current=null)};return(0,r.useEffect)(()=>{var t;let e;!n&&g.current&&h&&(t=g.current,(e=t.options)&&h&&Object.assign(e,h))},[n,h]),(0,r.useEffect)(()=>{!n&&g.current&&(g.current.config.data.labels=l.labels)},[n,l.labels]),(0,r.useEffect)(()=>{!n&&g.current&&l.datasets&&sD(g.current.config.data,l.datasets,a)},[n,l.datasets]),(0,r.useEffect)(()=>{g.current&&(n?(b(),setTimeout(m)):g.current.update(d))},[n,h,l.labels,l.datasets,d]),(0,r.useEffect)(()=>{g.current&&(b(),setTimeout(m))},[o]),(0,r.useEffect)(()=>(m(),()=>b()),[]),r.default.createElement("canvas",Object.assign({ref:p,role:"img",height:i,width:s},f),c)}),sj=(r_.register(ic),(0,r.forwardRef)((t,e)=>r.default.createElement(sI,Object.assign({},t,{ref:e,type:"line"}))));t.s(["Line",()=>sj],81097)},30592,t=>{"use strict";t.s(["DYNAMICS",0,[{id:"101",entityId:"1",title:"Starlink IPO Rumors Intensify",summary:"Market analysts predict a spinoff by Q4 2025, driving huge volume in space-tech ETFs.",source:"Bloomberg",timestamp:"2024-05-20T10:00:00Z",sentiment:"positive",url:"#"},{id:"102",entityId:"4",title:"EU Tariffs on Chinese EVs",summary:"New regulations may impact profit margins for outbound brands like BYD and Nio.",source:"Reuters",timestamp:"2024-05-20T09:30:00Z",sentiment:"negative",url:"#"},{id:"103",entityId:"2",title:"Trump Media Announces New Platform",summary:"Truth Social integration with crypto payments is being tested.",source:"TechCrunch",timestamp:"2024-05-19T14:00:00Z",sentiment:"positive",url:"#"},{id:"104",entityId:"5",title:"Supply Chain Audits Hit Fast Fashion",summary:"Major crackdown on sustainability claims affecting stock prices.",source:"Vogue Business",timestamp:"2024-05-19T11:15:00Z",sentiment:"negative",url:"#"}],"ENTITIES",0,[{id:"1",slug:"elon-musk",name:"Elon Musk",type:"person",heatIndex:98,trend:5.2,sentiment:"neutral",tags:["Tesla","SpaceX","X"],stockSymbol:"TSLA"},{id:"2",slug:"donald-trump",name:"Donald Trump",type:"person",heatIndex:95,trend:12.1,sentiment:"positive",tags:["Politics","Media","Real Estate"],stockSymbol:"DJT"},{id:"3",slug:"mark-zuckerberg",name:"Mark Zuckerberg",type:"person",heatIndex:88,trend:-1.5,sentiment:"neutral",tags:["Meta","VR","AI"],stockSymbol:"META"},{id:"4",slug:"ev-market",name:"Electric Vehicles",type:"category",heatIndex:92,trend:3.4,sentiment:"positive",tags:["Battery","China","Export"]},{id:"5",slug:"fast-fashion",name:"Fast Fashion",type:"category",heatIndex:85,trend:-.8,sentiment:"negative",tags:["Shein","Temu","Supply Chain"]}],"generateTrendData",0,()=>({labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],datasets:[{label:"Elon Musk",data:[85,88,87,92,95,94,98],borderColor:"#00f3ff",backgroundColor:"rgba(0, 243, 255, 0.1)",tension:.4},{label:"EV Market",data:[70,72,75,80,85,88,92],borderColor:"#bd00ff",backgroundColor:"rgba(189, 0, 255, 0.1)",tension:.4}]})])},7866,t=>{"use strict";var e=t.i(43476),i=t.i(29530),r=t.i(81097),s=t.i(30592);function n({data:t}){let i=(0,s.generateTrendData)();return(0,e.jsx)("div",{className:"h-[300px] w-full",children:(0,e.jsx)(r.Line,{options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"#e2e8f0",font:{family:"Inter"}}},tooltip:{backgroundColor:"rgba(2, 6, 23, 0.9)",titleColor:"#00f3ff",bodyColor:"#fff",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,padding:10,displayColors:!1}},scales:{y:{grid:{color:"rgba(255, 255, 255, 0.05)"},ticks:{color:"#94a3b8"}},x:{grid:{display:!1},ticks:{color:"#94a3b8"}}}},data:i})})}i.Chart.register(i.CategoryScale,i.LinearScale,i.PointElement,i.LineElement,i.Title,i.Tooltip,i.Legend,i.Filler),t.s(["default",()=>n])},16015,(t,e,i)=>{},55838,(t,e,i)=>{"use strict";var r=t.r(71645),s="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},n=r.useState,a=r.useEffect,o=r.useLayoutEffect,l=r.useDebugValue;function h(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!s(t,i)}catch(t){return!0}}var u="u"<typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,e){var i=e(),r=n({inst:{value:i,getSnapshot:e}}),s=r[0].inst,u=r[1];return o(function(){s.value=i,s.getSnapshot=e,h(s)&&u({inst:s})},[t,i,e]),a(function(){return h(s)&&u({inst:s}),t(function(){h(s)&&u({inst:s})})},[t]),l(i),i};i.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},2239,(t,e,i)=>{"use strict";e.exports=t.r(55838)},80328,t=>{"use strict";let e;t.i(16015);var i=t.i(71645),r=t.i(2239);let s=()=>{},n=s(),a=Object,o=t=>t===n,l=(t,e)=>({...t,...e}),h=new WeakMap,u=0,c=t=>{let e,i,r=typeof t,s=t&&t.constructor,n=s==Date;if(a(t)!==t||n||s==RegExp)e=n?t.toJSON():"symbol"==r?t.toString():"string"==r?JSON.stringify(t):""+t;else{if(e=h.get(t))return e;if(e=++u+"~",h.set(t,e),s==Array){for(i=0,e="@";i<t.length;i++)e+=c(t[i])+",";h.set(t,e)}if(s==a){e="#";let r=a.keys(t).sort();for(;!o(i=r.pop());)o(t[i])||(e+=i+":"+c(t[i])+",");h.set(t,e)}}return e},d=new WeakMap,f={},p={},g="undefined",m=typeof window!=g,b=typeof document!=g,y=(t,e)=>{let i=d.get(t);return[()=>!o(e)&&t.get(e)||f,r=>{if(!o(e)){let s=t.get(e);e in p||(p[e]=s),i[5](e,l(s,r),s||f)}},i[6],()=>!o(e)&&e in p?p[e]:!o(e)&&t.get(e)||f]},_=!0,[w,v]=m&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[s,s],x={initFocus:t=>(b&&document.addEventListener("visibilitychange",t),w("focus",t),()=>{b&&document.removeEventListener("visibilitychange",t),v("focus",t)}),initReconnect:t=>{let e=()=>{_=!0,t()},i=()=>{_=!1};return w("online",e),w("offline",i),()=>{v("online",e),v("offline",i)}}},k=!i.default.useId,S=!m||"Deno"in window,E=S?i.useEffect:i.useLayoutEffect,T="u">typeof navigator&&navigator.connection,O=!S&&T&&(["slow-2g","2g"].includes(T.effectiveType)||T.saveData),A=t=>{if("function"==typeof t)try{t=t()}catch(e){t=""}let e=t;return[t="string"==typeof t?t:(Array.isArray(t)?t.length:t)?c(t):"",e]},R=0,P=()=>++R;async function C(...t){let[e,i,r,s]=t,a=l({populateCache:!0,throwOnError:!0},"boolean"==typeof s?{revalidate:s}:s||{}),h=a.populateCache,u=a.rollbackOnError,c=a.optimisticData,f=!1!==a.revalidate,p=a.throwOnError;if("function"==typeof i){let t=[];for(let r of e.keys())!/^\$(inf|sub)\$/.test(r)&&i(e.get(r)._k)&&t.push(r);return Promise.all(t.map(g))}return g(i);async function g(i){let s,[a]=A(i);if(!a)return;let[l,g]=y(e,a),[m,b,_,w]=d.get(e),v=()=>{let t=m[a];return f&&(delete _[a],delete w[a],t&&t[0])?t[0](2).then(()=>l().data):l().data};if(t.length<3)return v();let x=r,k=P();b[a]=[k,0];let S=!o(c),E=l(),T=E.data,O=E._c,R=o(O)?T:O;if(S&&g({data:c="function"==typeof c?c(R,T):c,_c:R}),"function"==typeof x)try{x=x(R)}catch(t){s=t}if(x&&"function"==typeof x.then){let t;if(x=await x.catch(t=>{s=t}),k!==b[a][0]){if(s)throw s;return x}s&&S&&(t=s,"function"==typeof u?u(t):!1!==u)&&(h=!0,g({data:R,_c:n}))}if(h&&!s&&("function"==typeof h?g({data:h(x,R),error:n,_c:n}):g({data:x,error:n,_c:n})),b[a][1]=P(),Promise.resolve(v()).then(()=>{g({_c:n})}),s){if(p)throw s;return}return x}}let M=(t,e)=>{for(let i in t)t[i][0]&&t[i][0](e)},D=(t,e)=>{if(!d.has(t)){let i=l(x,e),r={},a=C.bind(n,t),o=s,h={},u=(t,e)=>{let i=h[t]||[];return h[t]=i,i.push(e),()=>i.splice(i.indexOf(e),1)},c=(e,i,r)=>{t.set(e,i);let s=h[e];if(s)for(let t of s)t(i,r)},f=()=>{if(!d.has(t)&&(d.set(t,[r,{},{},{},a,c,u]),!S)){let e=i.initFocus(setTimeout.bind(n,M.bind(n,r,0))),s=i.initReconnect(setTimeout.bind(n,M.bind(n,r,1)));o=()=>{e&&e(),s&&s(),d.delete(t)}}};return f(),[t,a,f,o]}return[t,d.get(t)[4]]},[I,j]=D(new Map),L=l({onLoadingSlow:s,onSuccess:s,onError:s,onErrorRetry:(t,e,i,r,s)=>{let n=i.errorRetryCount,a=s.retryCount,l=~~((Math.random()+.5)*(1<<(a<8?a:8)))*i.errorRetryInterval;(o(n)||!(a>n))&&setTimeout(r,l,s)},onDiscarded:s,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:O?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:O?5e3:3e3,compare:(t,e)=>c(t)==c(e),isPaused:()=>!1,cache:I,mutate:j,fallback:{}},{isOnline:()=>_,isVisible:()=>{let t=b&&document.visibilityState;return o(t)||"hidden"!==t}}),$=(t,e)=>{let i=l(t,e);if(e){let{use:r,fallback:s}=t,{use:n,fallback:a}=e;r&&n&&(i.use=r.concat(n)),s&&a&&(i.fallback=l(s,a))}return i},B=(0,i.createContext)({}),N=m&&window.__SWR_DEVTOOLS_USE__,U=(N?window.__SWR_DEVTOOLS_USE__:[]).concat(t=>(e,i,r)=>{let s=i&&((...t)=>{let[r]=A(e),[,,,s]=d.get(I);if(r.startsWith("$inf$"))return i(...t);let n=s[r];return o(n)?i(...t):(delete s[r],n)});return t(e,s,r)});N&&(window.__SWR_DEVTOOLS_REACT__=i.default);let F=i.default.use||(t=>{if("pending"===t.status)throw t;if("fulfilled"===t.status)return t.value;if("rejected"===t.status)throw t.reason;throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}),z={dedupe:!0};a.defineProperty(t=>{let{value:e}=t,r=(0,i.useContext)(B),s="function"==typeof e,a=(0,i.useMemo)(()=>s?e(r):e,[s,r,e]),o=(0,i.useMemo)(()=>s?a:$(r,a),[s,r,a]),h=a&&a.provider,u=(0,i.useRef)(n);h&&!u.current&&(u.current=D(h(o.cache||I),a));let c=u.current;return c&&(o.cache=c[0],o.mutate=c[1]),E(()=>{if(c)return c[2]&&c[2](),c[3]},[]),(0,i.createElement)(B.Provider,l(t,{value:o}))},"defaultValue",{value:L});let V=(e=(t,e,s)=>{let{cache:a,compare:h,suspense:u,fallbackData:c,revalidateOnMount:f,revalidateIfStale:p,refreshInterval:b,refreshWhenHidden:_,refreshWhenOffline:w,keepPreviousData:v}=s,[x,T,O,R]=d.get(a),[M,D]=A(t),I=(0,i.useRef)(!1),j=(0,i.useRef)(!1),L=(0,i.useRef)(M),$=(0,i.useRef)(e),B=(0,i.useRef)(s),N=()=>B.current.isVisible()&&B.current.isOnline(),[U,V,W,H]=y(a,M),q=(0,i.useRef)({}).current,K=o(c)?s.fallback[M]:c,J=(t,e)=>{for(let i in q)if("data"===i){if(!h(t[i],e[i])&&(!o(t[i])||!h(tr,e[i])))return!1}else if(e[i]!==t[i])return!1;return!0},G=(0,i.useMemo)(()=>{let t=!!M&&!!e&&(o(f)?!B.current.isPaused()&&!u&&(!!o(p)||p):f),i=e=>{let i=l(e);return(delete i._k,t)?{isValidating:!0,isLoading:!0,...i}:i},r=U(),s=H(),n=i(r),a=r===s?n:i(s),h=n;return[()=>{let t=i(U());return J(t,h)?(h.data=t.data,h.isLoading=t.isLoading,h.isValidating=t.isValidating,h.error=t.error,h):(h=t,t)},()=>a]},[a,M]),Y=(0,r.useSyncExternalStore)((0,i.useCallback)(t=>W(M,(e,i)=>{J(i,e)||t()}),[a,M]),G[0],G[1]),X=!I.current,Z=x[M]&&x[M].length>0,Q=Y.data,tt=o(Q)?K:Q,te=Y.error,ti=(0,i.useRef)(tt),tr=v?o(Q)?ti.current:Q:tt,ts=(!Z||!!o(te))&&(X&&!o(f)?f:!B.current.isPaused()&&(u?!o(tt)&&p:o(tt)||p)),tn=!!(M&&e&&X&&ts),ta=o(Y.isValidating)?tn:Y.isValidating,to=o(Y.isLoading)?tn:Y.isLoading,tl=(0,i.useCallback)(async t=>{let e,i,r=$.current;if(!M||!r||j.current||B.current.isPaused())return!1;let a=!0,l=t||{},u=!O[M]||!l.dedupe,c=()=>k?!j.current&&M===L.current&&I.current:M===L.current,d={isValidating:!1,isLoading:!1},f=()=>{V(d)},p=()=>{let t=O[M];t&&t[1]===i&&delete O[M]},g={isValidating:!0};o(U().data)&&(g.isLoading=!0);try{if(u&&(V(g),s.loadingTimeout&&o(U().data)&&setTimeout(()=>{a&&c()&&B.current.onLoadingSlow(M,s)},s.loadingTimeout),O[M]=[r(D),P()]),[e,i]=O[M],e=await e,u&&setTimeout(p,s.dedupingInterval),!O[M]||O[M][1]!==i)return u&&c()&&B.current.onDiscarded(M),!1;d.error=n;let t=T[M];if(!o(t)&&(i<=t[0]||i<=t[1]||0===t[1]))return f(),u&&c()&&B.current.onDiscarded(M),!1;let l=U().data;d.data=h(l,e)?l:e,u&&c()&&B.current.onSuccess(e,M,s)}catch(i){p();let t=B.current,{shouldRetryOnError:e}=t;!t.isPaused()&&(d.error=i,u&&c())&&(t.onError(i,M,t),(!0===e||"function"==typeof e&&e(i))&&N()&&t.onErrorRetry(i,M,t,t=>{let e=x[M];e&&e[0]&&e[0](3,t)},{retryCount:(l.retryCount||0)+1,dedupe:!0}))}return a=!1,f(),!0},[M,a]),th=(0,i.useCallback)((...t)=>C(a,L.current,...t),[]);if(E(()=>{$.current=e,B.current=s,o(Q)||(ti.current=Q)}),E(()=>{var t;let e;if(!M)return;let i=tl.bind(n,z),r=0,s=(t=(t,e={})=>{if(0==t){let t=Date.now();B.current.revalidateOnFocus&&t>r&&N()&&(r=t+B.current.focusThrottleInterval,i())}else if(1==t)B.current.revalidateOnReconnect&&N()&&i();else if(2==t)return tl();else if(3==t)return tl(e)},(e=x[M]||(x[M]=[])).push(t),()=>{let i=e.indexOf(t);i>=0&&(e[i]=e[e.length-1],e.pop())});if(j.current=!1,L.current=M,I.current=!0,V({_k:D}),ts)if(o(tt)||S)i();else m&&typeof window.requestAnimationFrame!=g?window.requestAnimationFrame(i):setTimeout(i,1);return()=>{j.current=!0,s()}},[M]),E(()=>{let t;function e(){let e="function"==typeof b?b(U().data):b;e&&-1!==t&&(t=setTimeout(i,e))}function i(){!U().error&&(_||B.current.isVisible())&&(w||B.current.isOnline())?tl(z).then(e):e()}return e(),()=>{t&&(clearTimeout(t),t=-1)}},[b,_,w,M]),(0,i.useDebugValue)(tr),u&&o(tt)&&M){if(!k&&S)throw Error("Fallback data is required when using suspense in SSR.");$.current=e,B.current=s,j.current=!1;let t=R[M];if(o(t)||F(th(t)),o(te)){let t=tl(z);o(tr)||(t.status="fulfilled",t.value=!0),F(t)}else throw te}return{mutate:th,get data(){return q.data=!0,tr},get error(){return q.error=!0,te},get isValidating(){return q.isValidating=!0,ta},get isLoading(){return q.isLoading=!0,to}}},function(...t){let r=l(L,(0,i.useContext)(B)),[s,n,a]="function"==typeof t[1]?[t[0],t[1],t[2]||{}]:[t[0],null,(null===t[1]?t[2]:t[1])||{}],o=$(r,a),h=e,{use:u}=o,c=(u||[]).concat(U);for(let t=c.length;t--;)h=c[t](h);return h(s,n||o.fetcher||null,o)});t.s(["default",()=>V],80328)},67034,(t,e,i)=>{var r={675:function(t,e){"use strict";e.byteLength=function(t){var e=l(t),i=e[0],r=e[1];return(i+r)*3/4-r},e.toByteArray=function(t){var e,i,n=l(t),a=n[0],o=n[1],h=new s((a+o)*3/4-o),u=0,c=o>0?a-4:a;for(i=0;i<c;i+=4)e=r[t.charCodeAt(i)]<<18|r[t.charCodeAt(i+1)]<<12|r[t.charCodeAt(i+2)]<<6|r[t.charCodeAt(i+3)],h[u++]=e>>16&255,h[u++]=e>>8&255,h[u++]=255&e;return 2===o&&(e=r[t.charCodeAt(i)]<<2|r[t.charCodeAt(i+1)]>>4,h[u++]=255&e),1===o&&(e=r[t.charCodeAt(i)]<<10|r[t.charCodeAt(i+1)]<<4|r[t.charCodeAt(i+2)]>>2,h[u++]=e>>8&255,h[u++]=255&e),h},e.fromByteArray=function(t){for(var e,r=t.length,s=r%3,n=[],a=0,o=r-s;a<o;a+=16383)n.push(function(t,e,r){for(var s,n=[],a=e;a<r;a+=3)s=(t[a]<<16&0xff0000)+(t[a+1]<<8&65280)+(255&t[a+2]),n.push(i[s>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return n.join("")}(t,a,a+16383>o?o:a+16383));return 1===s?n.push(i[(e=t[r-1])>>2]+i[e<<4&63]+"=="):2===s&&n.push(i[(e=(t[r-2]<<8)+t[r-1])>>10]+i[e>>4&63]+i[e<<2&63]+"="),n.join("")};for(var i=[],r=[],s="u">typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,o=n.length;a<o;++a)i[a]=n[a],r[n.charCodeAt(a)]=a;function l(t){var e=t.length;if(e%4>0)throw Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");-1===i&&(i=e);var r=i===e?0:4-i%4;return[i,r]}r[45]=62,r[95]=63},72:function(t,e,i){"use strict";var r=i(675),s=i(783),n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function a(t){if(t>0x7fffffff)throw RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,o.prototype),e}function o(t,e,i){if("number"==typeof t){if("string"==typeof e)throw TypeError('The "string" argument must be of type string. Received type number');return u(t)}return l(t,e,i)}function l(t,e,i){if("string"==typeof t){var r=t,s=e;if(("string"!=typeof s||""===s)&&(s="utf8"),!o.isEncoding(s))throw TypeError("Unknown encoding: "+s);var n=0|f(r,s),l=a(n),h=l.write(r,s);return h!==n&&(l=l.slice(0,h)),l}if(ArrayBuffer.isView(t))return c(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(R(t,ArrayBuffer)||t&&R(t.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(R(t,SharedArrayBuffer)||t&&R(t.buffer,SharedArrayBuffer)))return function(t,e,i){var r;if(e<0||t.byteLength<e)throw RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(i||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===e&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,e):new Uint8Array(t,e,i),o.prototype),r}(t,e,i);if("number"==typeof t)throw TypeError('The "value" argument must not be of type number. Received type number');var u=t.valueOf&&t.valueOf();if(null!=u&&u!==t)return o.from(u,e,i);var p=function(t){if(o.isBuffer(t)){var e=0|d(t.length),i=a(e);return 0===i.length||t.copy(i,0,0,e),i}return void 0!==t.length?"number"!=typeof t.length||function(t){return t!=t}(t.length)?a(0):c(t):"Buffer"===t.type&&Array.isArray(t.data)?c(t.data):void 0}(t);if(p)return p;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return o.from(t[Symbol.toPrimitive]("string"),e,i);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function h(t){if("number"!=typeof t)throw TypeError('"size" argument must be of type number');if(t<0)throw RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return h(t),a(t<0?0:0|d(t))}function c(t){for(var e=t.length<0?0:0|d(t.length),i=a(e),r=0;r<e;r+=1)i[r]=255&t[r];return i}e.Buffer=o,e.SlowBuffer=function(t){return+t!=t&&(t=0),o.alloc(+t)},e.INSPECT_MAX_BYTES=50,e.kMaxLength=0x7fffffff,o.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),!o.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(t,e,i){return l(t,e,i)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(t,e,i){return(h(t),t<=0)?a(t):void 0!==e?"string"==typeof i?a(t).fill(e,i):a(t).fill(e):a(t)},o.allocUnsafe=function(t){return u(t)},o.allocUnsafeSlow=function(t){return u(t)};function d(t){if(t>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|t}function f(t,e){if(o.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||R(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var i=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===i)return 0;for(var s=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return E(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return O(t).length;default:if(s)return r?-1:E(t).length;e=(""+e).toLowerCase(),s=!0}}function p(t,e,i){var s,n,a,o=!1;if((void 0===e||e<0)&&(e=0),e>this.length||((void 0===i||i>this.length)&&(i=this.length),i<=0||(i>>>=0)<=(e>>>=0)))return"";for(t||(t="utf8");;)switch(t){case"hex":return function(t,e,i){var r=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>r)&&(i=r);for(var s="",n=e;n<i;++n)s+=P[t[n]];return s}(this,e,i);case"utf8":case"utf-8":return y(this,e,i);case"ascii":return function(t,e,i){var r="";i=Math.min(t.length,i);for(var s=e;s<i;++s)r+=String.fromCharCode(127&t[s]);return r}(this,e,i);case"latin1":case"binary":return function(t,e,i){var r="";i=Math.min(t.length,i);for(var s=e;s<i;++s)r+=String.fromCharCode(t[s]);return r}(this,e,i);case"base64":return s=this,n=e,a=i,0===n&&a===s.length?r.fromByteArray(s):r.fromByteArray(s.slice(n,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,i){for(var r=t.slice(e,i),s="",n=0;n<r.length;n+=2)s+=String.fromCharCode(r[n]+256*r[n+1]);return s}(this,e,i);default:if(o)throw TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),o=!0}}function g(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function m(t,e,i,r,s){var n;if(0===t.length)return -1;if("string"==typeof i?(r=i,i=0):i>0x7fffffff?i=0x7fffffff:i<-0x80000000&&(i=-0x80000000),(n=i*=1)!=n&&(i=s?0:t.length-1),i<0&&(i=t.length+i),i>=t.length)if(s)return -1;else i=t.length-1;else if(i<0)if(!s)return -1;else i=0;if("string"==typeof e&&(e=o.from(e,r)),o.isBuffer(e))return 0===e.length?-1:b(t,e,i,r,s);if("number"==typeof e){if(e&=255,"function"==typeof Uint8Array.prototype.indexOf)if(s)return Uint8Array.prototype.indexOf.call(t,e,i);else return Uint8Array.prototype.lastIndexOf.call(t,e,i);return b(t,[e],i,r,s)}throw TypeError("val must be string, number or Buffer")}function b(t,e,i,r,s){var n,a=1,o=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return -1;a=2,o/=2,l/=2,i/=2}function h(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(s){var u=-1;for(n=i;n<o;n++)if(h(t,n)===h(e,-1===u?0:n-u)){if(-1===u&&(u=n),n-u+1===l)return u*a}else -1!==u&&(n-=n-u),u=-1}else for(i+l>o&&(i=o-l),n=i;n>=0;n--){for(var c=!0,d=0;d<l;d++)if(h(t,n+d)!==h(e,d)){c=!1;break}if(c)return n}return -1}o.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==o.prototype},o.compare=function(t,e){if(R(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),R(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(t)||!o.isBuffer(e))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var i=t.length,r=e.length,s=0,n=Math.min(i,r);s<n;++s)if(t[s]!==e[s]){i=t[s],r=e[s];break}return i<r?-1:+(r<i)},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Array.isArray(t))throw TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);if(void 0===e)for(i=0,e=0;i<t.length;++i)e+=t[i].length;var i,r=o.allocUnsafe(e),s=0;for(i=0;i<t.length;++i){var n=t[i];if(R(n,Uint8Array)&&(n=o.from(n)),!o.isBuffer(n))throw TypeError('"list" argument must be an Array of Buffers');n.copy(r,s),s+=n.length}return r},o.byteLength=f,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},o.prototype.toString=function(){var t=this.length;return 0===t?"":0==arguments.length?y(this,0,t):p.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(t+=" ... "),"<Buffer "+t+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(t,e,i,r,s){if(R(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===r&&(r=0),void 0===s&&(s=this.length),e<0||i>t.length||r<0||s>this.length)throw RangeError("out of range index");if(r>=s&&e>=i)return 0;if(r>=s)return -1;if(e>=i)return 1;if(e>>>=0,i>>>=0,r>>>=0,s>>>=0,this===t)return 0;for(var n=s-r,a=i-e,l=Math.min(n,a),h=this.slice(r,s),u=t.slice(e,i),c=0;c<l;++c)if(h[c]!==u[c]){n=h[c],a=u[c];break}return n<a?-1:+(a<n)},o.prototype.includes=function(t,e,i){return -1!==this.indexOf(t,e,i)},o.prototype.indexOf=function(t,e,i){return m(this,t,e,i,!0)},o.prototype.lastIndexOf=function(t,e,i){return m(this,t,e,i,!1)};function y(t,e,i){i=Math.min(t.length,i);for(var r=[],s=e;s<i;){var n,a,o,l,h=t[s],u=null,c=h>239?4:h>223?3:h>191?2:1;if(s+c<=i)switch(c){case 1:h<128&&(u=h);break;case 2:(192&(n=t[s+1]))==128&&(l=(31&h)<<6|63&n)>127&&(u=l);break;case 3:n=t[s+1],a=t[s+2],(192&n)==128&&(192&a)==128&&(l=(15&h)<<12|(63&n)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:n=t[s+1],a=t[s+2],o=t[s+3],(192&n)==128&&(192&a)==128&&(192&o)==128&&(l=(15&h)<<18|(63&n)<<12|(63&a)<<6|63&o)>65535&&l<1114112&&(u=l)}null===u?(u=65533,c=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),s+=c}var d=r,f=d.length;if(f<=4096)return String.fromCharCode.apply(String,d);for(var p="",g=0;g<f;)p+=String.fromCharCode.apply(String,d.slice(g,g+=4096));return p}function _(t,e,i){if(t%1!=0||t<0)throw RangeError("offset is not uint");if(t+e>i)throw RangeError("Trying to access beyond buffer length")}function w(t,e,i,r,s,n){if(!o.isBuffer(t))throw TypeError('"buffer" argument must be a Buffer instance');if(e>s||e<n)throw RangeError('"value" argument is out of bounds');if(i+r>t.length)throw RangeError("Index out of range")}function v(t,e,i,r,s,n){if(i+r>t.length||i<0)throw RangeError("Index out of range")}function x(t,e,i,r,n){return e*=1,i>>>=0,n||v(t,e,i,4,34028234663852886e22,-34028234663852886e22),s.write(t,e,i,r,23,4),i+4}function k(t,e,i,r,n){return e*=1,i>>>=0,n||v(t,e,i,8,17976931348623157e292,-17976931348623157e292),s.write(t,e,i,r,52,8),i+8}o.prototype.write=function(t,e,i,r){if(void 0===e)r="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)r=e,i=this.length,e=0;else if(isFinite(e))e>>>=0,isFinite(i)?(i>>>=0,void 0===r&&(r="utf8")):(r=i,i=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s,n,a,o,l,h,u,c,d=this.length-e;if((void 0===i||i>d)&&(i=d),t.length>0&&(i<0||e<0)||e>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var f=!1;;)switch(r){case"hex":return function(t,e,i,r){i=Number(i)||0;var s=t.length-i;r?(r=Number(r))>s&&(r=s):r=s;var n=e.length;r>n/2&&(r=n/2);for(var a=0;a<r;++a){var o,l=parseInt(e.substr(2*a,2),16);if((o=l)!=o)break;t[i+a]=l}return a}(this,t,e,i);case"utf8":case"utf-8":return s=e,n=i,A(E(t,this.length-s),this,s,n);case"ascii":return a=e,o=i,A(T(t),this,a,o);case"latin1":case"binary":return function(t,e,i,r){return A(T(e),t,i,r)}(this,t,e,i);case"base64":return l=e,h=i,A(O(t),this,l,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=e,c=i,A(function(t,e){for(var i,r,s=[],n=0;n<t.length&&!((e-=2)<0);++n)r=(i=t.charCodeAt(n))>>8,s.push(i%256),s.push(r);return s}(t,this.length-u),this,u,c);default:if(f)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),f=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.slice=function(t,e){var i=this.length;t=~~t,e=void 0===e?i:~~e,t<0?(t+=i)<0&&(t=0):t>i&&(t=i),e<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t);var r=this.subarray(t,e);return Object.setPrototypeOf(r,o.prototype),r},o.prototype.readUIntLE=function(t,e,i){t>>>=0,e>>>=0,i||_(t,e,this.length);for(var r=this[t],s=1,n=0;++n<e&&(s*=256);)r+=this[t+n]*s;return r},o.prototype.readUIntBE=function(t,e,i){t>>>=0,e>>>=0,i||_(t,e,this.length);for(var r=this[t+--e],s=1;e>0&&(s*=256);)r+=this[t+--e]*s;return r},o.prototype.readUInt8=function(t,e){return t>>>=0,e||_(t,1,this.length),this[t]},o.prototype.readUInt16LE=function(t,e){return t>>>=0,e||_(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUInt16BE=function(t,e){return t>>>=0,e||_(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUInt32LE=function(t,e){return t>>>=0,e||_(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+0x1000000*this[t+3]},o.prototype.readUInt32BE=function(t,e){return t>>>=0,e||_(t,4,this.length),0x1000000*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,i){t>>>=0,e>>>=0,i||_(t,e,this.length);for(var r=this[t],s=1,n=0;++n<e&&(s*=256);)r+=this[t+n]*s;return r>=(s*=128)&&(r-=Math.pow(2,8*e)),r},o.prototype.readIntBE=function(t,e,i){t>>>=0,e>>>=0,i||_(t,e,this.length);for(var r=e,s=1,n=this[t+--r];r>0&&(s*=256);)n+=this[t+--r]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*e)),n},o.prototype.readInt8=function(t,e){return(t>>>=0,e||_(t,1,this.length),128&this[t])?-((255-this[t]+1)*1):this[t]},o.prototype.readInt16LE=function(t,e){t>>>=0,e||_(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?0xffff0000|i:i},o.prototype.readInt16BE=function(t,e){t>>>=0,e||_(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?0xffff0000|i:i},o.prototype.readInt32LE=function(t,e){return t>>>=0,e||_(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return t>>>=0,e||_(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return t>>>=0,e||_(t,4,this.length),s.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t>>>=0,e||_(t,4,this.length),s.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t>>>=0,e||_(t,8,this.length),s.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t>>>=0,e||_(t,8,this.length),s.read(this,t,!1,52,8)},o.prototype.writeUIntLE=function(t,e,i,r){if(t*=1,e>>>=0,i>>>=0,!r){var s=Math.pow(2,8*i)-1;w(this,t,e,i,s,0)}var n=1,a=0;for(this[e]=255&t;++a<i&&(n*=256);)this[e+a]=t/n&255;return e+i},o.prototype.writeUIntBE=function(t,e,i,r){if(t*=1,e>>>=0,i>>>=0,!r){var s=Math.pow(2,8*i)-1;w(this,t,e,i,s,0)}var n=i-1,a=1;for(this[e+n]=255&t;--n>=0&&(a*=256);)this[e+n]=t/a&255;return e+i},o.prototype.writeUInt8=function(t,e,i){return t*=1,e>>>=0,i||w(this,t,e,1,255,0),this[e]=255&t,e+1},o.prototype.writeUInt16LE=function(t,e,i){return t*=1,e>>>=0,i||w(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeUInt16BE=function(t,e,i){return t*=1,e>>>=0,i||w(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeUInt32LE=function(t,e,i){return t*=1,e>>>=0,i||w(this,t,e,4,0xffffffff,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},o.prototype.writeUInt32BE=function(t,e,i){return t*=1,e>>>=0,i||w(this,t,e,4,0xffffffff,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeIntLE=function(t,e,i,r){if(t*=1,e>>>=0,!r){var s=Math.pow(2,8*i-1);w(this,t,e,i,s-1,-s)}var n=0,a=1,o=0;for(this[e]=255&t;++n<i&&(a*=256);)t<0&&0===o&&0!==this[e+n-1]&&(o=1),this[e+n]=(t/a|0)-o&255;return e+i},o.prototype.writeIntBE=function(t,e,i,r){if(t*=1,e>>>=0,!r){var s=Math.pow(2,8*i-1);w(this,t,e,i,s-1,-s)}var n=i-1,a=1,o=0;for(this[e+n]=255&t;--n>=0&&(a*=256);)t<0&&0===o&&0!==this[e+n+1]&&(o=1),this[e+n]=(t/a|0)-o&255;return e+i},o.prototype.writeInt8=function(t,e,i){return t*=1,e>>>=0,i||w(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,i){return t*=1,e>>>=0,i||w(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeInt16BE=function(t,e,i){return t*=1,e>>>=0,i||w(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeInt32LE=function(t,e,i){return t*=1,e>>>=0,i||w(this,t,e,4,0x7fffffff,-0x80000000),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},o.prototype.writeInt32BE=function(t,e,i){return t*=1,e>>>=0,i||w(this,t,e,4,0x7fffffff,-0x80000000),t<0&&(t=0xffffffff+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeFloatLE=function(t,e,i){return x(this,t,e,!0,i)},o.prototype.writeFloatBE=function(t,e,i){return x(this,t,e,!1,i)},o.prototype.writeDoubleLE=function(t,e,i){return k(this,t,e,!0,i)},o.prototype.writeDoubleBE=function(t,e,i){return k(this,t,e,!1,i)},o.prototype.copy=function(t,e,i,r){if(!o.isBuffer(t))throw TypeError("argument should be a Buffer");if(i||(i=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<i&&(r=i),r===i||0===t.length||0===this.length)return 0;if(e<0)throw RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-i&&(r=t.length-e+i);var s=r-i;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,i,r);else if(this===t&&i<e&&e<r)for(var n=s-1;n>=0;--n)t[n+e]=this[n+i];else Uint8Array.prototype.set.call(t,this.subarray(i,r),e);return s},o.prototype.fill=function(t,e,i,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===t.length){var s,n=t.charCodeAt(0);("utf8"===r&&n<128||"latin1"===r)&&(t=n)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<i)throw RangeError("Out of range index");if(i<=e)return this;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(s=e;s<i;++s)this[s]=t;else{var a=o.isBuffer(t)?t:o.from(t,r),l=a.length;if(0===l)throw TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<i-e;++s)this[s+e]=a[s%l]}return this};var S=/[^+/0-9A-Za-z-_]/g;function E(t,e){e=e||1/0;for(var i,r=t.length,s=null,n=[],a=0;a<r;++a){if((i=t.charCodeAt(a))>55295&&i<57344){if(!s){if(i>56319||a+1===r){(e-=3)>-1&&n.push(239,191,189);continue}s=i;continue}if(i<56320){(e-=3)>-1&&n.push(239,191,189),s=i;continue}i=(s-55296<<10|i-56320)+65536}else s&&(e-=3)>-1&&n.push(239,191,189);if(s=null,i<128){if((e-=1)<0)break;n.push(i)}else if(i<2048){if((e-=2)<0)break;n.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;n.push(i>>12|224,i>>6&63|128,63&i|128)}else if(i<1114112){if((e-=4)<0)break;n.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}else throw Error("Invalid code point")}return n}function T(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}function O(t){return r.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(S,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function A(t,e,i,r){for(var s=0;s<r&&!(s+i>=e.length)&&!(s>=t.length);++s)e[s+i]=t[s];return s}function R(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}var P=function(){for(var t="0123456789abcdef",e=Array(256),i=0;i<16;++i)for(var r=16*i,s=0;s<16;++s)e[r+s]=t[i]+t[s];return e}()},783:function(t,e){e.read=function(t,e,i,r,s){var n,a,o=8*s-r-1,l=(1<<o)-1,h=l>>1,u=-7,c=i?s-1:0,d=i?-1:1,f=t[e+c];for(c+=d,n=f&(1<<-u)-1,f>>=-u,u+=o;u>0;n=256*n+t[e+c],c+=d,u-=8);for(a=n&(1<<-u)-1,n>>=-u,u+=r;u>0;a=256*a+t[e+c],c+=d,u-=8);if(0===n)n=1-h;else{if(n===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),n-=h}return(f?-1:1)*a*Math.pow(2,n-r)},e.write=function(t,e,i,r,s,n){var a,o,l,h=8*n-s-1,u=(1<<h)-1,c=u>>1,d=5960464477539062e-23*(23===s),f=r?0:n-1,p=r?1:-1,g=+(e<0||0===e&&1/e<0);for(isNaN(e=Math.abs(e))||e===1/0?(o=+!!isNaN(e),a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+c>=1?e+=d/l:e+=d*Math.pow(2,1-c),e*l>=2&&(a++,l/=2),a+c>=u?(o=0,a=u):a+c>=1?(o=(e*l-1)*Math.pow(2,s),a+=c):(o=e*Math.pow(2,c-1)*Math.pow(2,s),a=0));s>=8;t[i+f]=255&o,f+=p,o/=256,s-=8);for(a=a<<s|o,h+=s;h>0;t[i+f]=255&a,f+=p,a/=256,h-=8);t[i+f-p]|=128*g}}},s={};function n(t){var e=s[t];if(void 0!==e)return e.exports;var i=s[t]={exports:{}},a=!0;try{r[t](i,i.exports,n),a=!1}finally{a&&delete s[t]}return i.exports}n.ab="/ROOT/node_modules/next/dist/compiled/buffer/",e.exports=n(72)},53210,t=>{"use strict";let e;var i,r,s,n,a,o,l,h,u,c,d,f,p,g,m,b,y,_,w,v,x,k=t.i(47167);class S extends Error{constructor(t,e="FunctionsError",i){super(t),this.name=e,this.context=i}}class E extends S{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class T extends S{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class O extends S{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}(i=d||(d={})).Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2";var A=t.i(90571);class R{constructor(t,{headers:e={},customFetch:i,region:r=d.Any}={}){this.url=t,this.headers=e,this.region=r,this.fetch=(t=>t?(...e)=>t(...e):(...t)=>fetch(...t))(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return(0,A.__awaiter)(this,arguments,void 0,function*(t,e={}){var i;let r,s;try{let n,{headers:a,method:o,body:l,signal:h,timeout:u}=e,c={},{region:d}=e;d||(d=this.region);let f=new URL(`${this.url}/${t}`);d&&"any"!==d&&(c["x-region"]=d,f.searchParams.set("forceFunctionRegion",d)),l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?"u">typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",n=l):"string"==typeof l?(c["Content-Type"]="text/plain",n=l):"u">typeof FormData&&l instanceof FormData?n=l:(c["Content-Type"]="application/json",n=JSON.stringify(l)):n=!l||"string"==typeof l||"u">typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer||"u">typeof FormData&&l instanceof FormData?l:JSON.stringify(l);let p=h;u&&(s=new AbortController,r=setTimeout(()=>s.abort(),u),h?(p=s.signal,h.addEventListener("abort",()=>s.abort())):p=s.signal);let g=yield this.fetch(f.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:n,signal:p}).catch(t=>{throw new E(t)}),m=g.headers.get("x-relay-error");if(m&&"true"===m)throw new T(g);if(!g.ok)throw new O(g);let b=(null!=(i=g.headers.get("Content-Type"))?i:"text/plain").split(";")[0].trim();return{data:"application/json"===b?yield g.json():"application/octet-stream"===b||"application/pdf"===b?yield g.blob():"text/event-stream"===b?g:"multipart/form-data"===b?yield g.formData():yield g.text(),error:null,response:g}}catch(t){return{data:null,error:t,response:t instanceof O||t instanceof T?t.context:void 0}}finally{r&&clearTimeout(r)}})}}var P=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},C=class{constructor(t){var e,i;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=null!=(e=t.shouldThrowOnError)&&e,this.signal=t.signal,this.isMaybeSingle=null!=(i=t.isMaybeSingle)&&i,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var i=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async t=>{var e,r,s,n;let a=null,o=null,l=null,h=t.status,u=t.statusText;if(t.ok){if("HEAD"!==i.method){let e=await t.text();""===e||(o="text/csv"===i.headers.get("Accept")||i.headers.get("Accept")&&(null==(s=i.headers.get("Accept"))?void 0:s.includes("application/vnd.pgrst.plan+text"))?e:JSON.parse(e))}let n=null==(e=i.headers.get("Prefer"))?void 0:e.match(/count=(exact|planned|estimated)/),c=null==(r=t.headers.get("content-range"))?void 0:r.split("/");n&&c&&c.length>1&&(l=parseInt(c[1])),i.isMaybeSingle&&"GET"===i.method&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,h=406,u="Not Acceptable"):o=1===o.length?o[0]:null)}else{let e=await t.text();try{a=JSON.parse(e),Array.isArray(a)&&404===t.status&&(o=[],a=null,h=200,u="OK")}catch(i){404===t.status&&""===e?(h=204,u="No Content"):a={message:e}}if(a&&i.isMaybeSingle&&(null==a||null==(n=a.details)?void 0:n.includes("0 rows"))&&(a=null,h=200,u="OK"),a&&i.shouldThrowOnError)throw new P(a)}return{error:a,data:o,count:l,status:h,statusText:u}});return this.shouldThrowOnError||(r=r.catch(t=>{var e,i,r,s,n,a;let o="",l=null==t?void 0:t.cause;if(l){let e=null!=(i=null==l?void 0:l.message)?i:"",a=null!=(r=null==l?void 0:l.code)?r:"";o=`${null!=(s=null==t?void 0:t.name)?s:"FetchError"}: ${null==t?void 0:t.message}

Caused by: ${null!=(n=null==l?void 0:l.name)?n:"Error"}: ${e}`,a&&(o+=` (${a})`),(null==l?void 0:l.stack)&&(o+=`
${l.stack}`)}else o=null!=(a=null==t?void 0:t.stack)?a:"";return{error:{message:`${null!=(e=null==t?void 0:t.name)?e:"FetchError"}: ${null==t?void 0:t.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(t,e)}returns(){return this}overrideTypes(){return this}},M=class extends C{select(t){let e=!1,i=(null!=t?t:"*").split("").map(t=>/\s/.test(t)&&!e?"":('"'===t&&(e=!e),t)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:i,foreignTable:r,referencedTable:s=r}={}){let n=s?`${s}.order`:"order",a=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${void 0===i?"":i?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:i=e}={}){let r=void 0===i?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:i,referencedTable:r=i}={}){let s=void 0===r?"offset":`${r}.offset`,n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(n,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:i=!1,buffers:r=!1,wal:s=!1,format:n="text"}={}){var a;let o=[t?"analyze":null,e?"verbose":null,i?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=null!=(a=this.headers.get("Accept"))?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${n}; for="${l}"; options=${o};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};let D=RegExp("[,()]");var I=class extends M{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){let i=Array.from(new Set(e)).map(t=>"string"==typeof t&&D.test(t)?`"${t}"`:`${t}`).join(",");return this.url.searchParams.append(t,`in.(${i})`),this}notIn(t,e){let i=Array.from(new Set(e)).map(t=>"string"==typeof t&&D.test(t)?`"${t}"`:`${t}`).join(",");return this.url.searchParams.append(t,`not.in.(${i})`),this}contains(t,e){return"string"==typeof e?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return"string"==typeof e?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return"string"==typeof e?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:i,type:r}={}){let s="";"plain"===r?s="pl":"phrase"===r?s="ph":"websearch"===r&&(s="w");let n=void 0===i?"":`(${i})`;return this.url.searchParams.append(t,`${s}fts${n}.${e}`),this}match(t){return Object.entries(t).forEach(([t,e])=>{this.url.searchParams.append(t,`eq.${e}`)}),this}not(t,e,i){return this.url.searchParams.append(t,`not.${e}.${i}`),this}or(t,{foreignTable:e,referencedTable:i=e}={}){let r=i?`${i}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,i){return this.url.searchParams.append(t,`${e}.${i}`),this}},j=class{constructor(t,{headers:e={},schema:i,fetch:r}){this.url=t,this.headers=new Headers(e),this.schema=i,this.fetch=r}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){let{head:i=!1,count:r}=null!=e?e:{},s=!1,n=(null!=t?t:"*").split("").map(t=>/\s/.test(t)&&!s?"":('"'===t&&(s=!s),t)).join(""),{url:a,headers:o}=this.cloneRequestState();return a.searchParams.set("select",n),r&&o.append("Prefer",`count=${r}`),new I({method:i?"HEAD":"GET",url:a,headers:o,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:i=!0}={}){var r;let{url:s,headers:n}=this.cloneRequestState();if(e&&n.append("Prefer",`count=${e}`),i||n.append("Prefer","missing=default"),Array.isArray(t)){let e=t.reduce((t,e)=>t.concat(Object.keys(e)),[]);if(e.length>0){let t=[...new Set(e)].map(t=>`"${t}"`);s.searchParams.set("columns",t.join(","))}}return new I({method:"POST",url:s,headers:n,schema:this.schema,body:t,fetch:null!=(r=this.fetch)?r:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:i=!1,count:r,defaultToNull:s=!0}={}){var n;let{url:a,headers:o}=this.cloneRequestState();if(o.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),void 0!==e&&a.searchParams.set("on_conflict",e),r&&o.append("Prefer",`count=${r}`),s||o.append("Prefer","missing=default"),Array.isArray(t)){let e=t.reduce((t,e)=>t.concat(Object.keys(e)),[]);if(e.length>0){let t=[...new Set(e)].map(t=>`"${t}"`);a.searchParams.set("columns",t.join(","))}}return new I({method:"POST",url:a,headers:o,schema:this.schema,body:t,fetch:null!=(n=this.fetch)?n:fetch})}update(t,{count:e}={}){var i;let{url:r,headers:s}=this.cloneRequestState();return e&&s.append("Prefer",`count=${e}`),new I({method:"PATCH",url:r,headers:s,schema:this.schema,body:t,fetch:null!=(i=this.fetch)?i:fetch})}delete({count:t}={}){var e;let{url:i,headers:r}=this.cloneRequestState();return t&&r.append("Prefer",`count=${t}`),new I({method:"DELETE",url:i,headers:r,schema:this.schema,fetch:null!=(e=this.fetch)?e:fetch})}},L=class t{constructor(t,{headers:e={},schema:i,fetch:r}={}){this.url=t,this.headers=new Headers(e),this.schemaName=i,this.fetch=r}from(t){if(!t||"string"!=typeof t||""===t.trim())throw Error("Invalid relation name: relation must be a non-empty string.");return new j(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new t(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(t,e={},{head:i=!1,get:r=!1,count:s}={}){var n;let a,o,l=new URL(`${this.url}/rpc/${t}`),h=t=>null!==t&&"object"==typeof t&&(!Array.isArray(t)||t.some(h)),u=i&&Object.values(e).some(h);u?(a="POST",o=e):i||r?(a=i?"HEAD":"GET",Object.entries(e).filter(([t,e])=>void 0!==e).map(([t,e])=>[t,Array.isArray(e)?`{${e.join(",")}}`:`${e}`]).forEach(([t,e])=>{l.searchParams.append(t,e)})):(a="POST",o=e);let c=new Headers(this.headers);return u?c.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&c.set("Prefer",`count=${s}`),new I({method:a,url:l,headers:c,schema:this.schemaName,body:o,fetch:null!=(n=this.fetch)?n:fetch})}};let $=class{static detectEnvironment(){var e;if("u">typeof WebSocket)return{type:"native",constructor:WebSocket};if("u">typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if(void 0!==t.g.WebSocket)return{type:"native",constructor:t.g.WebSocket};if("u">typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("u">typeof globalThis&&globalThis.EdgeRuntime||"u">typeof navigator&&(null==(e=navigator.userAgent)?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};let i=globalThis.process;if(i){let t=i.versions;if(t&&t.node){let e=parseInt(t.node.replace(/^v/,"").split(".")[0]);return e>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${e} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${e} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let t=this.detectEnvironment();if(t.constructor)return t.constructor;let e=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(e+=`

Suggested solution: ${t.workaround}`),Error(e)}static createWebSocket(t,e){return new(this.getWebSocketConstructor())(t,e)}static isWebSocketSupported(){try{let t=this.detectEnvironment();return"native"===t.type||"ws"===t.type}catch(t){return!1}}},B="1.0.0";(r=f||(f={}))[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed",(s=p||(p={})).closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving",(n=g||(g={})).close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token",(m||(m={})).websocket="websocket",(a=b||(b={})).Connecting="connecting",a.Open="open",a.Closing="closing",a.Closed="closed";class N{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=t?t:[]}encode(t,e){return t.event!==this.BROADCAST_EVENT||t.payload instanceof ArrayBuffer||"string"!=typeof t.payload.event?e(JSON.stringify([t.join_ref,t.ref,t.topic,t.event,t.payload])):e(this._binaryEncodeUserBroadcastPush(t))}_binaryEncodeUserBroadcastPush(t){var e;return this._isArrayBuffer(null==(e=t.payload)?void 0:e.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var e,i;let r=null!=(i=null==(e=t.payload)?void 0:e.payload)?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(t){var e,i;let r=null!=(i=null==(e=t.payload)?void 0:e.payload)?i:{},s=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,s)}_encodeUserBroadcastPush(t,e,i){let r=t.topic,s=null!=(f=t.ref)?f:"",n=null!=(p=t.join_ref)?p:"",a=t.payload.event,o=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},l=0===Object.keys(o).length?"":JSON.stringify(o);if(n.length>255)throw Error(`joinRef length ${n.length} exceeds maximum of 255`);if(s.length>255)throw Error(`ref length ${s.length} exceeds maximum of 255`);if(r.length>255)throw Error(`topic length ${r.length} exceeds maximum of 255`);if(a.length>255)throw Error(`userEvent length ${a.length} exceeds maximum of 255`);if(l.length>255)throw Error(`metadata length ${l.length} exceeds maximum of 255`);let h=this.USER_BROADCAST_PUSH_META_LENGTH+n.length+s.length+r.length+a.length+l.length,u=new ArrayBuffer(this.HEADER_LENGTH+h),c=new DataView(u),d=0;c.setUint8(d++,this.KINDS.userBroadcastPush),c.setUint8(d++,n.length),c.setUint8(d++,s.length),c.setUint8(d++,r.length),c.setUint8(d++,a.length),c.setUint8(d++,l.length),c.setUint8(d++,e),Array.from(n,t=>c.setUint8(d++,t.charCodeAt(0))),Array.from(s,t=>c.setUint8(d++,t.charCodeAt(0))),Array.from(r,t=>c.setUint8(d++,t.charCodeAt(0))),Array.from(a,t=>c.setUint8(d++,t.charCodeAt(0))),Array.from(l,t=>c.setUint8(d++,t.charCodeAt(0)));var f,p,g=new Uint8Array(u.byteLength+i.byteLength);return g.set(new Uint8Array(u),0),g.set(new Uint8Array(i),u.byteLength),g.buffer}decode(t,e){if(this._isArrayBuffer(t))return e(this._binaryDecode(t));if("string"==typeof t){let[i,r,s,n,a]=JSON.parse(t);return e({join_ref:i,ref:r,topic:s,event:n,payload:a})}return e({})}_binaryDecode(t){let e=new DataView(t),i=e.getUint8(0),r=new TextDecoder;if(i===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,e,r)}_decodeUserBroadcast(t,e,i){let r=e.getUint8(1),s=e.getUint8(2),n=e.getUint8(3),a=e.getUint8(4),o=this.HEADER_LENGTH+4,l=i.decode(t.slice(o,o+r));o+=r;let h=i.decode(t.slice(o,o+s));o+=s;let u=i.decode(t.slice(o,o+n));o+=n;let c=t.slice(o,t.byteLength),d=a===this.JSON_ENCODING?JSON.parse(i.decode(c)):c,f={type:this.BROADCAST_EVENT,event:h,payload:d};return n>0&&(f.meta=JSON.parse(u)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:f}}_isArrayBuffer(t){var e;return t instanceof ArrayBuffer||(null==(e=null==t?void 0:t.constructor)?void 0:e.name)==="ArrayBuffer"}_pick(t,e){return t&&"object"==typeof t?Object.fromEntries(Object.entries(t).filter(([t])=>e.includes(t))):{}}}class U{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(o=y||(y={})).abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange";let F=(t,e,i={})=>{var r;let s=null!=(r=i.skipTypes)?r:[];return e?Object.keys(e).reduce((i,r)=>(i[r]=z(r,t,e,s),i),{}):{}},z=(t,e,i,r)=>{let s=e.find(e=>e.name===t),n=null==s?void 0:s.type,a=i[t];return n&&!r.includes(n)?V(n,a):W(a)},V=(t,e)=>{if("_"===t.charAt(0))return J(e,t.slice(1,t.length));switch(t){case y.bool:return H(e);case y.float4:case y.float8:case y.int2:case y.int4:case y.int8:case y.numeric:case y.oid:return q(e);case y.json:case y.jsonb:return K(e);case y.timestamp:return G(e);case y.abstime:case y.date:case y.daterange:case y.int4range:case y.int8range:case y.money:case y.reltime:case y.text:case y.time:case y.timestamptz:case y.timetz:case y.tsrange:case y.tstzrange:default:return W(e)}},W=t=>t,H=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},q=t=>{if("string"==typeof t){let e=parseFloat(t);if(!Number.isNaN(e))return e}return t},K=t=>{if("string"==typeof t)try{return JSON.parse(t)}catch(t){}return t},J=(t,e)=>{if("string"!=typeof t)return t;let i=t.length-1,r=t[i];if("{"===t[0]&&"}"===r){let r,s=t.slice(1,i);try{r=JSON.parse("["+s+"]")}catch(t){r=s?s.split(","):[]}return r.map(t=>V(e,t))}return t},G=t=>"string"==typeof t?t.replace(" ","T"):t,Y=t=>{let e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===e.pathname||"/"===e.pathname?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class X{constructor(t,e,i={},r=1e4){this.channel=t,this.event=e,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var i;return this._hasReceived(t)&&e(null==(i=this.receivedResp)?void 0:i.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let t=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(e=>e.status===t).forEach(t=>t.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}(l=_||(_={})).SYNC="sync",l.JOIN="join",l.LEAVE="leave";class Z{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(null==e?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},t=>{let{onJoin:e,onLeave:i,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Z.syncState(this.state,t,e,i),this.pendingDiffs.forEach(t=>{this.state=Z.syncDiff(this.state,t,e,i)}),this.pendingDiffs=[],r()}),this.channel._on(i.diff,{},t=>{let{onJoin:e,onLeave:i,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(t):(this.state=Z.syncDiff(this.state,t,e,i),r())}),this.onJoin((t,e,i)=>{this.channel._trigger("presence",{event:"join",key:t,currentPresences:e,newPresences:i})}),this.onLeave((t,e,i)=>{this.channel._trigger("presence",{event:"leave",key:t,currentPresences:e,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,i,r){let s=this.cloneDeep(t),n=this.transformState(e),a={},o={};return this.map(s,(t,e)=>{n[t]||(o[t]=e)}),this.map(n,(t,e)=>{let i=s[t];if(i){let r=e.map(t=>t.presence_ref),s=i.map(t=>t.presence_ref),n=e.filter(t=>0>s.indexOf(t.presence_ref)),l=i.filter(t=>0>r.indexOf(t.presence_ref));n.length>0&&(a[t]=n),l.length>0&&(o[t]=l)}else a[t]=e}),this.syncDiff(s,{joins:a,leaves:o},i,r)}static syncDiff(t,e,i,r){let{joins:s,leaves:n}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(s,(e,r)=>{var s;let n=null!=(s=t[e])?s:[];if(t[e]=this.cloneDeep(r),n.length>0){let i=t[e].map(t=>t.presence_ref),r=n.filter(t=>0>i.indexOf(t.presence_ref));t[e].unshift(...r)}i(e,n,r)}),this.map(n,(e,i)=>{let s=t[e];if(!s)return;let n=i.map(t=>t.presence_ref);s=s.filter(t=>0>n.indexOf(t.presence_ref)),t[e]=s,r(e,s,i),0===s.length&&delete t[e]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(i=>e(i,t[i]))}static transformState(t){return Object.getOwnPropertyNames(t=this.cloneDeep(t)).reduce((e,i)=>{let r=t[i];return"metas"in r?e[i]=r.metas.map(t=>(t.presence_ref=t.phx_ref,delete t.phx_ref,delete t.phx_ref_prev,t)):e[i]=r,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(h=w||(w={})).ALL="*",h.INSERT="INSERT",h.UPDATE="UPDATE",h.DELETE="DELETE",(u=v||(v={})).BROADCAST="broadcast",u.PRESENCE="presence",u.POSTGRES_CHANGES="postgres_changes",u.SYSTEM="system",(c=x||(x={})).SUBSCRIBED="SUBSCRIBED",c.TIMED_OUT="TIMED_OUT",c.CLOSED="CLOSED",c.CHANNEL_ERROR="CHANNEL_ERROR";class Q{constructor(t,e={config:{}},i){var r,s;if(this.topic=t,this.params=e,this.socket=i,this.bindings={},this.state=p.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new X(this,g.join,this.params,this.timeout),this.rejoinTimer=new U(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=p.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(t=>t.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=p.closed,this.socket._remove(this)}),this._onError(t=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,t),this.state=p.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=p.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",t=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,t),this.state=p.errored,this.rejoinTimer.scheduleTimeout())}),this._on(g.reply,{},(t,e)=>{this._trigger(this._replyEventName(e),t)}),this.presence=new Z(this),this.broadcastEndpointURL=Y(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null==(s=null==(r=this.params.config)?void 0:r.broadcast)?void 0:s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,e=this.timeout){var i,r,s;if(this.socket.isConnected()||this.socket.connect(),this.state==p.closed){let{config:{broadcast:n,presence:a,private:o}}=this.params,l=null!=(r=null==(i=this.bindings.postgres_changes)?void 0:i.map(t=>t.filter))?r:[],h=!!this.bindings[v.PRESENCE]&&this.bindings[v.PRESENCE].length>0||(null==(s=this.params.config.presence)?void 0:s.enabled)===!0,u={},c={broadcast:n,presence:Object.assign(Object.assign({},a),{enabled:h}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(e=>null==t?void 0:t(x.CHANNEL_ERROR,e)),this._onClose(()=>null==t?void 0:t(x.CLOSED)),this.updateJoinPayload(Object.assign({config:c},u)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:e})=>{var i;if(this.socket._isManualToken()||this.socket.setAuth(),void 0===e){null==t||t(x.SUBSCRIBED);return}{let r=this.bindings.postgres_changes,s=null!=(i=null==r?void 0:r.length)?i:0,n=[];for(let i=0;i<s;i++){let s=r[i],{filter:{event:a,schema:o,table:l,filter:h}}=s,u=e&&e[i];if(u&&u.event===a&&Q.isFilterValueEqual(u.schema,o)&&Q.isFilterValueEqual(u.table,l)&&Q.isFilterValueEqual(u.filter,h))n.push(Object.assign(Object.assign({},s),{id:u.id}));else{this.unsubscribe(),this.state=p.errored,null==t||t(x.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=n,t&&t(x.SUBSCRIBED);return}}).receive("error",e=>{this.state=p.errored,null==t||t(x.CHANNEL_ERROR,Error(JSON.stringify(Object.values(e).join(", ")||"error")))}).receive("timeout",()=>{null==t||t(x.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,e={}){return await this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,e,i){return this.state===p.joined&&t===v.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,e,i)}async httpSend(t,e,i={}){var r;if(null==e)return Promise.reject("Payload is required for httpSend()");let s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);let n={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:e,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,n,null!=(r=i.timeout)?r:this.timeout);if(202===a.status)return{success:!0};let o=a.statusText;try{let t=await a.json();o=t.error||t.message||o}catch(t){}return Promise.reject(Error(o))}async send(t,e={}){var i,r;if(this._canPush()||"broadcast"!==t.type)return new Promise(i=>{var r,s,n;let a=this._push(t.type,t,e.timeout||this.timeout);"broadcast"!==t.type||(null==(n=null==(s=null==(r=this.params)?void 0:r.config)?void 0:s.broadcast)?void 0:n.ack)||i("ok"),a.receive("ok",()=>i("ok")),a.receive("error",()=>i("error")),a.receive("timeout",()=>i("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");let{event:s,payload:n}=t,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);let o={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:n,private:this.private}]})};try{let t=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!=(i=e.timeout)?i:this.timeout);return await (null==(r=t.body)?void 0:r.cancel()),t.ok?"ok":"error"}catch(t){if("AbortError"===t.name)return"timed out";return"error"}}}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=p.leaving;let e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(g.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{(i=new X(this,g.leave,{},t)).receive("ok",()=>{e(),r("ok")}).receive("timeout",()=>{e(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{null==i||i.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=p.closed,this.bindings={}}async _fetchWithTimeout(t,e,i){let r=new AbortController,s=setTimeout(()=>r.abort(),i),n=await this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:r.signal}));return clearTimeout(s),n}_push(t,e,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new X(this,t,e,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>100){let t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(t,e,i){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,i){var r,s;let n=t.toLocaleLowerCase(),{close:a,error:o,leave:l,join:h}=g;if(i&&[a,o,l,h].indexOf(n)>=0&&i!==this._joinRef())return;let u=this._onMessage(n,e,i);if(e&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null==(r=this.bindings.postgres_changes)||r.filter(t=>{var e,i,r;return(null==(e=t.filter)?void 0:e.event)==="*"||(null==(r=null==(i=t.filter)?void 0:i.event)?void 0:r.toLocaleLowerCase())===n}).map(t=>t.callback(u,i)):null==(s=this.bindings[n])||s.filter(t=>{var i,r,s,a,o,l,h,u;if(!["broadcast","presence","postgres_changes"].includes(n))return t.type.toLocaleLowerCase()===n;if("id"in t){let n=t.id,l=null==(i=t.filter)?void 0:i.event;return n&&(null==(r=e.ids)?void 0:r.includes(n))&&("*"===l||(null==l?void 0:l.toLocaleLowerCase())===(null==(s=e.data)?void 0:s.type.toLocaleLowerCase()))&&(!(null==(a=t.filter)?void 0:a.table)||t.filter.table===(null==(o=e.data)?void 0:o.table))}{let i=null==(h=null==(l=null==t?void 0:t.filter)?void 0:l.event)?void 0:h.toLocaleLowerCase();return"*"===i||i===(null==(u=null==e?void 0:e.event)?void 0:u.toLocaleLowerCase())}}).map(t=>{if("object"==typeof u&&"ids"in u){let t=u.data,{schema:e,table:i,commit_timestamp:r,type:s,errors:n}=t;u=Object.assign(Object.assign({},{schema:e,table:i,commit_timestamp:r,eventType:s,new:{},old:{},errors:n}),this._getPayloadRecords(t))}t.callback(u,i)})}_isClosed(){return this.state===p.closed}_isJoined(){return this.state===p.joined}_isJoining(){return this.state===p.joining}_isLeaving(){return this.state===p.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,i){let r=t.toLocaleLowerCase(),s={type:r,filter:e,callback:i};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(t,e){let i=t.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(t=>{var r;return!((null==(r=t.type)?void 0:r.toLocaleLowerCase())===i&&Q.isEqual(t.filter,e))})),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let i in t)if(t[i]!==e[i])return!1;return!0}static isFilterValueEqual(t,e){return(null!=t?t:void 0)===(null!=e?e:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(g.close,{},t)}_onError(t){this._on(g.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=p.joining,this.joinPush.resend(t))}_getPayloadRecords(t){let e={new:{},old:{}};return("INSERT"===t.type||"UPDATE"===t.type)&&(e.new=F(t.columns,t.record)),("UPDATE"===t.type||"DELETE"===t.type)&&(e.old=F(t.columns,t.old_record)),e}}let tt=()=>{},te=[1e3,2e3,5e3,1e4],ti=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class tr{constructor(t,e){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=tt,this.ref=0,this.reconnectTimer=null,this.vsn=B,this.logger=tt,this.conn=null,this.sendBuffer=[],this.serializer=new N,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=t=>t?(...e)=>t(...e):(...t)=>fetch(...t),!(null==(i=null==e?void 0:e.params)?void 0:i.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${t}/${m.websocket}`,this.httpEndpoint=Y(t),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==e?void 0:e.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=$.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");let t=e.message;if(t.includes("Node.js"))throw Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(t?this.conn.close(t,null!=e?e:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){let e=await t.unsubscribe();return 0===this.channels.length&&this.disconnect(),e}async removeAllChannels(){let t=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,e,i){this.logger(t,e,i)}connectionState(){switch(this.conn&&this.conn.readyState){case f.connecting:return b.Connecting;case f.open:return b.Open;case f.closing:return b.Closing;default:return b.Closed}}isConnected(){return this.connectionState()===b.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(t,e={config:{}}){let i=`realtime:${t}`,r=this.getChannels().find(t=>t.topic===i);if(r)return r;{let i=new Q(`realtime:${t}`,e,this);return this.channels.push(i),i}}push(t){let{topic:e,event:i,payload:r,ref:s}=t,n=()=>{this.encode(t,t=>{var e;null==(e=this.conn)||e.send(t)})};this.log("push",`${e} ${i} (${s})`,r),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,null==(t=this.conn)||t.close(1e3,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||null==(t=this.reconnectTimer)||t.scheduleTimeout()},100);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(e=>e.topic===t&&(e._isJoined()||e._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,t=>{if("phoenix"===t.topic&&"phx_reply"===t.event&&t.ref&&t.ref===this.pendingHeartbeatRef){let e=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===t.payload.status?"ok":"error",e)}catch(t){this.log("error","error in heartbeat callback",t)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}let{topic:e,event:i,payload:r,ref:s}=t,n=s?`(${s})`:"",a=r.status||"";this.log("receive",`${a} ${e} ${i} ${n}`.trim(),r),this.channels.filter(t=>t._isMember(e)).forEach(t=>t._trigger(i,r,s)),this._triggerStateCallbacks("message",t)})}_clearTimer(t){var e;"heartbeat"===t&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===t&&(null==(e=this.reconnectTimer)||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===f.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===f.open||this.conn.readyState===f.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{"keepAlive"===t.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var e;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null==(e=this.reconnectTimer)||e.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(g.error))}_appendParams(t,e){if(0===Object.keys(e).length)return t;let i=t.match(/\?/)?"&":"?",r=new URLSearchParams(e);return`${t}${i}${r}`}_workerObjectUrl(t){let e;if(t)e=t;else{let t=new Blob([ti],{type:"application/javascript"});e=URL.createObjectURL(t)}return e}_setConnectionState(t,e=!1){this._connectionState=t,"connecting"===t?this._wasManualDisconnect=!1:"disconnecting"===t&&(this._wasManualDisconnect=e)}async _performAuth(t=null){let e,i=!1;if(t)e=t,i=!0;else if(this.accessToken)try{e=await this.accessToken()}catch(t){this.log("error","Error fetching access token from callback",t),e=this.accessTokenValue}else e=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{let i={access_token:e,version:"realtime-js/2.90.1"};e&&t.updateJoinPayload(i),t.joinedOnce&&t._isJoined()&&t._push(g.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(e=>{this.log("error",`Error setting auth in ${t}`,e)})}_triggerStateCallbacks(t,e){try{this.stateChangeCallbacks[t].forEach(i=>{try{i(e)}catch(e){this.log("error",`error in ${t} callback`,e)}})}catch(e){this.log("error",`error triggering ${t} callbacks`,e)}}_setupReconnectionTimer(){this.reconnectTimer=new U(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},10)},this.reconnectAfterMs)}_initializeOptions(t){var e,i,r,s,n,a,o,l,h,u,c,d;switch(this.transport=null!=(e=null==t?void 0:t.transport)?e:null,this.timeout=null!=(i=null==t?void 0:t.timeout)?i:1e4,this.heartbeatIntervalMs=null!=(r=null==t?void 0:t.heartbeatIntervalMs)?r:25e3,this.worker=null!=(s=null==t?void 0:t.worker)&&s,this.accessToken=null!=(n=null==t?void 0:t.accessToken)?n:null,this.heartbeatCallback=null!=(a=null==t?void 0:t.heartbeatCallback)?a:tt,this.vsn=null!=(o=null==t?void 0:t.vsn)?o:B,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.logger)&&(this.logger=t.logger),((null==t?void 0:t.logLevel)||(null==t?void 0:t.log_level))&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!=(l=null==t?void 0:t.reconnectAfterMs)?l:t=>te[t-1]||1e4,this.vsn){case B:this.encode=null!=(h=null==t?void 0:t.encode)?h:(t,e)=>e(JSON.stringify(t)),this.decode=null!=(u=null==t?void 0:t.decode)?u:(t,e)=>e(JSON.parse(t));break;case"2.0.0":this.encode=null!=(c=null==t?void 0:t.encode)?c:this.serializer.encode.bind(this.serializer),this.decode=null!=(d=null==t?void 0:t.decode)?d:this.serializer.decode.bind(this.serializer);break;default:throw Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if("u">typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.workerUrl=null==t?void 0:t.workerUrl}}}var ts=t.i(67034),tn=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown="CommitStateUnknownException"===e.icebergType||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};async function ta(t){return t&&"none"!==t.type?"bearer"===t.type?{Authorization:`Bearer ${t.token}`}:"header"===t.type?{[t.name]:t.value}:"custom"===t.type?await t.getHeaders():{}:{}}function to(t){return t.join("\x1f")}var tl=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){let e=t?{parent:to(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(t=>({namespace:t}))}async createNamespace(t,e){let i={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:i})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${to(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${to(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${to(t.namespace)}`}),!0}catch(t){if(t instanceof tn&&404===t.status)return!1;throw t}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(t){if(t instanceof tn&&409===t.status)return;throw t}}};function th(t){return t.join("\x1f")}var tu=class{constructor(t,e="",i){this.client=t,this.prefix=e,this.accessDelegation=i}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${th(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){let i={};return this.accessDelegation&&(i["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${th(t.namespace)}/tables`,body:e,headers:i})).data.metadata}async updateTable(t,e){let i=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${th(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":i.data["metadata-location"],metadata:i.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${th(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){let e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${th(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){let e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${th(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(t){if(t instanceof tn&&404===t.status)return!1;throw t}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(i){if(i instanceof tn&&409===i.status)return await this.loadTable({namespace:t.namespace,name:e.name});throw i}}},tc=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const i=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=function(t){let e=t.fetchImpl??globalThis.fetch;return{async request({method:i,path:r,query:s,body:n,headers:a}){let o=function(t,e,i){let r=new URL(e,t);if(i)for(let[t,e]of Object.entries(i))void 0!==e&&r.searchParams.set(t,e);return r.toString()}(t.baseUrl,r,s),l=await ta(t.auth),h=await e(o,{method:i,headers:{...n?{"Content-Type":"application/json"}:{},...l,...a},body:n?JSON.stringify(n):void 0}),u=await h.text(),c=(h.headers.get("content-type")||"").includes("application/json"),d=c&&u?JSON.parse(u):u;if(!h.ok){let t=c?d:void 0,e=t?.error;throw new tn(e?.message??`Request failed with status ${h.status}`,{status:h.status,icebergType:e?.type,icebergCode:e?.code,details:t})}return{status:h.status,headers:h.headers,data:d}}}}({baseUrl:i,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new tl(this.client,e),this.tableOps=new tu(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},td=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function tf(t){return"object"==typeof t&&null!==t&&"__isStorageError"in t}var tp=class extends td{constructor(t,e,i){super(t),this.name="StorageApiError",this.status=e,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},tg=class extends td{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};let tm=t=>t?(...e)=>t(...e):(...t)=>fetch(...t),tb=t=>{if(Array.isArray(t))return t.map(t=>tb(t));if("function"==typeof t||t!==Object(t))return t;let e={};return Object.entries(t).forEach(([t,i])=>{e[t.replace(/([-_][a-z])/gi,t=>t.toUpperCase().replace(/[-_]/g,""))]=tb(i)}),e};function ty(t){return(ty="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function t_(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function tw(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?t_(Object(i),!0).forEach(function(e){!function(t,e,i){var r;(r=function(t,e){if("object"!=ty(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=ty(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==ty(r)?r:r+"")in t)?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):t_(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}let tv=t=>{var e;return t.msg||t.message||t.error_description||("string"==typeof t.error?t.error:null==(e=t.error)?void 0:e.message)||JSON.stringify(t)},tx=async(t,e,i)=>{t instanceof await Response&&!(null==i?void 0:i.noResolveJson)?t.json().then(i=>{let r=t.status||500,s=(null==i?void 0:i.statusCode)||r+"";e(new tp(tv(i),r,s))}).catch(t=>{e(new tg(tv(t),t))}):e(new tg(tv(t),t))};async function tk(t,e,i,r,s,n){return new Promise((a,o)=>{let l;t(i,(l={method:e,headers:(null==r?void 0:r.headers)||{}},"GET"===e||!n?l:((t=>{if("object"!=typeof t||null===t)return!1;let e=Object.getPrototypeOf(t);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)})(n)?(l.headers=tw({"Content-Type":"application/json"},null==r?void 0:r.headers),l.body=JSON.stringify(n)):l.body=n,(null==r?void 0:r.duplex)&&(l.duplex=r.duplex),tw(tw({},l),s)))).then(t=>{if(!t.ok)throw t;return(null==r?void 0:r.noResolveJson)?t:t.json()}).then(t=>a(t)).catch(t=>tx(t,o,r))})}async function tS(t,e,i,r){return tk(t,"GET",e,i,r)}async function tE(t,e,i,r,s){return tk(t,"POST",e,r,s,i)}async function tT(t,e,i,r,s){return tk(t,"PUT",e,r,s,i)}async function tO(t,e,i,r){return tk(t,"HEAD",e,tw(tw({},i),{},{noResolveJson:!0}),r)}async function tA(t,e,i,r,s){return tk(t,"DELETE",e,r,s,i)}var tR=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}};e=Symbol.toStringTag;var tP=class{constructor(t,i){this.downloadFn=t,this.shouldThrowOnError=i,this[e]="BlobDownloadBuilder",this.promise=null}asStream(){return new tR(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await (await this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}};let tC={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},tM={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var tD=class{constructor(t,e={},i,r){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=i,this.fetch=tm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,i,r){try{let s,n=tw(tw({},tM),r),a=tw(tw({},this.headers),"POST"===t&&{"x-upsert":String(n.upsert)}),o=n.metadata;"u">typeof Blob&&i instanceof Blob?((s=new FormData).append("cacheControl",n.cacheControl),o&&s.append("metadata",this.encodeMetadata(o)),s.append("",i)):"u">typeof FormData&&i instanceof FormData?((s=i).has("cacheControl")||s.append("cacheControl",n.cacheControl),o&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(o))):(s=i,a["cache-control"]=`max-age=${n.cacheControl}`,a["content-type"]=n.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o))),("u">typeof ReadableStream&&s instanceof ReadableStream||s&&"object"==typeof s&&"pipe"in s&&"function"==typeof s.pipe)&&!n.duplex&&(n.duplex="half")),(null==r?void 0:r.headers)&&(a=tw(tw({},a),r.headers));let l=this._removeEmptyFolders(e),h=this._getFinalPath(l),u=await ("PUT"==t?tT:tE)(this.fetch,`${this.url}/object/${h}`,s,tw({headers:a},(null==n?void 0:n.duplex)?{duplex:n.duplex}:{}));return{data:{path:l,id:u.Id,fullPath:u.Key},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async upload(t,e,i){return this.uploadOrUpdate("POST",t,e,i)}async uploadToSignedUrl(t,e,i,r){let s=this._removeEmptyFolders(t),n=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${n}`);a.searchParams.set("token",e);try{let t,e=tw({upsert:tM.upsert},r),n=tw(tw({},this.headers),{"x-upsert":String(e.upsert)});return"u">typeof Blob&&i instanceof Blob?((t=new FormData).append("cacheControl",e.cacheControl),t.append("",i)):"u">typeof FormData&&i instanceof FormData?(t=i).append("cacheControl",e.cacheControl):(t=i,n["cache-control"]=`max-age=${e.cacheControl}`,n["content-type"]=e.contentType),{data:{path:s,fullPath:(await tT(this.fetch,a.toString(),t,{headers:n})).Key},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async createSignedUploadUrl(t,e){try{let i=this._getFinalPath(t),r=tw({},this.headers);(null==e?void 0:e.upsert)&&(r["x-upsert"]="true");let s=await tE(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),n=new URL(this.url+s.url),a=n.searchParams.get("token");if(!a)throw new td("No token returned by API");return{data:{signedUrl:n.toString(),path:t,token:a},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async update(t,e,i){return this.uploadOrUpdate("PUT",t,e,i)}async move(t,e,i){try{return{data:await tE(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:null==i?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async copy(t,e,i){try{return{data:{path:(await tE(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:null==i?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async createSignedUrl(t,e,i){try{let r=this._getFinalPath(t),s=await tE(this.fetch,`${this.url}/object/sign/${r}`,tw({expiresIn:e},(null==i?void 0:i.transform)?{transform:i.transform}:{}),{headers:this.headers}),n=(null==i?void 0:i.download)?`&download=${!0===i.download?"":i.download}`:"";return{data:s={signedUrl:encodeURI(`${this.url}${s.signedURL}${n}`)},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async createSignedUrls(t,e,i){var r=this;try{let s=await tE(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:e,paths:t},{headers:r.headers}),n=(null==i?void 0:i.download)?`&download=${!0===i.download?"":i.download}`:"";return{data:s.map(t=>tw(tw({},t),{},{signedUrl:t.signedURL?encodeURI(`${r.url}${t.signedURL}${n}`):null})),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}download(t,e){let i=void 0!==(null==e?void 0:e.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==e?void 0:e.transform)||{}),s=r?`?${r}`:"",n=this._getFinalPath(t);return new tP(()=>tS(this.fetch,`${this.url}/${i}/${n}${s}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(t){let e=this._getFinalPath(t);try{return{data:tb(await tS(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers})),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async exists(t){let e=this._getFinalPath(t);try{return await tO(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t)&&t instanceof tg){let e=t.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:t}}throw t}}getPublicUrl(t,e){let i=this._getFinalPath(t),r=[],s=(null==e?void 0:e.download)?`download=${!0===e.download?"":e.download}`:"";""!==s&&r.push(s);let n=void 0!==(null==e?void 0:e.transform)?"render/image":"object",a=this.transformOptsToQueryString((null==e?void 0:e.transform)||{});""!==a&&r.push(a);let o=r.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${i}${o}`)}}}async remove(t){try{return{data:await tA(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async list(t,e,i){try{let r=tw(tw(tw({},tC),e),{},{prefix:t||""});return{data:await tE(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async listV2(t,e){try{let i=tw({},t);return{data:await tE(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},e),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return void 0!==ts.Buffer?ts.Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){let e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};let tI="2.90.1",tj={"X-Client-Info":`storage-js/${tI}`};var tL=class{constructor(t,e={},i,r){this.shouldThrowOnError=!1;const s=new URL(t);(null==r?void 0:r.useNewHostname)&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=tw(tw({},tj),e),this.fetch=tm(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){try{let e=this.listBucketOptionsToQueryString(t);return{data:await tS(this.fetch,`${this.url}/bucket${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async getBucket(t){try{return{data:await tS(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async createBucket(t,e={public:!1}){try{return{data:await tE(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async updateBucket(t,e){try{return{data:await tT(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async emptyBucket(t){try{return{data:await tE(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async deleteBucket(t){try{return{data:await tA(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(t){let e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},t$=class{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=tw(tw({},tj),e),this.fetch=tm(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){try{return{data:await tE(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async listBuckets(t){try{let e=new URLSearchParams;(null==t?void 0:t.limit)!==void 0&&e.set("limit",t.limit.toString()),(null==t?void 0:t.offset)!==void 0&&e.set("offset",t.offset.toString()),(null==t?void 0:t.sortColumn)&&e.set("sortColumn",t.sortColumn),(null==t?void 0:t.sortOrder)&&e.set("sortOrder",t.sortOrder),(null==t?void 0:t.search)&&e.set("search",t.search);let i=e.toString(),r=i?`${this.url}/bucket?${i}`:`${this.url}/bucket`;return{data:await tS(this.fetch,r,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}async deleteBucket(t){try{return{data:await tA(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tf(t))return{data:null,error:t};throw t}}from(t){var e=this;if(!(!(!t||"string"!=typeof t||0===t.length||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\"))&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(t)))throw new td("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");let i=new tc({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(i,{get(t,e){let i=t[e];return"function"!=typeof i?i:async(...e)=>{try{return{data:await i.apply(t,e),error:null}}catch(t){if(r)throw t;return{data:null,error:t}}}}})}};let tB={"X-Client-Info":`storage-js/${tI}`,"Content-Type":"application/json"};var tN=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function tU(t){return"object"==typeof t&&null!==t&&"__isStorageVectorsError"in t}var tF=class extends tN{constructor(t,e,i){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},tz=class extends tN{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};let tV=t=>t?(...e)=>t(...e):(...t)=>fetch(...t),tW=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),tH=async(t,e,i)=>{if(t&&"object"==typeof t&&"status"in t&&"ok"in t&&"number"==typeof t.status&&!(null==i?void 0:i.noResolveJson)){let i=t.status||500;"function"==typeof t.json?t.json().then(t=>{let r=(null==t?void 0:t.statusCode)||(null==t?void 0:t.code)||i+"";e(new tF(tW(t),i,r))}).catch(()=>{e(new tF(t.statusText||`HTTP ${i} error`,i,i+""))}):e(new tF(t.statusText||`HTTP ${i} error`,i,i+""))}else e(new tz(tW(t),t))};async function tq(t,e,i,r,s,n){return new Promise((a,o)=>{let l;t(i,(l={method:e,headers:(null==r?void 0:r.headers)||{}},"GET"===e||!n?l:((t=>{if("object"!=typeof t||null===t)return!1;let e=Object.getPrototypeOf(t);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)})(n)?(l.headers=tw({"Content-Type":"application/json"},null==r?void 0:r.headers),l.body=JSON.stringify(n)):l.body=n,tw(tw({},l),s)))).then(t=>{if(!t.ok)throw t;if(null==r?void 0:r.noResolveJson)return t;let e=t.headers.get("content-type");return e&&e.includes("application/json")?t.json():{}}).then(t=>a(t)).catch(t=>tH(t,o,r))})}async function tK(t,e,i,r,s){return tq(t,"POST",e,r,s,i)}var tJ=class{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=tw(tw({},tB),e),this.fetch=tV(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){try{return{data:await tK(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers})||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}async getIndex(t,e){try{return{data:await tK(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}async listIndexes(t){try{return{data:await tK(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}async deleteIndex(t,e){try{return{data:await tK(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers})||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}},tG=class{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=tw(tw({},tB),e),this.fetch=tV(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){try{if(t.vectors.length<1||t.vectors.length>500)throw Error("Vector batch size must be between 1 and 500 items");return{data:await tK(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers})||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}async getVectors(t){try{return{data:await tK(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}async listVectors(t){try{if(void 0!==t.segmentCount){if(t.segmentCount<1||t.segmentCount>16)throw Error("segmentCount must be between 1 and 16");if(void 0!==t.segmentIndex&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await tK(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}async queryVectors(t){try{return{data:await tK(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}async deleteVectors(t){try{if(t.keys.length<1||t.keys.length>500)throw Error("Keys batch size must be between 1 and 500 items");return{data:await tK(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers})||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}},tY=class{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=tw(tw({},tB),e),this.fetch=tV(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){try{return{data:await tK(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers})||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}async getBucket(t){try{return{data:await tK(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}async listBuckets(t={}){try{return{data:await tK(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}async deleteBucket(t){try{return{data:await tK(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers})||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(tU(t))return{data:null,error:t};throw t}}},tX=class extends tY{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new tZ(this.url,this.headers,t,this.fetch)}async createBucket(t){return super.createBucket.call(this,t)}async getBucket(t){return super.getBucket.call(this,t)}async listBuckets(t={}){return super.listBuckets.call(this,t)}async deleteBucket(t){return super.deleteBucket.call(this,t)}},tZ=class extends tJ{constructor(t,e,i,r){super(t,e,r),this.vectorBucketName=i}async createIndex(t){return super.createIndex.call(this,tw(tw({},t),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(t={}){return super.listIndexes.call(this,tw(tw({},t),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(t){return super.getIndex.call(this,this.vectorBucketName,t)}async deleteIndex(t){return super.deleteIndex.call(this,this.vectorBucketName,t)}index(t){return new tQ(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},tQ=class extends tG{constructor(t,e,i,r,s){super(t,e,s),this.vectorBucketName=i,this.indexName=r}async putVectors(t){return super.putVectors.call(this,tw(tw({},t),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async getVectors(t){return super.getVectors.call(this,tw(tw({},t),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async listVectors(t={}){return super.listVectors.call(this,tw(tw({},t),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async queryVectors(t){return super.queryVectors.call(this,tw(tw({},t),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async deleteVectors(t){return super.deleteVectors.call(this,tw(tw({},t),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}},t0=class extends tL{constructor(t,e={},i,r){super(t,e,i,r)}from(t){return new tD(this.url,this.headers,t,this.fetch)}get vectors(){return new tX(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new t$(this.url+"/iceberg",this.headers,this.fetch)}};let t1="2.90.1",t2={"X-Client-Info":`gotrue-js/${t1}`},t5="X-Supabase-Api-Version",t8={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},t3=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class t6 extends Error{constructor(t,e,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=i}}function t4(t){return"object"==typeof t&&null!==t&&"__isAuthError"in t}class t9 extends t6{constructor(t,e,i){super(t,e,i),this.name="AuthApiError",this.status=e,this.code=i}}class t7 extends t6{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class et extends t6{constructor(t,e,i,r){super(t,i,r),this.name=e,this.status=i}}class ee extends et{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class ei extends et{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class er extends et{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class es extends et{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class en extends et{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ea extends et{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class eo extends et{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}}function el(t){return t4(t)&&"AuthRetryableFetchError"===t.name}class eh extends et{constructor(t,e,i){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=i}}class eu extends et{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}let ec="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ed=" 	\n\r=".split(""),ef=(()=>{let t=Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<ed.length;e+=1)t[ed[e].charCodeAt(0)]=-2;for(let e=0;e<ec.length;e+=1)t[ec[e].charCodeAt(0)]=e;return t})();function ep(t,e,i){if(null!==t)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;)i(ec[e.queue>>e.queuedBits-6&63]),e.queuedBits-=6;else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;)i(ec[e.queue>>e.queuedBits-6&63]),e.queuedBits-=6}function eg(t,e,i){let r=ef[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)i(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else if(-2===r)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}function em(t){let e=[],i=t=>{e.push(String.fromCodePoint(t))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},n=t=>{!function(t,e,i){if(0===e.utf8seq){if(t<=127)return i(t);for(let i=1;i<6;i+=1)if((t>>7-i&1)==0){e.utf8seq=i;break}if(2===e.utf8seq)e.codepoint=31&t;else if(3===e.utf8seq)e.codepoint=15&t;else if(4===e.utf8seq)e.codepoint=7&t;else throw Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|63&t,e.utf8seq-=1,0===e.utf8seq&&i(e.codepoint)}}(t,r,i)};for(let e=0;e<t.length;e+=1)eg(t.charCodeAt(e),s,n);return e.join("")}function eb(t){let e=[],i={queue:0,queuedBits:0},r=t=>{e.push(t)};for(let e=0;e<t.length;e+=1)eg(t.charCodeAt(e),i,r);return new Uint8Array(e)}function ey(t){let e=[],i={queue:0,queuedBits:0},r=t=>{e.push(t)};return t.forEach(t=>ep(t,i,r)),ep(null,i,r),e.join("")}let e_=()=>"u">typeof window&&"u">typeof document,ew={tested:!1,writable:!1},ev=()=>{if(!e_())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(ew.tested)return ew.writable;let t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ew.tested=!0,ew.writable=!0}catch(t){ew.tested=!0,ew.writable=!1}return ew.writable},ex=t=>t?(...e)=>t(...e):(...t)=>fetch(...t),ek=async(t,e,i)=>{await t.setItem(e,JSON.stringify(i))},eS=async(t,e)=>{let i=await t.getItem(e);if(!i)return null;try{return JSON.parse(i)}catch(t){return i}},eE=async(t,e)=>{await t.removeItem(e)};class eT{constructor(){this.promise=new eT.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}function eO(t){let e=t.split(".");if(3!==e.length)throw new eu("Invalid JWT structure");for(let t=0;t<e.length;t++)if(!t3.test(e[t]))throw new eu("JWT not in base64url format");return{header:JSON.parse(em(e[0])),payload:JSON.parse(em(e[1])),signature:eb(e[2]),raw:{header:e[0],payload:e[1]}}}async function eA(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function eR(t){return("0"+t.toString(16)).substr(-2)}async function eP(t){let e=new TextEncoder().encode(t);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",e))).map(t=>String.fromCharCode(t)).join("")}async function eC(t){return"u">typeof crypto&&void 0!==crypto.subtle&&"u">typeof TextEncoder?btoa(await eP(t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t)}async function eM(t,e,i=!1){let r=function(){let t=new Uint32Array(56);if("u"<typeof crypto){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",e=t.length,i="";for(let r=0;r<56;r++)i+=t.charAt(Math.floor(Math.random()*e));return i}return crypto.getRandomValues(t),Array.from(t,eR).join("")}(),s=r;i&&(s+="/PASSWORD_RECOVERY"),await ek(t,`${e}-code-verifier`,s);let n=await eC(r),a=r===n?"plain":"s256";return[n,a]}eT.promiseConstructor=Promise;let eD=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,eI=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ej(t){if(!eI.test(t))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function eL(){return new Proxy({},{get:(t,e)=>{if("__isUserNotAvailableProxy"===e)return!0;if("symbol"==typeof e){let t=e.toString();if("Symbol(Symbol.toPrimitive)"===t||"Symbol(Symbol.toStringTag)"===t||"Symbol(util.inspect.custom)"===t)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,e)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,e)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function e$(t){return JSON.parse(JSON.stringify(t))}let eB=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),eN=[502,503,504];async function eU(t){var e;let i,r;if(!("object"==typeof t&&null!==t&&"status"in t&&"ok"in t&&"json"in t&&"function"==typeof t.json))throw new eo(eB(t),0);if(eN.includes(t.status))throw new eo(eB(t),t.status);try{i=await t.json()}catch(t){throw new t7(eB(t),t)}let s=function(t){let e=t.headers.get(t5);if(!e||!e.match(eD))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch(t){return null}}(t);if(s&&s.getTime()>=t8["2024-01-01"].timestamp&&"object"==typeof i&&i&&"string"==typeof i.code?r=i.code:"object"==typeof i&&i&&"string"==typeof i.error_code&&(r=i.error_code),r){if("weak_password"===r)throw new eh(eB(i),t.status,(null==(e=i.weak_password)?void 0:e.reasons)||[]);else if("session_not_found"===r)throw new ee}else if("object"==typeof i&&i&&"object"==typeof i.weak_password&&i.weak_password&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.reasons.reduce((t,e)=>t&&"string"==typeof e,!0))throw new eh(eB(i),t.status,i.weak_password.reasons);throw new t9(eB(i),t.status||500,r)}async function eF(t,e,i,r){var s;let n=Object.assign({},null==r?void 0:r.headers);n[t5]||(n[t5]=t8["2024-01-01"].name),(null==r?void 0:r.jwt)&&(n.Authorization=`Bearer ${r.jwt}`);let a=null!=(s=null==r?void 0:r.query)?s:{};(null==r?void 0:r.redirectTo)&&(a.redirect_to=r.redirectTo);let o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await ez(t,e,i+o,{headers:n,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function ez(t,e,i,r,s,n){let a,o,l=(o={method:e,headers:(null==r?void 0:r.headers)||{}},"GET"===e?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==r?void 0:r.headers),o.body=JSON.stringify(n),Object.assign(Object.assign({},o),s)));try{a=await t(i,Object.assign({},l))}catch(t){throw console.error(t),new eo(eB(t),0)}if(a.ok||await eU(a),null==r?void 0:r.noResolveJson)return a;try{return await a.json()}catch(t){await eU(t)}}function eV(t){var e,i,r;let s=null;(r=t).access_token&&r.refresh_token&&r.expires_in&&(s=Object.assign({},t),t.expires_at||(s.expires_at=(i=t.expires_in,Math.round(Date.now()/1e3)+i)));return{data:{session:s,user:null!=(e=t.user)?e:t},error:null}}function eW(t){let e=eV(t);return!e.error&&t.weak_password&&"object"==typeof t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&"string"==typeof t.weak_password.message&&t.weak_password.reasons.reduce((t,e)=>t&&"string"==typeof e,!0)&&(e.data.weak_password=t.weak_password),e}function eH(t){var e;return{data:{user:null!=(e=t.user)?e:t},error:null}}function eq(t){return{data:t,error:null}}function eK(t){let{action_link:e,email_otp:i,hashed_token:r,redirect_to:s,verification_type:n}=t;return{data:{properties:{action_link:e,email_otp:i,hashed_token:r,redirect_to:s,verification_type:n},user:Object.assign({},(0,A.__rest)(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function eJ(t){return t}let eG=["global","local","others"];class eY{constructor({url:t="",headers:e={},fetch:i}){this.url=t,this.headers=e,this.fetch=ex(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,e=eG[0]){if(0>eG.indexOf(e))throw Error(`@supabase/auth-js: Parameter scope must be one of ${eG.join(", ")}`);try{return await eF(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(t){if(t4(t))return{data:null,error:t};throw t}}async inviteUserByEmail(t,e={}){try{return await eF(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:eH})}catch(t){if(t4(t))return{data:{user:null},error:t};throw t}}async generateLink(t){try{let{options:e}=t,i=(0,A.__rest)(t,["options"]),r=Object.assign(Object.assign({},i),e);return"newEmail"in i&&(r.new_email=null==i?void 0:i.newEmail,delete r.newEmail),await eF(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:eK,redirectTo:null==e?void 0:e.redirectTo})}catch(t){if(t4(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(t){try{return await eF(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:eH})}catch(t){if(t4(t))return{data:{user:null},error:t};throw t}}async listUsers(t){var e,i,r,s,n,a,o;try{let l={nextPage:null,lastPage:0,total:0},h=await eF(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(i=null==(e=null==t?void 0:t.page)?void 0:e.toString())?i:"",per_page:null!=(s=null==(r=null==t?void 0:t.perPage)?void 0:r.toString())?s:""},xform:eJ});if(h.error)throw h.error;let u=await h.json(),c=null!=(n=h.headers.get("x-total-count"))?n:0,d=null!=(o=null==(a=h.headers.get("link"))?void 0:a.split(","))?o:[];return d.length>0&&(d.forEach(t=>{let e=parseInt(t.split(";")[0].split("=")[1].substring(0,1)),i=JSON.parse(t.split(";")[1].split("=")[1]);l[`${i}Page`]=e}),l.total=parseInt(c)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(t){if(t4(t))return{data:{users:[]},error:t};throw t}}async getUserById(t){ej(t);try{return await eF(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:eH})}catch(t){if(t4(t))return{data:{user:null},error:t};throw t}}async updateUserById(t,e){ej(t);try{return await eF(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:eH})}catch(t){if(t4(t))return{data:{user:null},error:t};throw t}}async deleteUser(t,e=!1){ej(t);try{return await eF(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:eH})}catch(t){if(t4(t))return{data:{user:null},error:t};throw t}}async _listFactors(t){ej(t.userId);try{let{data:e,error:i}=await eF(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:t=>({data:{factors:t},error:null})});return{data:e,error:i}}catch(t){if(t4(t))return{data:null,error:t};throw t}}async _deleteFactor(t){ej(t.userId),ej(t.id);try{return{data:await eF(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(t){if(t4(t))return{data:null,error:t};throw t}}async _listOAuthClients(t){var e,i,r,s,n,a,o;try{let l={nextPage:null,lastPage:0,total:0},h=await eF(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(i=null==(e=null==t?void 0:t.page)?void 0:e.toString())?i:"",per_page:null!=(s=null==(r=null==t?void 0:t.perPage)?void 0:r.toString())?s:""},xform:eJ});if(h.error)throw h.error;let u=await h.json(),c=null!=(n=h.headers.get("x-total-count"))?n:0,d=null!=(o=null==(a=h.headers.get("link"))?void 0:a.split(","))?o:[];return d.length>0&&(d.forEach(t=>{let e=parseInt(t.split(";")[0].split("=")[1].substring(0,1)),i=JSON.parse(t.split(";")[1].split("=")[1]);l[`${i}Page`]=e}),l.total=parseInt(c)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(t){if(t4(t))return{data:{clients:[]},error:t};throw t}}async _createOAuthClient(t){try{return await eF(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(t4(t))return{data:null,error:t};throw t}}async _getOAuthClient(t){try{return await eF(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(t4(t))return{data:null,error:t};throw t}}async _updateOAuthClient(t,e){try{return await eF(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(t4(t))return{data:null,error:t};throw t}}async _deleteOAuthClient(t){try{return await eF(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(t4(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(t){try{return await eF(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(t4(t))return{data:null,error:t};throw t}}}function eX(t={}){return{getItem:e=>t[e]||null,setItem:(e,i)=>{t[e]=i},removeItem:e=>{delete t[e]}}}let eZ={debug:!!(globalThis&&ev()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class eQ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class e0 extends eQ{}async function e1(t,e,i){eZ.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);let r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),eZ.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,0===e?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async r=>{if(r){eZ.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await i()}finally{eZ.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}if(0===e)throw eZ.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new e0(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(eZ.debug)try{let t=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(t,null,"  "))}catch(t){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",t)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await i()}))}function e2(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}class e5 extends Error{constructor({message:t,code:e,cause:i,name:r}){var s;super(t,{cause:i}),this.__isWebAuthnError=!0,this.name=null!=(s=null!=r?r:i instanceof Error?i.name:void 0)?s:"Unknown Error",this.code=e}}class e8 extends e5{constructor(t,e){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e,message:t}),this.name="WebAuthnUnknownError",this.originalError=e}}let e3=new class{createNewAbortSignal(){if(this.controller){let t=Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}let t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){let t=Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}};function e6(t){return"localhost"===t||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function e4(){var t,e;return!!(e_()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"==typeof(null==(t=null==navigator?void 0:navigator.credentials)?void 0:t.create)&&"function"==typeof(null==(e=null==navigator?void 0:navigator.credentials)?void 0:e.get))}async function e9(t){try{let e=await navigator.credentials.create(t);if(!e)return{data:null,error:new e8("Empty credential response",e)};if(!(e instanceof PublicKeyCredential))return{data:null,error:new e8("Browser returned unexpected credential type",e)};return{data:e,error:null}}catch(e){return{data:null,error:function({error:t,options:e}){var i,r,s;let{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(e.signal instanceof AbortSignal)return new e5({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if("ConstraintError"===t.name){if((null==(i=n.authenticatorSelection)?void 0:i.requireResidentKey)===!0)return new e5({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});else if("conditional"===e.mediation&&(null==(r=n.authenticatorSelection)?void 0:r.userVerification)==="required")return new e5({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});else if((null==(s=n.authenticatorSelection)?void 0:s.userVerification)==="required")return new e5({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else if("InvalidStateError"===t.name)return new e5({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});else if("NotAllowedError"===t.name)return new e5({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});else if("NotSupportedError"===t.name)return new e5(0===n.pubKeyCredParams.filter(t=>"public-key"===t.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});else if("SecurityError"===t.name){let e=window.location.hostname;if(!e6(e))return new e5({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t});if(n.rp.id!==e)return new e5({message:`The RP ID "${n.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else if("TypeError"===t.name){if(n.user.id.byteLength<1||n.user.id.byteLength>64)return new e5({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if("UnknownError"===t.name)return new e5({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t});return new e5({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}({error:e,options:t})}}}async function e7(t){try{let e=await navigator.credentials.get(t);if(!e)return{data:null,error:new e8("Empty credential response",e)};if(!(e instanceof PublicKeyCredential))return{data:null,error:new e8("Browser returned unexpected credential type",e)};return{data:e,error:null}}catch(e){return{data:null,error:function({error:t,options:e}){let{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(e.signal instanceof AbortSignal)return new e5({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if("NotAllowedError"===t.name)return new e5({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});else if("SecurityError"===t.name){let e=window.location.hostname;if(!e6(e))return new e5({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t});if(i.rpId!==e)return new e5({message:`The RP ID "${i.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else if("UnknownError"===t.name)return new e5({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t});return new e5({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}({error:e,options:t})}}}let it={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},ie={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ii(...t){let e=t=>null!==t&&"object"==typeof t&&!Array.isArray(t),i=t=>t instanceof ArrayBuffer||ArrayBuffer.isView(t),r={};for(let s of t)if(s)for(let t in s){let n=s[t];if(void 0!==n)if(Array.isArray(n))r[t]=n;else if(i(n))r[t]=n;else if(e(n)){let i=r[t];e(i)?r[t]=ii(i,n):r[t]=ii(n)}else r[t]=n}return r}class ir{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:e,friendlyName:i,signal:r},s){try{var n,a,o,l;let{data:h,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:e});if(!h)return{data:null,error:u};let c=null!=r?r:e3.createNewAbortSignal();if("create"===h.webauthn.type){let{user:t}=h.webauthn.credential_options.publicKey;t.name||(t.name=`${t.id}:${i}`),t.displayName||(t.displayName=t.name)}switch(h.webauthn.type){case"create":{let e=(n=h.webauthn.credential_options.publicKey,a=null==s?void 0:s.create,ii(it,n,a||{})),{data:i,error:r}=await e9({publicKey:e,signal:c});if(i)return{data:{factorId:t,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:i}},error:null};return{data:null,error:r}}case"request":{let e=(o=h.webauthn.credential_options.publicKey,l=null==s?void 0:s.request,ii(ie,o,l||{})),{data:i,error:r}=await e7(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:e,signal:c}));if(i)return{data:{factorId:t,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:i}},error:null};return{data:null,error:r}}}}catch(t){if(t4(t))return{data:null,error:t};return{data:null,error:new t7("Unexpected error in challenge",t)}}}async _verify({challengeId:t,factorId:e,webauthn:i}){return this.client.mfa.verify({factorId:e,challengeId:t,webauthn:i})}async _authenticate({factorId:t,webauthn:{rpId:e="u">typeof window?window.location.hostname:void 0,rpOrigins:i="u">typeof window?[window.location.origin]:void 0,signal:r}={}},s){if(!e)return{data:null,error:new t6("rpId is required for WebAuthn authentication")};try{if(!e4())return{data:null,error:new t7("Browser does not support WebAuthn",null)};let{data:n,error:a}=await this.challenge({factorId:t,webauthn:{rpId:e,rpOrigins:i},signal:r},{request:s});if(!n)return{data:null,error:a};let{webauthn:o}=n;return this._verify({factorId:t,challengeId:n.challengeId,webauthn:{type:o.type,rpId:e,rpOrigins:i,credential_response:o.credential_response}})}catch(t){if(t4(t))return{data:null,error:t};return{data:null,error:new t7("Unexpected error in authenticate",t)}}}async _register({friendlyName:t,webauthn:{rpId:e="u">typeof window?window.location.hostname:void 0,rpOrigins:i="u">typeof window?[window.location.origin]:void 0,signal:r}={}},s){if(!e)return{data:null,error:new t6("rpId is required for WebAuthn registration")};try{if(!e4())return{data:null,error:new t7("Browser does not support WebAuthn",null)};let{data:n,error:a}=await this._enroll({friendlyName:t});if(!n)return await this.client.mfa.listFactors().then(e=>{var i;return null==(i=e.data)?void 0:i.all.find(e=>"webauthn"===e.factor_type&&e.friendly_name===t&&"unverified"!==e.status)}).then(t=>t?this.client.mfa.unenroll({factorId:null==t?void 0:t.id}):void 0),{data:null,error:a};let{data:o,error:l}=await this._challenge({factorId:n.id,friendlyName:n.friendly_name,webauthn:{rpId:e,rpOrigins:i},signal:r},{create:s});if(!o)return{data:null,error:l};return this._verify({factorId:n.id,challengeId:o.challengeId,webauthn:{rpId:e,rpOrigins:i,type:o.webauthn.type,credential_response:o.webauthn.credential_response}})}catch(t){if(t4(t))return{data:null,error:t};return{data:null,error:new t7("Unexpected error in register",t)}}}}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(t){"u">typeof self&&(self.globalThis=self)}let is={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:t2,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function ia(t,e,i){return await i()}let io={};class il{get jwks(){var t,e;return null!=(e=null==(t=io[this.storageKey])?void 0:t.jwks)?e:{keys:[]}}set jwks(t){io[this.storageKey]=Object.assign(Object.assign({},io[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,e;return null!=(e=null==(t=io[this.storageKey])?void 0:t.cachedAt)?e:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){io[this.storageKey]=Object.assign(Object.assign({},io[this.storageKey]),{cachedAt:t})}constructor(t){var e,i,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},is),t);if(this.storageKey=s.storageKey,this.instanceID=null!=(e=il.nextInstanceID[this.storageKey])?e:0,il.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,"function"==typeof s.debug&&(this.logger=s.debug),this.instanceID>0&&e_()){const t=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(t),this.logDebugMessages&&console.trace(t)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new eY({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=ex(s.fetch),this.lock=s.lock||ia,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&e_()&&(null==(i=null==globalThis?void 0:globalThis.navigator)?void 0:i.locks)?this.lock=e1:this.lock=ia,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new ir(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:ev()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=eX(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=eX(this.memoryStorage)),e_()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(t){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",t)}null==(r=this.broadcastChannel)||r.addEventListener("message",async t=>{this._debug("received broadcast notification from other tab or client",t),await this._notifyAllSubscribers(t.data.event,t.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${t1}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var t;try{let e={},i="none";if(e_()&&(e=function(t){let e={},i=new URL(t);if(i.hash&&"#"===i.hash[0])try{new URLSearchParams(i.hash.substring(1)).forEach((t,i)=>{e[i]=t})}catch(t){}return i.searchParams.forEach((t,i)=>{e[i]=t}),e}(window.location.href),this._isImplicitGrantCallback(e)?i="implicit":await this._isPKCECallback(e)&&(i="pkce")),e_()&&this.detectSessionInUrl&&"none"!==i){let{data:r,error:s}=await this._getSessionFromURL(e,i);if(s){(this._debug("#_initialize()","error detecting session from URL",s),t4(s)&&"AuthImplicitGrantRedirectError"===s.name)&&(null==(t=s.details)||t.code);return{error:s}}let{session:n,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",n,"redirect type",a),await this._saveSession(n),setTimeout(async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){if(t4(t))return this._returnResult({error:t});return this._returnResult({error:new t7("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var e,i,r;try{let{data:s,error:n}=await eF(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(i=null==(e=null==t?void 0:t.options)?void 0:e.data)?i:{},gotrue_meta_security:{captcha_token:null==(r=null==t?void 0:t.options)?void 0:r.captchaToken}},xform:eV});if(n||!s)return this._returnResult({data:{user:null,session:null},error:n});let a=s.session,o=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:o,session:a},error:null})}catch(t){if(t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signUp(t){var e,i,r;try{let s;if("email"in t){let{email:i,password:r,options:n}=t,a=null,o=null;"pkce"===this.flowType&&([a,o]=await eM(this.storage,this.storageKey)),s=await eF(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:i,password:r,data:null!=(e=null==n?void 0:n.data)?e:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:a,code_challenge_method:o},xform:eV})}else if("phone"in t){let{phone:e,password:n,options:a}=t;s=await eF(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:e,password:n,data:null!=(i=null==a?void 0:a.data)?i:{},channel:null!=(r=null==a?void 0:a.channel)?r:"sms",gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:eV})}else throw new er("You must provide either an email or phone number and a password");let{data:n,error:a}=s;if(a||!n)return await eE(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:a});let o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(t){if(await eE(this.storage,`${this.storageKey}-code-verifier`),t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithPassword(t){try{let e;if("email"in t){let{email:i,password:r,options:s}=t;e=await eF(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:eW})}else if("phone"in t){let{phone:i,password:r,options:s}=t;e=await eF(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:eW})}else throw new er("You must provide either an email or phone number and a password");let{data:i,error:r}=e;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!i||!i.session||!i.user){let t=new ei;return this._returnResult({data:{user:null,session:null},error:t})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(t){if(t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(t){var e,i,r,s;return await this._handleProviderSignIn(t.provider,{redirectTo:null==(e=t.options)?void 0:e.redirectTo,scopes:null==(i=t.options)?void 0:i.scopes,queryParams:null==(r=t.options)?void 0:r.queryParams,skipBrowserRedirect:null==(s=t.options)?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){let{chain:e}=t;switch(e){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw Error(`@supabase/auth-js: Unsupported chain "${e}"`)}}async signInWithEthereum(t){var e,i,r,s,n,a,o,l,h,u,c,d;let f,p;if("message"in t)f=t.message,p=t.signature;else{let u,{chain:c,wallet:g,statement:m,options:b}=t;if(e_())if("object"==typeof g)u=g;else{let t=window;if("ethereum"in t&&"object"==typeof t.ethereum&&"request"in t.ethereum&&"function"==typeof t.ethereum.request)u=t.ethereum;else throw Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if("object"!=typeof g||!(null==b?void 0:b.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");u=g}let y=new URL(null!=(e=null==b?void 0:b.url)?e:window.location.href),_=await u.request({method:"eth_requestAccounts"}).then(t=>t).catch(()=>{throw Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||0===_.length)throw Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let w=e2(_[0]),v=null==(i=null==b?void 0:b.signInWithEthereum)?void 0:i.chainId;v||(v=parseInt(await u.request({method:"eth_chainId"}),16)),f=function(t){var e;let{chainId:i,domain:r,expirationTime:s,issuedAt:n=new Date,nonce:a,notBefore:o,requestId:l,resources:h,scheme:u,uri:c,version:d}=t;if(!Number.isInteger(i))throw Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${i}`);if(!r)throw Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!c)throw Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==d)throw Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(null==(e=t.statement)?void 0:e.includes("\n"))throw Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`);let f=e2(t.address),p=u?`${u}://${r}`:r,g=t.statement?`${t.statement}
`:"",m=`${p} wants you to sign in with your Ethereum account:
${f}

${g}`,b=`URI: ${c}
Version: ${d}
Chain ID: ${i}${a?`
Nonce: ${a}`:""}
Issued At: ${n.toISOString()}`;if(s&&(b+=`
Expiration Time: ${s.toISOString()}`),o&&(b+=`
Not Before: ${o.toISOString()}`),l&&(b+=`
Request ID: ${l}`),h){let t="\nResources:";for(let e of h){if(!e||"string"!=typeof e)throw Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${e}`);t+=`
- ${e}`}b+=t}return`${m}
${b}`}({domain:y.host,address:w,statement:m,uri:y.href,version:"1",chainId:v,nonce:null==(r=null==b?void 0:b.signInWithEthereum)?void 0:r.nonce,issuedAt:null!=(n=null==(s=null==b?void 0:b.signInWithEthereum)?void 0:s.issuedAt)?n:new Date,expirationTime:null==(a=null==b?void 0:b.signInWithEthereum)?void 0:a.expirationTime,notBefore:null==(o=null==b?void 0:b.signInWithEthereum)?void 0:o.notBefore,requestId:null==(l=null==b?void 0:b.signInWithEthereum)?void 0:l.requestId,resources:null==(h=null==b?void 0:b.signInWithEthereum)?void 0:h.resources}),p=await u.request({method:"personal_sign",params:[(d=f,"0x"+Array.from(new TextEncoder().encode(d),t=>t.toString(16).padStart(2,"0")).join("")),w]})}try{let{data:e,error:i}=await eF(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:p},(null==(u=t.options)?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null==(c=t.options)?void 0:c.captchaToken}}:null),xform:eV});if(i)throw i;if(!e||!e.session||!e.user){let t=new ei;return this._returnResult({data:{user:null,session:null},error:t})}return e.session&&(await this._saveSession(e.session),await this._notifyAllSubscribers("SIGNED_IN",e.session)),this._returnResult({data:Object.assign({},e),error:i})}catch(t){if(t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithSolana(t){var e,i,r,s,n,a,o,l,h,u,c,d;let f,p;if("message"in t)f=t.message,p=t.signature;else{let c,{chain:d,wallet:g,statement:m,options:b}=t;if(e_())if("object"==typeof g)c=g;else{let t=window;if("solana"in t&&"object"==typeof t.solana&&("signIn"in t.solana&&"function"==typeof t.solana.signIn||"signMessage"in t.solana&&"function"==typeof t.solana.signMessage))c=t.solana;else throw Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if("object"!=typeof g||!(null==b?void 0:b.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");c=g}let y=new URL(null!=(e=null==b?void 0:b.url)?e:window.location.href);if("signIn"in c&&c.signIn){let t,e=await c.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==b?void 0:b.signInWithSolana),{version:"1",domain:y.host,uri:y.href}),m?{statement:m}:null));if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else if(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e)t=e;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array)f="string"==typeof t.signedMessage?t.signedMessage:new TextDecoder().decode(t.signedMessage),p=t.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in c)||"function"!=typeof c.signMessage||!("publicKey"in c)||"object"!=typeof c||!c.publicKey||!("toBase58"in c.publicKey)||"function"!=typeof c.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${y.host} wants you to sign in with your Solana account:`,c.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${y.href}`,`Issued At: ${null!=(r=null==(i=null==b?void 0:b.signInWithSolana)?void 0:i.issuedAt)?r:new Date().toISOString()}`,...(null==(s=null==b?void 0:b.signInWithSolana)?void 0:s.notBefore)?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...(null==(n=null==b?void 0:b.signInWithSolana)?void 0:n.expirationTime)?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...(null==(a=null==b?void 0:b.signInWithSolana)?void 0:a.chainId)?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...(null==(o=null==b?void 0:b.signInWithSolana)?void 0:o.nonce)?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...(null==(l=null==b?void 0:b.signInWithSolana)?void 0:l.requestId)?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...(null==(u=null==(h=null==b?void 0:b.signInWithSolana)?void 0:h.resources)?void 0:u.length)?["Resources",...b.signInWithSolana.resources.map(t=>`- ${t}`)]:[]].join("\n");let t=await c.signMessage(new TextEncoder().encode(f),"utf8");if(!t||!(t instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=t}}try{let{data:e,error:i}=await eF(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:ey(p)},(null==(c=t.options)?void 0:c.captchaToken)?{gotrue_meta_security:{captcha_token:null==(d=t.options)?void 0:d.captchaToken}}:null),xform:eV});if(i)throw i;if(!e||!e.session||!e.user){let t=new ei;return this._returnResult({data:{user:null,session:null},error:t})}return e.session&&(await this._saveSession(e.session),await this._notifyAllSubscribers("SIGNED_IN",e.session)),this._returnResult({data:Object.assign({},e),error:i})}catch(t){if(t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _exchangeCodeForSession(t){let e=await eS(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(null!=e?e:"").split("/");try{if(!i&&"pkce"===this.flowType)throw new ea;let{data:e,error:s}=await eF(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:i},xform:eV});if(await eE(this.storage,`${this.storageKey}-code-verifier`),s)throw s;if(!e||!e.session||!e.user){let t=new ei;return this._returnResult({data:{user:null,session:null,redirectType:null},error:t})}return e.session&&(await this._saveSession(e.session),await this._notifyAllSubscribers("SIGNED_IN",e.session)),this._returnResult({data:Object.assign(Object.assign({},e),{redirectType:null!=r?r:null}),error:s})}catch(t){if(await eE(this.storage,`${this.storageKey}-code-verifier`),t4(t))return this._returnResult({data:{user:null,session:null,redirectType:null},error:t});throw t}}async signInWithIdToken(t){try{let{options:e,provider:i,token:r,access_token:s,nonce:n}=t,{data:a,error:o}=await eF(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:s,nonce:n,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:eV});if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!a||!a.session||!a.user){let t=new ei;return this._returnResult({data:{user:null,session:null},error:t})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:a,error:o})}catch(t){if(t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(t){var e,i,r,s,n;try{if("email"in t){let{email:r,options:s}=t,n=null,a=null;"pkce"===this.flowType&&([n,a]=await eM(this.storage,this.storageKey));let{error:o}=await eF(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!=(e=null==s?void 0:s.data)?e:{},create_user:null==(i=null==s?void 0:s.shouldCreateUser)||i,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:n,code_challenge_method:a},redirectTo:null==s?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}if("phone"in t){let{phone:e,options:i}=t,{data:a,error:o}=await eF(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:e,data:null!=(r=null==i?void 0:i.data)?r:{},create_user:null==(s=null==i?void 0:i.shouldCreateUser)||s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},channel:null!=(n=null==i?void 0:i.channel)?n:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:o})}throw new er("You must provide either an email or phone number.")}catch(t){if(await eE(this.storage,`${this.storageKey}-code-verifier`),t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async verifyOtp(t){var e,i;try{let r,s;"options"in t&&(r=null==(e=t.options)?void 0:e.redirectTo,s=null==(i=t.options)?void 0:i.captchaToken);let{data:n,error:a}=await eF(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:eV});if(a)throw a;if(!n)throw Error("An error occurred on token verification.");let o=n.session,l=n.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==t.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(t){if(t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithSSO(t){var e,i,r,s,n;try{let a=null,o=null;"pkce"===this.flowType&&([a,o]=await eM(this.storage,this.storageKey));let l=await eF(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:null!=(i=null==(e=t.options)?void 0:e.redirectTo)?i:void 0}),(null==(r=null==t?void 0:t.options)?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:eq});return(null==(s=l.data)?void 0:s.url)&&e_()&&!(null==(n=t.options)?void 0:n.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(t){if(await eE(this.storage,`${this.storageKey}-code-verifier`),t4(t))return this._returnResult({data:null,error:t});throw t}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{let{data:{session:e},error:i}=t;if(i)throw i;if(!e)throw new ee;let{error:r}=await eF(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(t){if(t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{let e=`${this.url}/resend`;if("email"in t){let{email:i,type:r,options:s}=t,{error:n}=await eF(this.fetch,"POST",e,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},redirectTo:null==s?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:n})}if("phone"in t){let{phone:i,type:r,options:s}=t,{data:n,error:a}=await eF(this.fetch,"POST",e,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:a})}throw new er("You must provide either an email or phone number and a type")}catch(t){if(t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(t,e){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){let t=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await t,await e()))();return this.pendingInLock.push((async()=>{try{await i}catch(t){}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let t=e();for(this.pendingInLock.push((async()=>{try{await t}catch(t){}})()),await t;this.pendingInLock.length;){let t=[...this.pendingInLock];await Promise.all(t),this.pendingInLock.splice(0,t.length)}return await t}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{let e=await this.__loadSession();return await t(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,i=await eS(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",i),null!==i&&(this._isValidSession(i)?e=i:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let r=!!e.expires_at&&1e3*e.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){let t=await eS(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=eL()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){var t;let i={value:this.suppressGetSessionWarning};e.user=(t=e.user,new Proxy(t,{get:(t,e,r)=>{if("__isInsecureUserWarningProxy"===e)return!0;if("symbol"==typeof e){let i=e.toString();if("Symbol(Symbol.toPrimitive)"===i||"Symbol(Symbol.toStringTag)"===i||"Symbol(util.inspect.custom)"===i||"Symbol(nodejs.util.inspect.custom)"===i)return Reflect.get(t,e,r)}return i.value||"string"!=typeof e||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i.value=!0),Reflect.get(t,e,r)}})),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}let{data:s,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return this._returnResult({data:{session:null},error:n});return this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;let e=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return e.data.user&&(this.suppressGetSessionWarning=!0),e}async _getUser(t){try{if(t)return await eF(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:eH});return await this._useSession(async t=>{var e,i,r;let{data:s,error:n}=t;if(n)throw n;return(null==(e=s.session)?void 0:e.access_token)||this.hasCustomAuthorizationHeader?await eF(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(r=null==(i=s.session)?void 0:i.access_token)?r:void 0,xform:eH}):{data:{user:null},error:new ee}})}catch(t){if(t4(t))return t4(t)&&"AuthSessionMissingError"===t.name&&(await this._removeSession(),await eE(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(t,e={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,e))}async _updateUser(t,e={}){try{return await this._useSession(async i=>{let{data:r,error:s}=i;if(s)throw s;if(!r.session)throw new ee;let n=r.session,a=null,o=null;"pkce"===this.flowType&&null!=t.email&&([a,o]=await eM(this.storage,this.storageKey));let{data:l,error:h}=await eF(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==e?void 0:e.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:a,code_challenge_method:o}),jwt:n.access_token,xform:eH});if(h)throw h;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),this._returnResult({data:{user:n.user},error:null})})}catch(t){if(await eE(this.storage,`${this.storageKey}-code-verifier`),t4(t))return this._returnResult({data:{user:null},error:t});throw t}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ee;let e=Date.now()/1e3,i=e,r=!0,s=null,{payload:n}=eO(t.access_token);if(n.exp&&(r=(i=n.exp)<=e),r){let{data:e,error:i}=await this._callRefreshToken(t.refresh_token);if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!e)return{data:{user:null,session:null},error:null};s=e}else{let{data:r,error:n}=await this._getUser(t.access_token);if(n)throw n;s={access_token:t.access_token,refresh_token:t.refresh_token,user:r.user,token_type:"bearer",expires_in:i-e,expires_at:i},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(t){if(t4(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async e=>{var i;if(!t){let{data:r,error:s}=e;if(s)throw s;t=null!=(i=r.session)?i:void 0}if(!(null==t?void 0:t.refresh_token))throw new ee;let{data:r,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(t,e){try{if(!e_())throw new es("No browser detected.");if(t.error||t.error_description||t.error_code)throw new es(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(e){case"implicit":if("pkce"===this.flowType)throw new en("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new es("Not a valid implicit grant flow url.")}if("pkce"===e){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new en("No code detected.");let{data:e,error:i}=await this._exchangeCodeForSession(t.code);if(i)throw i;let r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:e.session,redirectType:null},error:null}}let{provider_token:i,provider_refresh_token:r,access_token:s,refresh_token:n,expires_in:a,expires_at:o,token_type:l}=t;if(!s||!a||!n||!l)throw new es("No session defined in URL");let h=Math.round(Date.now()/1e3),u=parseInt(a),c=h+u;o&&(c=parseInt(o));let d=c-h;1e3*d<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${u}s`);let f=c-u;h-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,c,h):h-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,c,h);let{data:p,error:g}=await this._getUser(s);if(g)throw g;let m={provider_token:i,provider_refresh_token:r,access_token:s,expires_in:u,expires_at:c,refresh_token:n,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:t.type},error:null})}catch(t){if(t4(t))return this._returnResult({data:{session:null,redirectType:null},error:t});throw t}}_isImplicitGrantCallback(t){return"function"==typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){let e=await eS(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&e)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async e=>{var i;let{data:r,error:s}=e;if(s)return this._returnResult({error:s});let n=null==(i=r.session)?void 0:i.access_token;if(n){let{error:e}=await this.admin.signOut(n,t);if(e&&!(t4(e)&&"AuthApiError"===e.name&&(404===e.status||401===e.status||403===e.status)))return this._returnResult({error:e})}return"others"!==t&&(await this._removeSession(),await eE(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){let e=Symbol("auth-callback"),i={id:e,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,i),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(e)})})(),{data:{subscription:i}}}async _emitInitialSession(t){return await this._useSession(async e=>{var i,r;try{let{data:{session:r},error:s}=e;if(s)throw s;await (null==(i=this.stateChangeEmitters.get(t))?void 0:i.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",t,"session",r)}catch(e){await (null==(r=this.stateChangeEmitters.get(t))?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",e),console.error(e)}})}async resetPasswordForEmail(t,e={}){let i=null,r=null;"pkce"===this.flowType&&([i,r]=await eM(this.storage,this.storageKey,!0));try{return await eF(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(t){if(await eE(this.storage,`${this.storageKey}-code-verifier`),t4(t))return this._returnResult({data:null,error:t});throw t}}async getUserIdentities(){var t;try{let{data:e,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:null!=(t=e.user.identities)?t:[]},error:null})}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var e;try{let{data:i,error:r}=await this._useSession(async e=>{var i,r,s,n,a;let{data:o,error:l}=e;if(l)throw l;let h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:null==(i=t.options)?void 0:i.redirectTo,scopes:null==(r=t.options)?void 0:r.scopes,queryParams:null==(s=t.options)?void 0:s.queryParams,skipBrowserRedirect:!0});return await eF(this.fetch,"GET",h,{headers:this.headers,jwt:null!=(a=null==(n=o.session)?void 0:n.access_token)?a:void 0})});if(r)throw r;return!e_()||(null==(e=t.options)?void 0:e.skipBrowserRedirect)||window.location.assign(null==i?void 0:i.url),this._returnResult({data:{provider:t.provider,url:null==i?void 0:i.url},error:null})}catch(e){if(t4(e))return this._returnResult({data:{provider:t.provider,url:null},error:e});throw e}}async linkIdentityIdToken(t){return await this._useSession(async e=>{var i;try{let{error:r,data:{session:s}}=e;if(r)throw r;let{options:n,provider:a,token:o,access_token:l,nonce:h}=t,{data:u,error:c}=await eF(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!=(i=null==s?void 0:s.access_token)?i:void 0,body:{provider:a,id_token:o,access_token:l,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:eV});if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!u||!u.session||!u.user)return this._returnResult({data:{user:null,session:null},error:new ei});return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("USER_UPDATED",u.session)),this._returnResult({data:u,error:c})}catch(t){if(await eE(this.storage,`${this.storageKey}-code-verifier`),t4(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}})}async unlinkIdentity(t){try{return await this._useSession(async e=>{var i,r;let{data:s,error:n}=e;if(n)throw n;return await eF(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:null!=(r=null==(i=s.session)?void 0:i.access_token)?r:void 0})})}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(t){let e=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(e,"begin");try{var i,r;let s=Date.now();return await (i=async i=>(i>0&&await eA(200*Math.pow(2,i-1)),this._debug(e,"refreshing attempt",i),await eF(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:eV})),r=(t,e)=>{let i=200*Math.pow(2,t);return e&&el(e)&&Date.now()+i-s<3e4},new Promise((t,e)=>{(async()=>{for(let s=0;s<1/0;s++)try{let e=await i(s);if(!r(s,null,e))return void t(e)}catch(t){if(!r(s,t))return void e(t)}})()}))}catch(t){if(this._debug(e,"error",t),t4(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}finally{this._debug(e,"end")}}_isValidSession(t){return"object"==typeof t&&null!==t&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,e){let i=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",e,"url",i),e_()&&!e.skipBrowserRedirect&&window.location.assign(i),{data:{provider:t,url:i},error:null}}async _recoverAndRefresh(){var t,e;let i="#_recoverAndRefresh()";this._debug(i,"begin");try{let r=await eS(this.storage,this.storageKey);if(r&&this.userStorage){let e=await eS(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!e&&(e={user:r.user},await ek(this.userStorage,this.storageKey+"-user",e)),r.user=null!=(t=null==e?void 0:e.user)?t:eL()}else if(r&&!r.user&&!r.user){let t=await eS(this.storage,this.storageKey+"-user");t&&(null==t?void 0:t.user)?(r.user=t.user,await eE(this.storage,this.storageKey+"-user"),await ek(this.storage,this.storageKey,r)):r.user=eL()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),null!==r&&await this._removeSession();return}let s=(null!=(e=r.expires_at)?e:1/0)*1e3-Date.now()<9e4;if(this._debug(i,`session has${s?"":" not"} expired with margin of 90000s`),s){if(this.autoRefreshToken&&r.refresh_token){let{error:t}=await this._callRefreshToken(r.refresh_token);t&&(console.error(t),el(t)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",t),await this._removeSession()))}}else if(r.user&&!0===r.user.__isUserNotAvailableProxy)try{let{data:t,error:e}=await this._getUser(r.access_token);!e&&(null==t?void 0:t.user)?(r.user=t.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(t){console.error("Error getting user data:",t),this._debug(i,"error getting user data, skipping SIGNED_IN notification",t)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(t){this._debug(i,"error",t),console.error(t);return}finally{this._debug(i,"end")}}async _callRefreshToken(t){var e,i;if(!t)throw new ee;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new eT;let{data:e,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!e.session)throw new ee;await this._saveSession(e.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",e.session);let r={data:e.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(t){if(this._debug(r,"error",t),t4(t)){let i={data:null,error:t};return el(t)||await this._removeSession(),null==(e=this.refreshingDeferred)||e.resolve(i),i}throw null==(i=this.refreshingDeferred)||i.reject(t),t}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(t,e,i=!0){let r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",e,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:t,session:e});let r=[],s=Array.from(this.stateChangeEmitters.values()).map(async i=>{try{await i.callback(t,e)}catch(t){r.push(t)}});if(await Promise.all(s),r.length>0){for(let t=0;t<r.length;t+=1)console.error(r[t]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await eE(this.storage,`${this.storageKey}-code-verifier`);let e=Object.assign({},t),i=e.user&&!0===e.user.__isUserNotAvailableProxy;if(this.userStorage){!i&&e.user&&await ek(this.userStorage,this.storageKey+"-user",{user:e.user});let t=Object.assign({},e);delete t.user;let r=e$(t);await ek(this.storage,this.storageKey,r)}else{let t=e$(e);await ek(this.storage,this.storageKey,t)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await eE(this.storage,this.storageKey),await eE(this.storage,this.storageKey+"-code-verifier"),await eE(this.storage,this.storageKey+"-user"),this.userStorage&&await eE(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&e_()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let t=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=t,t&&"object"==typeof t&&"function"==typeof t.unref?t.unref():"u">typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(t);let e=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"u">typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);let e=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,e&&clearTimeout(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let t=Date.now();try{return await this._useSession(async e=>{let{data:{session:i}}=e;if(!i||!i.refresh_token||!i.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let r=Math.floor((1e3*i.expires_at-t)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof eQ)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!e_()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){let e=`#_onVisibilityChanged(${t})`;this._debug(e,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{"visible"!==document.visibilityState?this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting"):await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,e,i){let r=[`provider=${encodeURIComponent(e)}`];if((null==i?void 0:i.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),(null==i?void 0:i.scopes)&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),"pkce"===this.flowType){let[t,e]=await eM(this.storage,this.storageKey),i=new URLSearchParams({code_challenge:`${encodeURIComponent(t)}`,code_challenge_method:`${encodeURIComponent(e)}`});r.push(i.toString())}if(null==i?void 0:i.queryParams){let t=new URLSearchParams(i.queryParams);r.push(t.toString())}return(null==i?void 0:i.skipBrowserRedirect)&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${t}?${r.join("&")}`}async _unenroll(t){try{return await this._useSession(async e=>{var i;let{data:r,error:s}=e;return s?this._returnResult({data:null,error:s}):await eF(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:null==(i=null==r?void 0:r.session)?void 0:i.access_token})})}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(t){try{return await this._useSession(async e=>{var i,r;let{data:s,error:n}=e;if(n)return this._returnResult({data:null,error:n});let a=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},"phone"===t.factorType?{phone:t.phone}:"totp"===t.factorType?{issuer:t.issuer}:{}),{data:o,error:l}=await eF(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null==(i=null==s?void 0:s.session)?void 0:i.access_token});return l?this._returnResult({data:null,error:l}):("totp"===t.factorType&&"totp"===o.type&&(null==(r=null==o?void 0:o.totp)?void 0:r.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),this._returnResult({data:o,error:null}))})}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async e=>{var i,r,s;let{data:n,error:a}=e;if(a)return this._returnResult({data:null,error:a});let o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:"create"===t.webauthn.type?(r=t.webauthn.credential_response,"toJSON"in r&&"function"==typeof r.toJSON?r.toJSON():{id:r.id,rawId:r.id,response:{attestationObject:ey(new Uint8Array(r.response.attestationObject)),clientDataJSON:ey(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:null!=(s=r.authenticatorAttachment)?s:void 0}):function(t){var e;if("toJSON"in t&&"function"==typeof t.toJSON)return t.toJSON();let i=t.getClientExtensionResults(),r=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:ey(new Uint8Array(r.authenticatorData)),clientDataJSON:ey(new Uint8Array(r.clientDataJSON)),signature:ey(new Uint8Array(r.signature)),userHandle:r.userHandle?ey(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:null!=(e=t.authenticatorAttachment)?e:void 0}}(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:h}=await eF(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:null==(i=null==n?void 0:n.session)?void 0:i.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:h}))})}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async e=>{var i;let{data:r,error:s}=e;if(s)return this._returnResult({data:null,error:s});let n=await eF(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:null==(i=null==r?void 0:r.session)?void 0:i.access_token});if(n.error)return n;let{data:a}=n;if("webauthn"!==a.type)return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:function(t){if(!t)throw Error("Credential creation options are required");if("u">typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(t);let{challenge:e,user:i,excludeCredentials:r}=t,s=(0,A.__rest)(t,["challenge","user","excludeCredentials"]),n=eb(e).buffer,a=Object.assign(Object.assign({},i),{id:eb(i.id).buffer}),o=Object.assign(Object.assign({},s),{challenge:n,user:a});if(r&&r.length>0){o.excludeCredentials=Array(r.length);for(let t=0;t<r.length;t++){let e=r[t];o.excludeCredentials[t]=Object.assign(Object.assign({},e),{id:eb(e.id).buffer,type:e.type||"public-key",transports:e.transports})}}return o}(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:function(t){if(!t)throw Error("Credential request options are required");if("u">typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(t);let{challenge:e,allowCredentials:i}=t,r=(0,A.__rest)(t,["challenge","allowCredentials"]),s=eb(e).buffer,n=Object.assign(Object.assign({},r),{challenge:s});if(i&&i.length>0){n.allowCredentials=Array(i.length);for(let t=0;t<i.length;t++){let e=i[t];n.allowCredentials[t]=Object.assign(Object.assign({},e),{id:eb(e.id).buffer,type:e.type||"public-key",transports:e.transports})}}return n}(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(t){let{data:e,error:i}=await this._challenge({factorId:t.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})}async _listFactors(){var t;let{data:{user:e},error:i}=await this.getUser();if(i)return{data:null,error:i};let r={all:[],phone:[],totp:[],webauthn:[]};for(let i of null!=(t=null==e?void 0:e.factors)?t:[])r.all.push(i),"verified"===i.status&&r[i.factor_type].push(i);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var t,e;let{data:{session:i},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:s}=eO(i.access_token),n=null;s.aal&&(n=s.aal);let a=n;return(null!=(e=null==(t=i.user.factors)?void 0:t.filter(t=>"verified"===t.status))?e:[]).length>0&&(a="aal2"),{data:{currentLevel:n,nextLevel:a,currentAuthenticationMethods:s.amr||[]},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async e=>{let{data:{session:i},error:r}=e;return r?this._returnResult({data:null,error:r}):i?await eF(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:i.access_token,xform:t=>({data:t,error:null})}):this._returnResult({data:null,error:new ee})})}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(t,e){try{return await this._useSession(async i=>{let{data:{session:r},error:s}=i;if(s)return this._returnResult({data:null,error:s});if(!r)return this._returnResult({data:null,error:new ee});let n=await eF(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:t=>({data:t,error:null})});return n.data&&n.data.redirect_url&&e_()&&!(null==e?void 0:e.skipBrowserRedirect)&&window.location.assign(n.data.redirect_url),n})}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}}async _denyAuthorization(t,e){try{return await this._useSession(async i=>{let{data:{session:r},error:s}=i;if(s)return this._returnResult({data:null,error:s});if(!r)return this._returnResult({data:null,error:new ee});let n=await eF(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:t=>({data:t,error:null})});return n.data&&n.data.redirect_url&&e_()&&!(null==e?void 0:e.skipBrowserRedirect)&&window.location.assign(n.data.redirect_url),n})}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}}async _listOAuthGrants(){try{return await this._useSession(async t=>{let{data:{session:e},error:i}=t;return i?this._returnResult({data:null,error:i}):e?await eF(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:e.access_token,xform:t=>({data:t,error:null})}):this._returnResult({data:null,error:new ee})})}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async e=>{let{data:{session:i},error:r}=e;return r?this._returnResult({data:null,error:r}):i?(await eF(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ee})})}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(t,e={keys:[]}){let i=e.keys.find(e=>e.kid===t);if(i)return i;let r=Date.now();if((i=this.jwks.keys.find(e=>e.kid===t))&&this.jwks_cached_at+6e5>r)return i;let{data:s,error:n}=await eF(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;return s.keys&&0!==s.keys.length&&(this.jwks=s,this.jwks_cached_at=r,i=s.keys.find(e=>e.kid===t))?i:null}async getClaims(t,e={}){try{var i;let r,s=t;if(!s){let{data:t,error:e}=await this.getSession();if(e||!t.session)return this._returnResult({data:null,error:e});s=t.session.access_token}let{header:n,payload:a,signature:o,raw:{header:l,payload:h}}=eO(s);(null==e?void 0:e.allowExpired)||function(t){if(!t)throw Error("Missing exp claim");if(t<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(a.exp);let u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,(null==e?void 0:e.keys)?{keys:e.keys}:null==e?void 0:e.jwks);if(!u){let{error:t}=await this.getUser(s);if(t)throw t;return{data:{claims:a,header:n,signature:o},error:null}}let c=function(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(n.alg),d=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,o,(i=`${l}.${h}`,r=[],!function(t,e){for(let i=0;i<t.length;i+=1){let r=t.charCodeAt(i);if(r>55295&&r<=56319){let e=(r-55296)*1024&65535;r=(t.charCodeAt(i+1)-56320&65535|e)+65536,i+=1}!function(t,e){if(t<=127)return e(t);if(t<=2047){e(192|t>>6),e(128|63&t);return}if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|63&t);return}if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|63&t);return}throw Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}(r,e)}}(i,t=>r.push(t)),new Uint8Array(r))))throw new eu("Invalid JWT signature");return{data:{claims:a,header:n,signature:o},error:null}}catch(t){if(t4(t))return this._returnResult({data:null,error:t});throw t}}}il.nextInstanceID={};let ih=il,iu="";iu="u">typeof Deno?"deno":"u">typeof document?"web":"u">typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let ic={headers:{"X-Client-Info":`supabase-js-${iu}/2.90.1`}},id={schema:"public"},ip={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ig={};function im(t){return(im="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ib(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function iy(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ib(Object(i),!0).forEach(function(e){!function(t,e,i){var r;(r=function(t,e){if("object"!=im(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=im(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==im(r)?r:r+"")in t)?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ib(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var i_=class extends ih{constructor(t){super(t)}},iw=class{constructor(t,e,i){var r,s,n;this.supabaseUrl=t,this.supabaseKey=e;const a=function(t){let e=null==t?void 0:t.trim();if(!e)throw Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(e.endsWith("/")?e:e+"/")}catch(t){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}(t);if(!e)throw Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const o=`sb-${a.hostname.split(".")[0]}-auth-token`,l=function(t,e){var i,r;let{db:s,auth:n,realtime:a,global:o}=t,{db:l,auth:h,realtime:u,global:c}=e,d={db:iy(iy({},l),s),auth:iy(iy({},h),n),realtime:iy(iy({},u),a),storage:{},global:iy(iy(iy({},c),o),{},{headers:iy(iy({},null!=(i=null==c?void 0:c.headers)?i:{}),null!=(r=null==o?void 0:o.headers)?r:{})}),accessToken:async()=>""};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}(null!=i?i:{},{db:id,realtime:ig,auth:iy(iy({},ip),{},{storageKey:o}),global:ic});this.storageKey=null!=(r=l.auth.storageKey)?r:"",this.headers=null!=(s=l.global.headers)?s:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(t,e)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(e)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(n=l.auth)?n:{},this.headers,l.global.fetch),this.fetch=((t,e,i)=>{let r=i?(...t)=>i(...t):(...t)=>fetch(...t),s=Headers;return async(i,n)=>{var a;let o=null!=(a=await e())?a:t,l=new s(null==n?void 0:n.headers);return l.has("apikey")||l.set("apikey",t),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),r(i,iy(iy({},n),{},{headers:l}))}})(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(iy({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(t=>this.realtime.setAuth(t)).catch(t=>console.warn("Failed to set initial Realtime auth token:",t)),this.rest=new L(new URL("rest/v1",a).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new t0(this.storageUrl.href,this.headers,this.fetch,null==i?void 0:i.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new R(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,i)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,e;if(this.accessToken)return await this.accessToken();let{data:i}=await this.auth.getSession();return null!=(t=null==(e=i.session)?void 0:e.access_token)?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:r,userStorage:s,storageKey:n,flowType:a,lock:o,debug:l,throwOnError:h},u,c){let d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new i_({url:this.authUrl.href,headers:iy(iy({},d),u),storageKey:n,autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:r,userStorage:s,flowType:a,lock:o,debug:l,throwOnError:h,fetch:c,hasCustomAuthorizationHeader:Object.keys(this.headers).some(t=>"authorization"===t.toLowerCase())})}_initRealtimeClient(t){return new tr(this.realtimeUrl.href,iy(iy({},t),{},{params:iy(iy({},{apikey:this.supabaseKey}),null==t?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",null==e?void 0:e.access_token)})}_handleTokenChanged(t,e,i){("TOKEN_REFRESHED"===t||"SIGNED_IN"===t)&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):"SIGNED_OUT"===t&&(this.realtime.setAuth(),"STORAGE"==e&&this.auth.signOut(),this.changedAccessToken=void 0)}};(function(){if("u">typeof window)return!1;let t=globalThis.process;if(!t)return!1;let e=t.version;if(null==e)return!1;let i=e.match(/^v(\d+)\./);return!!i&&18>=parseInt(i[1],10)})()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");let iv=k.default.env.NEXT_PUBLIC_SUPABASE_URL||k.default.env.VITE_SUPABASE_URL,ix=k.default.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||k.default.env.VITE_SUPABASE_KEY;iv&&ix||console.error(" Supabase environment variables not configured properly. Make sure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set in .env.local.");let ik=new iw(iv||"",ix||"",void 0);t.s(["supabase",0,ik],53210)}]);