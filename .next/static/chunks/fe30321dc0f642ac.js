(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,92424,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(80328),a=e.i(66127),n=e.i(61386),l=e.i(53210);let o=async(e,t)=>{if(!e||"#"===e||!e.startsWith("http"))return[];let r=`&_t=${Date.now()}`;for(let s of[`https://api.allorigins.win/raw?url=${encodeURIComponent(e)}${r}`,`https://corsproxy.io/?${encodeURIComponent(e)}`,`https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(e)}`])try{let e=await fetch(s);if(!e.ok)continue;let r=await e.text();if(!r.includes("<rss")&&!r.includes("<feed")&&!r.includes("<item")&&!r.includes("<entry"))continue;let a=new DOMParser().parseFromString(r,"text/xml"),n=Array.from(a.querySelectorAll("item, entry")).slice(0,2);if(0===n.length)continue;return n.map(e=>{let r=e.querySelector("title")?.textContent||"No Title",s=e.querySelector("link"),a=s?.textContent||s?.getAttribute("href")||"#",n=e.querySelector("pubDate, published, updated")?.textContent,l=(e=>{if(!e)return new Date;let t=new Date(e);if(!isNaN(t.getTime()))return t;let r=Date.parse(e);return isNaN(r)?new Date:new Date(r)})(n).toISOString();return{id:`rss-${t}-${Math.random().toString(36).substr(2,9)}`,title:r,url:a,timestamp:l,summary:(e.querySelector("description, summary, content")?.textContent||"").replace(/<[^>]*>?/gm,"").substring(0,80)+"...",source:t,type:"rss"}})}catch{continue}return[]};function i(){let e=(0,a.useTranslations)("home.dynamics"),{data:i}=(0,s.default)("global-config",async()=>{try{let{data:e,error:t}=await l.supabase.from("config").select("*");if(t)return console.warn("[LiveGlobalFeed] Failed to fetch config:",t),[];return console.log("[LiveGlobalFeed] Fetched",e?.length,"config rows"),e}catch(e){return console.warn("[LiveGlobalFeed] Error fetching config:",e),[]}},{refreshInterval:12e4,revalidateOnFocus:!0}),{data:c,isLoading:d,mutate:m}=(0,s.default)("global-dynamics",async()=>{try{let{data:e,error:t}=await l.supabase.from("dynamics").select("*").order("pub_date",{ascending:!1}).limit(20);if(t)throw t;return console.log("[LiveGlobalFeed] Fetched",e?.length,"items from dynamics table"),e}catch(e){return console.warn("[LiveGlobalFeed] Failed to fetch dynamics:",e),[]}},{refreshInterval:6e4,revalidateOnFocus:!0}),[u,x]=(0,r.useState)([]),[g,h]=(0,r.useState)(!0),[p,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{h(!0),b(!0);let e=[];if(c&&(e=[...e,...c.map(e=>({id:e.id,title:e.title,url:e.url||e.link||"#",timestamp:e.pub_date||e.created_at||new Date().toISOString(),summary:e.summary||e.content_snippet||"",source:e.source||"NexusPulse",type:"signal",sentiment:e.sentiment||"neutral"}))]),i&&i.length>0){let t=[];i.forEach(e=>{[e.rss,e.main_rss,e.google_news_rss,e.googlenewsrss,e.mainrss].forEach(r=>{r&&t.push(o(r,e.name||"Unknown"))})}),t.length>0&&(e=[...e,...(await Promise.all(t)).flat()])}e.sort((e,t)=>{let r=new Date(e.timestamp).getTime();return new Date(t.timestamp).getTime()-r}),console.log("[LiveGlobalFeed] Combined",(e=e.slice(0,20)).length,"items from all sources"),x(e),h(!1),b(!1)})()},[c,i,d]);let{mutate:f}=(0,s.default)("global-config"),y=async()=>{console.log("[LiveGlobalFeed] Manual refresh triggered"),h(!0),b(!0),await Promise.all([f(),m()]),await new Promise(e=>setTimeout(e,500)),h(!1),b(!1)};return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center px-2",children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-200",children:e("title")}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(g||d)&&(0,t.jsx)("span",{className:"text-xs text-cyber-neon animate-pulse",children:"Syncing..."}),(0,t.jsxs)("button",{onClick:y,className:"text-xs text-cyber-neon hover:underline flex items-center gap-1",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-3 h-3",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),"Refresh"]})]})]}),(0,t.jsx)("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar",children:u.length>0?u.map((e,r)=>(0,t.jsxs)(n.default,{className:`!p-4 ${"manual"===e.type?"border-cyber-neon/40 bg-cyber-neon/5":""}`,delay:.05*r,children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("span",{className:"text-[10px] text-gray-500 font-mono",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),(0,t.jsx)("span",{className:`text-[10px] px-1.5 py-0.5 rounded border ${"manual"===e.type?"border-cyber-neon text-cyber-neon font-bold shadow-[0_0_5px_rgba(0,243,255,0.3)]":"signal"===e.type?"border-cyber-green text-cyber-green font-bold":"border-cyber-purple/30 text-cyber-purple"}`,children:"manual"===e.type?"BRIEFING":"signal"===e.type?"SIGNAL":e.source})]}),(0,t.jsx)("h4",{className:"text-sm font-bold text-gray-100 mb-1 leading-tight hover:text-cyber-neon cursor-pointer",children:"#"!==e.url?(0,t.jsx)("a",{href:e.url,target:"_blank",rel:"noreferrer",children:e.title}):e.title}),(0,t.jsx)("p",{className:"text-xs text-gray-400 line-clamp-3 mb-2 leading-relaxed",children:e.summary}),"#"!==e.url&&(0,t.jsxs)("div",{className:"flex justify-between items-center text-[10px] text-gray-500",children:[(0,t.jsxs)("span",{children:["Via ","signal"===e.type?"Database":"RSS"]}),(0,t.jsx)("a",{href:e.url,target:"_blank",rel:"noreferrer",className:"hover:text-cyber-neon",children:"Read Source ↗"})]})]},e.id)):!g&&(0,t.jsxs)("div",{className:"p-4 text-center text-gray-500 text-sm",children:["Waiting for satellite uplink... ",(0,t.jsx)("br",{}),(0,t.jsx)("span",{className:"text-xs opacity-50",children:"(Check Sheet Config)"})]})})]})}e.s(["default",()=>i])},4589,e=>{"use strict";var t=e.i(43476),r=e.i(80328),s=e.i(66127),a=e.i(61386),n=e.i(53210),l=e.i(30592);function o(){(0,s.useTranslations)("home");let e=(0,s.useTranslations)("home.stats"),{data:o,error:i,isLoading:c}=(0,r.default)("dashboard-config",async()=>{try{console.log("[LiveDashboardGrid] Fetching dashboard data from Supabase...");let{data:e,error:t}=await n.supabase.from("config").select("*");if(t)throw console.warn("[LiveDashboardGrid] Supabase error, falling back to mock data:",t.message),t;return console.log("[LiveDashboardGrid] Data loaded successfully from Supabase:",e?.length,"entities found"),e}catch(e){return console.warn("[LiveDashboardGrid] Fetch Error/Fallback:",e),l.ENTITIES.map(e=>({id:e.id,slug:e.slug,name:e.name,type:e.type,heatindex:e.heatIndex,trend:e.trend,stocksymbol:e.stockSymbol,tags:e.tags.join(","),summary:""}))}},{refreshInterval:3e4,revalidateOnFocus:!0,errorRetryCount:3,errorRetryInterval:5e3,onError:(e,t)=>{console.error("[LiveDashboardGrid] SWR Error:",e,{key:t})}});if(console.log("SWR 数据：",o),console.log("SWR 错误：",i),console.log("加载中：",c),c)return(0,t.jsx)("section",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,t.jsx)("div",{className:"h-64 rounded-2xl bg-white/5 animate-pulse border border-white/5"},e))});if(i)return(0,t.jsxs)("section",{className:"text-center p-8 bg-red-500/10 border border-red-500/20 rounded-2xl",children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-red-400 mb-2",children:"Dashboard Data Error"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"Failed to load live dashboard data. Please try again later."}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Error: ",i instanceof Error?i.message:"Unknown error"]})]});let d=o?.filter(e=>e.name&&e.slug)||[];return 0===d.length?(0,t.jsxs)("section",{className:"text-center p-8 bg-gray-800/50 border border-gray-700/50 rounded-2xl",children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-400 mb-2",children:"No Entities Found"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"No entities configured in Supabase."}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Check the Supabase config table or contact support."})]}):(0,t.jsx)("section",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:d.slice(0,4).map((r,n)=>{let l=r.heatindex?parseInt(r.heatindex):0,o=r.trend?parseFloat(r.trend):0,i=r.tags?r.tags.split(",").map(e=>e.trim()):[],c=r.type||"person";return(0,t.jsx)(s.Link,{href:"person"===c?`/person/${r.slug}`:`/category/${r.slug}`,className:"block h-full",children:(0,t.jsxs)(a.default,{delay:.1*n,className:"cursor-pointer h-full group",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("span",{className:`text-xs px-2 py-1 rounded border ${"person"===c?"border-cyber-purple/50 text-cyber-purple":"border-cyber-green/50 text-cyber-green"}`,children:c.toUpperCase()}),(0,t.jsxs)("div",{className:`flex items-center gap-1 text-sm font-bold ${o>=0?"text-cyber-green":"text-red-500"}`,children:[(0,t.jsx)("span",{children:o>=0?"▲":"▼"}),(0,t.jsxs)("span",{children:[Math.abs(o),"%"]})]})]}),(0,t.jsx)("h3",{className:"text-2xl font-bold mb-1 group-hover:text-cyber-neon transition-colors",children:r.name}),(0,t.jsxs)("div",{className:"flex items-end justify-between mt-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:e("heatIndex")}),(0,t.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,t.jsx)("p",{className:"text-3xl font-mono text-cyber-neon drop-shadow-[0_0_8px_rgba(0,243,255,0.5)]",children:l}),(0,t.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-cyber-green animate-pulse mb-1",title:"Live Data"})]})]}),(0,t.jsx)("div",{className:"flex gap-1 flex-wrap justify-end max-w-[50%]",children:i.slice(0,2).map(e=>(0,t.jsx)("span",{className:"text-[10px] bg-white/5 px-2 py-0.5 rounded text-gray-400",children:e},e))})]})]})},r.slug)})})}e.s(["default",()=>o])}]);