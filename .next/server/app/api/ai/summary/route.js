(()=>{var e={};e.id=702,e.ids=[702],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},20629:e=>{"use strict";e.exports=require("fs/promises")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},86624:e=>{"use strict";e.exports=require("querystring")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},72254:e=>{"use strict";e.exports=require("node:buffer")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},87503:e=>{"use strict";e.exports=require("node:net")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},84492:e=>{"use strict";e.exports=require("node:stream")},76402:e=>{"use strict";e.exports=require("node:stream/promises")},72477:e=>{"use strict";e.exports=require("node:stream/web")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},65628:e=>{"use strict";e.exports=require("node:zlib")},58359:()=>{},93739:()=>{},53688:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>x,routeModule:()=>m,serverHooks:()=>w,staticGenerationAsyncStorage:()=>q});var s={};t.r(s),t.d(s,{POST:()=>d});var i=t(73278),a=t(45002),n=t(54877),o=t(71309),u=t(18445),p=t(16910),c=t(15318),l=t(40204);async function d(e){try{let r=await (0,u.getServerSession)(p.L);if(!r?.user?.id)return o.NextResponse.json({error:"Unauthorized"},{status:401});let t=r.user.id,{allowed:s,remaining:i,error:a}=await (0,c.rP)(t);if(!s)return o.NextResponse.json({error:a||"Access denied."},{status:403});let{context:n}=await e.json(),d="AI Service Unavailable";if(process.env.API_KEY)try{let e=new l.fA({apiKey:process.env.API_KEY}),r=await e.models.generateContent({model:"gemini-3-flash-preview",contents:`Summarize this for a financial investor in 50 words: ${n}`});r.text&&(d=r.text)}catch(e){return console.error("Gemini API Error:",e),o.NextResponse.json({error:"AI Service Error"},{status:502})}else d=`(Mock AI) Insight for ${r.user.email}: Positive trend detected.`;return await (0,c.xZ)(t),o.NextResponse.json({summary:d,meta:{usageRemaining:i-1}})}catch(e){return console.error(e),o.NextResponse.json({error:"Internal Server Error"},{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/ai/summary/route",pathname:"/api/ai/summary",filename:"route",bundlePath:"app/api/ai/summary/route"},resolvedPagePath:"D:\\my-web-app\\nexuspulse-influence-project new git\\app\\api\\ai\\summary\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:q,serverHooks:w}=m,g="/api/ai/summary/route";function h(){return(0,n.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:q})}},16910:(e,r,t)=>{"use strict";t.d(r,{L:()=>p});var s=t(22571),i=t(61743),a=t(76214),n=t(44570),o=t(74738),u=t(93981);let p={adapter:(0,n.N)(o._),providers:[(0,s.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET}),(0,i.ZP)({clientId:process.env.TWITTER_CLIENT_ID,clientSecret:process.env.TWITTER_CLIENT_SECRET,version:"2.0"}),(0,a.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let r=await o._.user.findUnique({where:{email:e.email}});return r&&r.password&&await (0,u.qu)(e.password,r.password)?{id:r.id,email:r.email,name:r.name,image:r.image}:null}})],session:{strategy:"jwt"},callbacks:{async session({session:e,token:r}){if(e.user&&r.sub){let t=await o._.user.findUnique({where:{id:r.sub},select:{id:!0,plan:!0,trialEndsAt:!0,aiUsageCountToday:!0}});t&&(e.user.id=t.id,e.user.plan=t.plan,e.user.trialEndsAt=t.trialEndsAt)}return e},jwt:async({token:e,user:r})=>(r&&(e.sub=r.id),e)},events:{createUser:async({user:e})=>{let r=new Date(new Date().getTime()+1728e5);await o._.user.update({where:{id:e.id},data:{plan:"TRIAL",trialEndsAt:r,aiUsageCountToday:0}}),console.log(`[Auth] New user ${e.id} enrolled in 48h TRIAL.`)}}}},15318:(e,r,t)=>{"use strict";t.d(r,{Sl:()=>i,rP:()=>n,xZ:()=>o,yV:()=>a});var s=t(74738);let i={FREE:1,TRIAL:20,PAID:100};async function a(e){let r=await s._.user.findUnique({where:{id:e}});if(!r)return null;let t=new Date,i=new Date(r.lastUsageReset);return((t.getDate()!==i.getDate()||t.getMonth()!==i.getMonth())&&(await s._.user.update({where:{id:e},data:{aiUsageCountToday:0,lastUsageReset:t}}),r.aiUsageCountToday=0),"TRIAL"===r.plan&&r.trialEndsAt&&t>r.trialEndsAt)?(console.log(`[Membership] Trial expired for ${r.id}. Downgrading to FREE.`),await s._.user.update({where:{id:r.id},data:{plan:"FREE",trialEndsAt:null}})):r}async function n(e){let r=await a(e);if(!r)return{allowed:!1,remaining:0,error:"User not found"};let t=Math.max(0,(i[r.plan]||0)-r.aiUsageCountToday);return t<=0?{allowed:!1,remaining:0,error:`Daily limit reached for ${r.plan} plan. Upgrade for more.`}:{allowed:!0,remaining:t}}async function o(e){await s._.user.update({where:{id:e},data:{aiUsageCountToday:{increment:1},aiUsageCountMonthly:{increment:1}}})}},74738:(e,r,t)=>{"use strict";t.d(r,{_:()=>i});var s=t(53524);let i=globalThis.prisma||new s.PrismaClient({log:["query"]})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[787,845,216,833,204],()=>t(53688));module.exports=s})();